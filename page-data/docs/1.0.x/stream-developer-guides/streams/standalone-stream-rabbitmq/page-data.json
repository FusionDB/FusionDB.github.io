{"componentChunkName":"component---src-templates-documentation-js","path":"/docs/1.0.x/stream-developer-guides/streams/standalone-stream-rabbitmq/","result":{"data":{"pages":{"edges":[{"node":{"id":"a7163ea7-fee2-59e2-93a9-97295900514c","fields":{"path":"/docs/1.0.x/installation/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Installation","description":"How to install Data Flow","path":"installation/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bd5a11a7-18e7-51b4-b947-2bc07cfbe3a3","fields":{"path":"/docs/1.0.x/installation/local/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Local Machine","description":"Local Machine Installation Guide","path":"installation/local/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"768f6200-d825-5a92-8fb0-d9d4f8526774","fields":{"path":"/docs/1.0.x/installation/local/docker/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Docker Compose","description":"Installation using Docker Compose","path":"installation/local/docker","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ed09e37c-0ee2-5a34-9ebd-531a260bbb27","fields":{"path":"/docs/1.0.x/installation/local/docker-customize/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Docker Compose Customization","description":"Customize the Docker Compose installation","path":"installation/local/docker-customize","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1f4acbf8-19d9-5571-8144-f6bdbb17673e","fields":{"path":"/docs/1.0.x/installation/local/manual/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Manual","description":"Manual installation","path":"installation/local/manual","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9187e14f-7805-52c1-9523-5662cc0bd05c","fields":{"path":"/docs/1.0.x/installation/cloudfoundry/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Cloud Foundry","description":"Data Flow Cloud Foundry Installation Guide","path":"installation/cloudfoundry/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a9d29299-0143-5805-9560-ceea1b8cd733","fields":{"path":"/docs/1.0.x/installation/cloudfoundry/cf-cli/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Cloud Foundry CLI","description":"Install using the Cloud Foundry CLI","path":"installation/cloudfoundry/cf-cli","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e2dd0da6-655a-5dce-9a94-432190a36574","fields":{"path":"/docs/1.0.x/installation/cloudfoundry/cf-local/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Running locally","description":"Configure the local servers to deploy to Cloud Foundry","path":"installation/cloudfoundry/cf-local","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"aa81741b-4e8f-5fe0-8180-b3b35c334f0a","fields":{"path":"/docs/1.0.x/installation/kubernetes/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Kubernetes","description":"Data Flow Kubernetes Installation Guide","path":"installation/kubernetes/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0bc509b9-db54-5702-a81e-b07664512949","fields":{"path":"/docs/1.0.x/installation/kubernetes/creating-a-cluster/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Creating a Cluster","description":"Creating a Kubernetes Cluster","path":"installation/kubernetes/creating-a-cluster","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f89cb3e7-dec0-569b-ac11-140d9cfd2d67","fields":{"path":"/docs/1.0.x/installation/kubernetes/helm/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Helm","description":"Installation using Helm","path":"installation/kubernetes/helm","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"6e3e57c0-9b0c-5ba0-81aa-060a1bb1e756","fields":{"path":"/docs/1.0.x/installation/kubernetes/kubectl/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"kubectl","description":"Installation using kubectl","path":"installation/kubernetes/kubectl","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c30d6475-ca22-5473-be63-985c9c083df8","fields":{"path":"/docs/1.0.x/installation/kubernetes/compatibility/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Kubernetes Compatibility","description":"Compatibility with Kubernetes Versions","path":"installation/kubernetes/compatibility","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4dbf43e6-0df8-53b6-b39f-2c70b6828763","fields":{"path":"/docs/1.0.x/design/","version":"1.0.x","category":"design"},"frontmatter":{"title":"Design","description":"FusionDB design guides","path":"design/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5a2858ae-3b79-55aa-8df1-647ba72aa53e","fields":{"path":"/docs/1.0.x/design/concept/","version":"1.0.x","category":"design"},"frontmatter":{"title":"Concept","description":"design of concept","path":"design/concept/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f58b38f1-eb57-55e6-b728-d8e3eeee0598","fields":{"path":"/docs/1.0.x/design/fql/","version":"1.0.x","category":"design"},"frontmatter":{"title":"SQL Layer","description":"SQL Layer","path":"design/fql/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bd069586-c290-529b-bde5-b4c61a092b74","fields":{"path":"/docs/1.0.x/design/core/","version":"1.0.x","category":"design"},"frontmatter":{"title":"Core Layer","description":"core layer","path":"design/core/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"8d26cb10-fc16-58e0-b279-45a91d727de4","fields":{"path":"/docs/1.0.x/design/runtime/","version":"1.0.x","category":"design"},"frontmatter":{"title":"Runtime","description":"runtime","path":"design/runtime/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bc1203e6-5c24-53ef-b7d5-b3991641cdf9","fields":{"path":"/docs/1.0.x/design/developer/","version":"1.0.x","category":"design"},"frontmatter":{"title":"Developer","description":"developer","path":"design/developer/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0c42c162-4438-5ab6-b02f-2b6f41249831","fields":{"path":"/docs/1.0.x/concepts/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Concepts","description":"Core Concepts in Spring Cloud Data Flow","path":"concepts/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f47d7680-99d8-579c-9dcd-02996bd06384","fields":{"path":"/docs/1.0.x/concepts/architecture/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Architecture","description":"Introduction to Data Flow's Architecture.","path":"concepts/architecture/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"dfc24dc1-1a43-5a42-902f-1026287574e2","fields":{"path":"/docs/1.0.x/concepts/streams/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Stream Processing","description":"Stream Processing Framework and Concepts","path":"concepts/streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"05f7a75c-e562-586f-8f96-037e7286bfd8","fields":{"path":"/docs/1.0.x/concepts/batch-jobs/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Batch Processing","description":"Batch Processing Framework and Concepts","path":"concepts/batch-jobs/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"7303a994-5abf-5a72-b277-45ffcdee4f94","fields":{"path":"/docs/1.0.x/concepts/monitoring/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Monitoring","description":"Runtime monitoring of Stream data pipelines","path":"concepts/monitoring/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c6b97537-de48-5131-817c-887a6fe1737e","fields":{"path":"/docs/1.0.x/concepts/tooling/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Tooling","description":"Dashboard and Shell","path":"concepts/tooling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"549f2604-a208-557f-9ddb-97b59fb49d8d","fields":{"path":"/docs/1.0.x/stream-developer-guides/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Developer guides ","description":"Learn how to create Streaming data pipelines using prebuilt microservices or create your own.","path":"stream-developer-guides/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5c3d87ba-a23e-5278-949b-45177dd60e7d","fields":{"path":"/docs/1.0.x/stream-developer-guides/getting-started/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Getting Started","description":"Getting Started with Stream Processing","path":"stream-developer-guides/getting-started/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"30d8143a-a157-5987-aa8d-beb7f891ca54","fields":{"path":"/docs/1.0.x/stream-developer-guides/getting-started/stream/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Processing","description":"Create and deploy a streaming data pipeline using prebuilt applications on your Local Machine","path":"stream-developer-guides/getting-started/stream/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bb31aa1b-70a3-511c-b1ef-9f8919098de0","fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Development","description":"Stream Processing Developer Guide","path":"stream-developer-guides/streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"d434a513-de03-56c9-97b6-bdfcde73ca8c","fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/standalone-stream-rabbitmq/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Application Development on RabbitMQ","description":"Create your own microservices for Stream processing using RabbitMQ and deploy them manually","path":"stream-developer-guides/streams/standalone-stream-rabbitmq/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"b37a90e1-3d89-515b-a905-415846b703df","fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/standalone-stream-kafka/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Application Development on Apache Kafka","description":"Create your own microservices for Stream processing using Apache Kafka and deploy them manually","path":"stream-developer-guides/streams/standalone-stream-kafka/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"7c7daf75-55ef-59f5-9b14-55525f8b6df6","fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/data-flow-stream/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Processing using Spring Cloud Data Flow","description":"Create and Deploy a Stream Processing Pipeline using Spring Cloud Data Flow","path":"stream-developer-guides/streams/data-flow-stream/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"621b87c8-4882-5c45-874d-e7997d9a4814","fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/stream-other-binders/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Spring Application Development on other Messaging Middleware","description":"Create your own microservices for Stream processing using other messaging middleware such as Google Pub/Sub, Amazon Kinesis, and Solace JMS","path":"stream-developer-guides/streams/stream-other-binders/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c58d486a-d5d6-55fc-aabd-ba45cb90dfea","fields":{"path":"/docs/1.0.x/stream-developer-guides/programming-models/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Programming Models","description":"Programming models","path":"stream-developer-guides/programming-models/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"75d3de31-78b4-5b83-9854-d8a02fc374ff","fields":{"path":"/docs/1.0.x/stream-developer-guides/continuous-delivery/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Continuous Delivery","description":"CD using Skipper","path":"stream-developer-guides/continuous-delivery/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c43a1bb1-f77b-5dbb-9129-f8bbccc3f143","fields":{"path":"/docs/1.0.x/stream-developer-guides/continuous-delivery/cd-basics/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Continuous Delivery of streaming applications","description":"Continuous Delivery of Streaming applications","path":"stream-developer-guides/continuous-delivery/cd-basics/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"453f1240-1e06-501e-84d6-f5c75294f51b","fields":{"path":"/docs/1.0.x/stream-developer-guides/troubleshooting/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Troubleshooting","description":"Troubleshooting Streams","path":"stream-developer-guides/troubleshooting/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9880ea3d-b6ff-5f0f-b6cc-5e369e6f7532","fields":{"path":"/docs/1.0.x/stream-developer-guides/troubleshooting/debugging-stream-apps/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Debugging Stream Applications","description":"Debugging Stream Applications outside of Data Flow","path":"stream-developer-guides/troubleshooting/debugging-stream-apps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3beeb29d-18a6-5f43-90fe-68f959519e78","fields":{"path":"/docs/1.0.x/stream-developer-guides/troubleshooting/debugging-scdf-streams/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Debugging Stream applications deployed by Data Flow","description":"Debugging Data Flow Stream deployments","path":"stream-developer-guides/troubleshooting/debugging-scdf-streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0eed7576-fb62-53fa-99ea-7e52579622fd","fields":{"path":"/docs/1.0.x/batch-developer-guides/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Batch Developer guides ","description":"Learn how to create Batch data pipelines using prebuilt microservices or create your own","path":"batch-developer-guides/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"102bd156-c483-51bb-88f5-fa855409c280","fields":{"path":"/docs/1.0.x/batch-developer-guides/getting-started/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Getting Started","description":"Getting Started with Batch","path":"batch-developer-guides/getting-started/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ea535601-baa1-5bfe-9153-75372559647c","fields":{"path":"/docs/1.0.x/batch-developer-guides/getting-started/task/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Task Processing","description":"Create and deploy a simple Task pipeline using a prebuilt Task application on your local machine","path":"batch-developer-guides/getting-started/task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"850aaf5b-ad19-5a57-bd92-d05ce20a94f3","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Batch Development","description":"Batch Developer Guide","path":"batch-developer-guides/batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"dec105a5-4b6f-5f71-9351-b196a8277c30","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/spring-task/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Simple Task","description":"Create a simple Spring Boot Application using Spring Cloud Task","path":"batch-developer-guides/batch/spring-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9479ba94-433e-52f3-8bd0-3fa5566870dc","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/spring-batch/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Spring Batch Jobs","description":"Create a Spring Batch Job","path":"batch-developer-guides/batch/spring-batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"444e21c6-559a-536d-b239-67427a6e6e59","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/data-flow-simple-task/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Register and Launch a Spring Cloud Task application using Data Flow","description":"Register and Launch a Spring Cloud Task application using Data Flow","path":"batch-developer-guides/batch/data-flow-simple-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c36bf11d-6a72-528f-a52b-76c85db1002e","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/data-flow-spring-batch/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Register and launch a Spring Batch application using Data Flow","description":"Register and launch a Spring Batch application using Data Flow","path":"batch-developer-guides/batch/data-flow-spring-batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"8229c50e-ed25-5c35-b801-74ddb159ad25","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/data-flow-composed-task/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Create and launch a Composed Task using Data Flow","description":"Create and launch a Composed Task using Data Flow","path":"batch-developer-guides/batch/data-flow-composed-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"6a82f60f-8635-5b10-a8c0-919bb4e421b7","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/data-flow-simple-task-kubernetes/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Deploying a task application on Kubernetes with Data Flow","description":"Guide to deploying spring-cloud-stream-task applications on Kubernetes using Spring Cloud Data Flow","path":"batch-developer-guides/batch/data-flow-simple-task-kubernetes/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e3203d7d-4257-57da-91ce-fb162be67962","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/data-flow-simple-task-cloudfoundry/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Deploying a task application on Cloud Foundry using Spring Cloud Data Flow","description":"Guide to deploying spring-cloud-stream-task applications on Cloud Foundry using Spring Cloud Data Flow","path":"batch-developer-guides/batch/data-flow-simple-task-cloudfoundry/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4b4804df-3108-5a77-9a1b-9acf3d7993c1","fields":{"path":"/docs/1.0.x/batch-developer-guides/continuous-deployment/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Continuous Deployment","description":"Continuous Deployment for task applications","path":"batch-developer-guides/continuous-deployment/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"42f40244-c1c6-54d0-9f55-19a6abeb1e18","fields":{"path":"/docs/1.0.x/batch-developer-guides/continuous-deployment/cd-basics/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Continuous Deployment of task applications","description":"This section discusses how to use Continuous Deployment of Tasks in SCDF","path":"batch-developer-guides/continuous-deployment/cd-basics/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"aff8ddff-db2c-58b7-8318-eb71b0345870","fields":{"path":"/docs/1.0.x/batch-developer-guides/troubleshooting/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Troubleshooting","description":"Troubleshooting Batch Jobs","path":"batch-developer-guides/troubleshooting/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9306cc1f-4df5-5f11-9c91-38630700a788","fields":{"path":"/docs/1.0.x/batch-developer-guides/troubleshooting/debugging-task-apps/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Debugging Batch applications","description":"Debugging Batch applications","path":"batch-developer-guides/troubleshooting/debugging-task-apps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ac39f173-da48-5471-af07-8cc0ae79c5a6","fields":{"path":"/docs/1.0.x/batch-developer-guides/troubleshooting/debugging-scdf-tasks/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Debugging Batch applications deployed by Data Flow","description":"Debugging Batch applications deployed by Data Flow","path":"batch-developer-guides/troubleshooting/debugging-scdf-tasks/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f756eab0-a1c7-5519-91b8-b756b66427d5","fields":{"path":"/docs/1.0.x/feature-guides/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Feature guides","description":"High level overview of Data Flow Features","path":"feature-guides/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a6130b0a-97c5-58c9-a992-8a913de8363c","fields":{"path":"/docs/1.0.x/feature-guides/general/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"General","description":"General Features in Data Flow","path":"feature-guides/general/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"2da44c23-5791-5f72-98e7-b06ad935f91a","fields":{"path":"/docs/1.0.x/feature-guides/general/application-metadata/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Application Metadata","description":"Create and use application properties metadata","path":"feature-guides/general/application-metadata/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9595e887-0056-5bf5-81fe-af8041b4f37a","fields":{"path":"/docs/1.0.x/feature-guides/streams/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Streams","description":"Stream Features in Data Flow","path":"feature-guides/streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"beec2961-d478-51c8-a16d-1f8381bc054a","fields":{"path":"/docs/1.0.x/feature-guides/streams/deployment-properties/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Deployment Properties","description":"Initiate a stream deployment with deployment property overrides","path":"feature-guides/streams/deployment-properties/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1bc3d5fc-8110-5fdd-80cd-6e943f6cbf84","fields":{"path":"/docs/1.0.x/feature-guides/streams/function-composition/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Composing Functions","description":"Daisy-chain Java functions in an existing Spring Cloud Stream application","path":"feature-guides/streams/function-composition/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a2850433-5830-5d6b-929e-ef00b1ffe2dd","fields":{"path":"/docs/1.0.x/feature-guides/streams/named-destinations/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Named Destinations","description":"Use the Named Destinations to interact with the Topics/Queues directly","path":"feature-guides/streams/named-destinations/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0b1fdd2b-63ee-55e4-ac39-c1af84975009","fields":{"path":"/docs/1.0.x/feature-guides/streams/monitoring/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Stream Monitoring","description":"Monitoring streaming data pipelines with Prometheus and InfluxDB","path":"feature-guides/streams/monitoring/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1f7e22c3-dd60-59eb-89aa-d32ff0aa146e","fields":{"path":"/docs/1.0.x/feature-guides/streams/stream-application-dsl/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Stream Application DSL","description":"Learn how to use the Stream Application DSL","path":"feature-guides/streams/stream-application-dsl/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"8f9cb8a7-8f95-5e41-9b7b-64f217f9ad53","fields":{"path":"/docs/1.0.x/feature-guides/streams/labels/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Labeling Applications","description":"Label the stream applications to uniquely interact with them","path":"feature-guides/streams/labels/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"dadb6660-e6bd-5e0a-a0cc-5ffd6c97ac39","fields":{"path":"/docs/1.0.x/feature-guides/streams/application-count/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Application Count","description":"Initiate stream deployment with multiple application instances","path":"feature-guides/streams/application-count/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"22c21f61-5468-5a3c-9b95-944b4587bb94","fields":{"path":"/docs/1.0.x/feature-guides/streams/fanin-fanout/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Fan-in and Fan-out","description":"Publish and subscribe to multiple destinations using the fan-in and fan-out capabilities","path":"feature-guides/streams/fanin-fanout/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a1bcdf2b-cf7d-5ba3-be0f-717da33a7598","fields":{"path":"/docs/1.0.x/feature-guides/streams/partitioning/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Data Partitioning","description":"Learn more about data partitioning support to build stateful streaming data pipelines","path":"feature-guides/streams/partitioning/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"2b2f20ee-7207-5d37-9938-46f11ebfbb35","fields":{"path":"/docs/1.0.x/feature-guides/streams/scaling/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Scaling","description":"Scaling streaming data pipeline with Spring Cloud Data Flow","path":"feature-guides/streams/scaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e48190e2-51d0-5e97-be89-ddec511e3c8e","fields":{"path":"/docs/1.0.x/feature-guides/streams/java-dsl/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Java DSL","description":"Programmatically create streams using the Java DSL","path":"feature-guides/streams/java-dsl/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"74c1c9cc-59a1-56e3-84b0-d37c2cc01644","fields":{"path":"/docs/1.0.x/feature-guides/streams/taps/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Tapping a Stream","description":"Create a stream from another stream without interrupting the data processing","path":"feature-guides/streams/taps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c0fc1912-0647-5493-8682-ad556ca18123","fields":{"path":"/docs/1.0.x/feature-guides/batch/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Batch","description":"Batch Features in Data Flow","path":"feature-guides/batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ef7306d1-1bb4-5c4f-a6d4-6a1916fb9936","fields":{"path":"/docs/1.0.x/feature-guides/batch/deployment-properties/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Deployment Properties","description":"Initiate a Batch deployment with deployment property overrides","path":"feature-guides/batch/deployment-properties/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0bf731f8-f15b-5fa5-93c6-66a1a50a217e","fields":{"path":"/docs/1.0.x/feature-guides/batch/scheduling/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Scheduling Batch Jobs","description":"Learn how to schedule Batch Jobs","path":"feature-guides/batch/scheduling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"8634ea59-9d3a-5a8c-893b-d2410db40a50","fields":{"path":"/docs/1.0.x/feature-guides/batch/partitioning/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Remote Partitioned Batch Job","description":"Learn more about partitioning support for Batch Jobs","path":"feature-guides/batch/partitioning/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"b1fe2d75-240a-5805-9e57-d7a22fd00967","fields":{"path":"/docs/1.0.x/feature-guides/batch/monitoring/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Task Monitoring","description":"Monitoring task data pipelines with InfluxDB","path":"feature-guides/batch/monitoring/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"be9476c4-fca5-5462-bd55-1fec11d57015","fields":{"path":"/docs/1.0.x/feature-guides/batch/restarting/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Restarting Batch Jobs","description":"Learn how to restart Batch Jobs","path":"feature-guides/batch/restarting/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3ae5c6a5-8daa-5e78-ac01-62e5055f259d","fields":{"path":"/docs/1.0.x/feature-guides/batch/composed-task/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Composed Tasks","description":"Learn how to create and manage composed tasks","path":"feature-guides/batch/composed-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c9418073-406e-5381-9caa-c1f4f5de3bd0","fields":{"path":"/docs/1.0.x/recipes/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Recipes","description":"Recipes that help solve some common use-cases","path":"recipes/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c1e87d44-5cad-57de-9697-b938aacb6787","fields":{"path":"/docs/1.0.x/recipes/polyglot/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Polyglot","description":"Using multiple programming languages","path":"recipes/polyglot/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"6fcdc3d3-3437-555c-bd6c-ae9a555d7cdc","fields":{"path":"/docs/1.0.x/recipes/polyglot/processor/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Python Stream Processor","description":"Python Application as a Data Flow Stream Processor","path":"recipes/polyglot/processor/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e2182467-6e67-518d-a081-7bac0ab112bf","fields":{"path":"/docs/1.0.x/recipes/polyglot/task/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Python Task","description":"Create and Deploy a Python Task","path":"recipes/polyglot/task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5bbaaf56-042c-519c-bf0c-479b8296ca3f","fields":{"path":"/docs/1.0.x/recipes/polyglot/app/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Python Application","description":"Create and Deploy a Python Application in a Stream","path":"recipes/polyglot/app/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ab2e3101-f6b7-585f-aa51-f589b6cd53f1","fields":{"path":"/docs/1.0.x/recipes/rabbitmq/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"RabbitMQ","description":"RabbitMQ","path":"recipes/rabbitmq/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e7ac46b6-d8da-5011-95cd-3bd677878f2d","fields":{"path":"/docs/1.0.x/recipes/rabbitmq/rabbit-source-sink/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"RabbitMQ as Source and Sink","description":"RabbitMQ as Source and Sink + RabbitMQ binder","path":"recipes/rabbitmq/rabbit-source-sink/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"beaa0cd8-6417-5886-92d1-f86fb0fb9be9","fields":{"path":"/docs/1.0.x/recipes/kafka/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Apache Kafka","description":"Kafka","path":"recipes/kafka/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"926fbf39-6a6c-51ba-8ce1-0c88b1583941","fields":{"path":"/docs/1.0.x/recipes/kafka/ext-kafka-cluster-cf/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"External Kafka Cluster","description":"Connect to an external Kafka Cluster from Cloud Foundry","path":"recipes/kafka/ext-kafka-cluster-cf/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5e8ac125-4c49-5506-b8b7-96fd7eb225a0","fields":{"path":"/docs/1.0.x/recipes/kinesis/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Amazon Kinesis","description":"Amazon Kinesis","path":"recipes/kinesis/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"85cce150-f34f-5e56-8d1c-474e13a59c60","fields":{"path":"/docs/1.0.x/recipes/kinesis/simple-producer-consumer/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Amazon Kinesis Binder","description":"A sample of Spring Cloud Stream + Amazon Kinesis Binder in action","path":"recipes/kinesis/simple-producer-consumer/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"17cf6afa-cacd-51b1-a38d-269c327433bd","fields":{"path":"/docs/1.0.x/recipes/multi-platform-deployment/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Multiple Platform Deployments","description":"Multiple Platform Deployments","path":"recipes/multi-platform-deployment/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3cecd815-ef4e-5849-a3bd-8244340450c3","fields":{"path":"/docs/1.0.x/recipes/multi-platform-deployment/multiple-platform-accounts/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Role of Multiple Platform Deployments","description":"A walk-through of multiple platform requirements and the configurations for Cloud Foundry and Kubernetes","path":"recipes/multi-platform-deployment/multiple-platform-accounts","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"24631eae-3b20-587f-ad1e-ec09f0a70b92","fields":{"path":"/docs/1.0.x/recipes/scaling/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Scaling","description":"Prometheus and Data Flow to autoscale streaming data pipelines","path":"recipes/scaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a8642f26-c053-56c4-9d54-d98f6d52e6a2","fields":{"path":"/docs/1.0.x/recipes/scaling/manual-scaling/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Manual Scaling","description":"Scale applications using SCDF Shell","path":"recipes/scaling/manual-scaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ab0eae66-b0a8-5173-9f37-3f7f7954a307","fields":{"path":"/docs/1.0.x/recipes/scaling/autoscaling/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Autoscaling","description":"Autoscale streaming data pipeline with SCDF and Prometheus","path":"recipes/scaling/autoscaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4bdd938e-edb1-5932-b003-c44f6b7b7362","fields":{"path":"/docs/1.0.x/recipes/batch/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Batch","description":"Using Spring Cloud Data Flow with Spring Batch","path":"recipes/batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5f7e4b28-d4d4-5db2-b8f6-5cf784348f99","fields":{"path":"/docs/1.0.x/recipes/batch/batch-only-mode/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Batch-only Mode","description":"Set up Spring Cloud Data Flow to use only batch and not streams","path":"recipes/batch/batch-only-mode/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"05184c9b-cfba-5ba5-9989-bfa5fcdff52b","fields":{"path":"/docs/1.0.x/recipes/batch/sftp-to-jdbc/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"SFTP to JDBC","description":"Ingest Files from SFTP to a JDBC data store using Data Flow and Spring Batch","path":"recipes/batch/sftp-to-jdbc/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3b1f9b94-4bb5-5a7e-95b4-406de275f1e3","fields":{"path":"/docs/1.0.x/recipes/functional-apps/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Functional Applications","description":"Using Functional Approach in Spring Cloud Stream applications","path":"recipes/functional-apps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"09de46bd-144f-515c-8ceb-fe299888efa8","fields":{"path":"/docs/1.0.x/recipes/functional-apps/scst-function-bindings/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Functional Applications","description":"Configuring the Spring Cloud Stream Functional applications","path":"recipes/functional-apps/scst-function-bindings/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"2219bb7b-fe37-58d5-983b-c8f87bc826db","fields":{"path":"/docs/1.0.x/recipes/cloud-providers/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Cloud Providers","description":"Using functionality provided by cloud providers","path":"recipes/cloud-providers/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e6479091-7b1b-5c7c-beab-754b1d921760","fields":{"path":"/docs/1.0.x/recipes/cloud-providers/gke-regional-clusters/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"GKE Regional Clusters","description":"Deploying Spring Cloud Data Flow to a GKE Regional Cluster","path":"recipes/cloud-providers/gke-regional-clusters/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3ed354bf-b384-5e0f-aa07-7ccb41a8dc84","fields":{"path":"/docs/1.0.x/resources/","version":"1.0.x","category":"resources"},"frontmatter":{"title":"Resources","description":"Sample Applications, References Docs, Videos, Blogs...","path":"resources/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"dbb3d525-e9e5-5de6-8a1e-3de452708798","fields":{"path":"/docs/1.0.x/resources/reference-docs/","version":"1.0.x","category":"resources"},"frontmatter":{"title":"Reference Documentation","description":"Collection of reference guides for Spring Cloud Data Flow","path":"resources/reference-docs/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ba1fee96-388f-5785-bd61-2c828c0380b4","fields":{"path":"/docs/1.0.x/resources/samples/","version":"1.0.x","category":"resources"},"frontmatter":{"title":"Samples","description":"Collection of samples","path":"resources/samples/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bac2f165-b025-53f8-aa62-9218cb36cc52","fields":{"path":"/docs/1.0.x/resources/faq/","version":"1.0.x","category":"resources"},"frontmatter":{"title":"Frequently Asked Questions","description":"","path":"resources/faq/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"310d895e-f2b0-51e9-ac91-5b2b527c8a6e","fields":{"path":"/docs/1.0.x/applications/","version":"1.0.x","category":"applications"},"frontmatter":{"title":"Applications","description":"Using stream and task applications","path":"applications/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"438e7b00-2573-56f0-a213-853e846f5e60","fields":{"path":"/docs/1.0.x/applications/pre-packaged/","version":"1.0.x","category":"applications"},"frontmatter":{"title":"Pre-packaged Applications","description":"Pre-packaged stream and task applications","path":"applications/pre-packaged","meta_title":null,"meta_description":null,"keywords":["application","pre-packaged"]}}}]},"page":{"html":"<h1 id=\"stream-processing-with-rabbitmq\" style=\"position:relative;\"><a href=\"#stream-processing-with-rabbitmq\" aria-label=\"stream processing with rabbitmq permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stream Processing with RabbitMQ</h1>\n<p>In this guide, we develop three Spring Boot applications that use Spring Cloud Stream's support for RabbitMQ and deploy them to Cloud Foundry, to Kubernetes, and on your local machine.\nIn another guide, we <a href=\"/docs/1.0.x/stream-developer-guides/streams/data-flow-stream/\">deploy these applications by using Data Flow</a>.\nBy deploying the applications manually, you get a better understanding of the steps that Data Flow automates for you.</p>\n<p>The following sections describe how to build these applications from scratch.\nIf you prefer, you can download a zip file containing the sources for these applications, unzip it, and proceed to the <a href=\"#deployment\">deployment</a> section.</p>\n<p>You can <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-rabbitmq/dist/usage-cost-stream-rabbit.zip?raw=true\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download the project</a> that contains all three applications from your browser. You can also use the command line, as the following example shows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-rabbitmq/dist/usage-cost-stream-rabbit.zip?raw<span class=\"token operator\">=</span>true -O usage-cost-stream-rabbit.zip</code></pre></div>\n      </div>\n<h2 id=\"development\" style=\"position:relative;\"><a href=\"#development\" aria-label=\"development permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Development</h2>\n<p>We create three Spring Cloud Stream applications that communicate by using RabbitMQ.</p>\n<p>The scenario is a cell phone company creating bills for its customers.\nEach call made by a user has a <code class=\"language-text\">duration</code> and an amount of <code class=\"language-text\">data</code> used during the call.\nAs part of the process to generate a bill, the raw call data needs to be converted to a cost for the duration of the call and a cost for the amount of data used.</p>\n<p>The call is modeled by using the <code class=\"language-text\">UsageDetail</code> class that contains the <code class=\"language-text\">duration</code> of the call and the amount of <code class=\"language-text\">data</code> used during the call.\nThe bill is modeled by using the <code class=\"language-text\">UsageCostDetail</code> class that contains the cost of the call (<code class=\"language-text\">costCall</code>) and the cost of the data (<code class=\"language-text\">costData</code>). Each class contains an ID (<code class=\"language-text\">userId</code>) to identify the person making the call.</p>\n<p>The three streaming applications are as follows:</p>\n<ul>\n<li>The <code class=\"language-text\">Source</code> application named <code class=\"language-text\">UsageDetailSender</code> generates the users' call <code class=\"language-text\">duration</code> and the amount of <code class=\"language-text\">data</code> used for each <code class=\"language-text\">userId</code> and sends a message that contains the <code class=\"language-text\">UsageDetail</code> object as JSON.</li>\n<li>The <code class=\"language-text\">Processor</code> application named <code class=\"language-text\">UsageCostProcessor</code> consumes the <code class=\"language-text\">UsageDetail</code> and computes the cost of the call and the cost of the data per <code class=\"language-text\">userId</code>. It sends the <code class=\"language-text\">UsageCostDetail</code> object as JSON.</li>\n<li>The <code class=\"language-text\">Sink</code> application named <code class=\"language-text\">UsageCostLogger</code> consumes the <code class=\"language-text\">UsageCostDetail</code> object and logs the cost of the call and data.</li>\n</ul>\n<h3 id=\"source\" style=\"position:relative;\"><a href=\"#source\" aria-label=\"source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Source</h3>\n<p>In this step, we create the <code class=\"language-text\">UsageDetailSender</code> source.</p>\n<p>You can either <a href=\"https://start.spring.io/starter.zip?type=maven-project&#x26;language=java&#x26;bootVersion=2.2.1.RELEASE&#x26;baseDir=usage-detail-sender-rabbit&#x26;groupId=io.spring.dataflow.sample&#x26;artifactId=usage-detail-sender-rabbit&#x26;name=usage-detail-sender-rabbit&#x26;description=Demo%20project%20for%20Spring%20Boot&#x26;packageName=io.spring.dataflow.sample.usagedetailsender&#x26;packaging=jar&#x26;javaVersion=1.8&#x26;dependencies=amqp&#x26;dependencies=cloud-stream&#x26;dependencies=actuator&#x26;dependencies=web&#x26;dependencies=cloud-connectors\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download the initialzr generated project directly</a> or visit the <a href=\"https://start.spring.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Initialzr site</a> and follow these instructions:</p>\n<ol>\n<li>Create a new Maven project with a Group name of <code class=\"language-text\">io.spring.dataflow.sample</code> and an Artifact name of <code class=\"language-text\">usage-detail-sender-rabbit</code>.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">RabbitMQ</code> to select the RabbitMQ binder dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Cloud Stream</code> to select the Spring Cloud Stream dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Actuator</code> to select the Spring Boot actuator dependency.</li>\n<li>If your target platform is <code class=\"language-text\">Cloud Foundry</code>, type <code class=\"language-text\">Cloud Connectors</code> to select the Spring Cloud Connector dependency.</li>\n<li>Click the <strong>Generate Project</strong> button.</li>\n</ol>\n<p>Now you should <code class=\"language-text\">unzip</code> the <code class=\"language-text\">usage-detail-sender-rabbit.zip</code> file and import the project into your favorite IDE.</p>\n<h4 id=\"business-logic\" style=\"position:relative;\"><a href=\"#business-logic\" aria-label=\"business logic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Business Logic</h4>\n<p>Now we can create the code required for this application. To do so:</p>\n<ol>\n<li>Create a <code class=\"language-text\">UsageDetail</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagedetailsender</code> package that looks like the contents in <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-rabbitmq/usage-detail-sender/src/main/java/io/spring/dataflow/sample/UsageDetail.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">UsageDetail.java</a>.\nThe <code class=\"language-text\">UsageDetail</code> class contains <code class=\"language-text\">userId</code>, <code class=\"language-text\">data</code>, and <code class=\"language-text\">duration</code> properties.</li>\n<li>Create the <code class=\"language-text\">UsageDetailSender</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagedetailsender</code> package, which resembles the following listing:</li>\n</ol>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagedetailsender</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Random</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>domain<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>beans<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Autowired</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">EnableBinding</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Source</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageBuilder</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>scheduling<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">EnableScheduling</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>scheduling<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Scheduled</span><span class=\"token punctuation\">;</span>\n<span class=\"token annotation punctuation\">@EnableScheduling</span>\n<span class=\"token annotation punctuation\">@EnableBinding</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Source</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageDetailSender</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token annotation punctuation\">@Autowired</span>\n  <span class=\"token keyword\">private</span> <span class=\"token class-name\">Source</span> source<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> users <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"user1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"user2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"user3\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"user4\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"user5\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token annotation punctuation\">@Scheduled</span><span class=\"token punctuation\">(</span>fixedDelay <span class=\"token operator\">=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">sendEvents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">UsageDetail</span> usageDetail <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setUserId</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>users<span class=\"token punctuation\">[</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setDuration</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setData</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">700</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">output</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MessageBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">withPayload</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<p>The <code class=\"language-text\">@EnableBinding</code> annotation indicates that you want to bind your application to messaging middleware.\nThe annotation takes one or more interfaces as a parameter — in this case, the <a href=\"https://github.com/spring-cloud/spring-cloud-stream/blob/master/spring-cloud-stream/src/main/java/org/springframework/cloud/stream/messaging/Source.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Source</a> interface that defines an output channel named <code class=\"language-text\">output</code>.\nIn the case of RabbitMQ, messages sent to the <code class=\"language-text\">output</code> channel are in turn sent to the RabbitMQ message broker by using a <code class=\"language-text\">TopicExchange</code>.</p>\n<p>The <code class=\"language-text\">@EnableScheduling</code> annotation indicates that you want to enable Spring's scheduling capabilities, which invokes methods annotated with <code class=\"language-text\">@Scheduled</code> with the specified <code class=\"language-text\">fixedDelay</code> of <code class=\"language-text\">1</code> second.</p>\n<p>The <code class=\"language-text\">sendEvents</code> method constructs a <code class=\"language-text\">UsageDetail</code> object and then sends it to the the output channel by accessing the <code class=\"language-text\">Source</code> object's <code class=\"language-text\">output().send()</code> method.</p>\n<h4 id=\"configuration\" style=\"position:relative;\"><a href=\"#configuration\" aria-label=\"configuration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuration</h4>\n<p>When configuring the <code class=\"language-text\">source</code> application, we need to set:</p>\n<ul>\n<li>The <code class=\"language-text\">output</code> binding destination (RabbitMQ exchange) where the producer publishes the data.</li>\n<li>The <code class=\"language-text\">requiredGroups</code> to specify the consumer groups to ensure the message delivery to consumer applications.</li>\n</ul>\n<p>In <code class=\"language-text\">src/main/resources/application.properties</code>, you can add the following properties:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">spring.cloud.stream.bindings.output.destination=usage-detail\nspring.cloud.stream.bindings.output.producer.requiredGroups=usage-cost-consumer</code></pre></div>\n      </div>\n<ul>\n<li>The <code class=\"language-text\">spring.cloud.stream.bindings.output.destination</code> property binds the <code class=\"language-text\">UsageDetailSender</code> object's output to the <code class=\"language-text\">usage-detail</code> RabbitMQ exchange.</li>\n<li>The <code class=\"language-text\">spring.cloud.stream.bindings.output.producer.requiredGroups</code> property makes sure to create a durable queue named <code class=\"language-text\">usage-detail.usage-cost-consumer</code>, which consumes from the <code class=\"language-text\">usage-detail</code> RabbitMQ exchange.</li>\n</ul>\n<h5 id=\"durable-queues\" style=\"position:relative;\"><a href=\"#durable-queues\" aria-label=\"durable queues permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Durable Queues</h5>\n<p>By default, the Spring Cloud Stream consumer application creates an <code class=\"language-text\">anonymous</code> auto-delete queue.\nThis can result in a message not being stored and forwarded by the producer if the producer application started before the consumer application.\nEven though the exchange is durable, we need a <code class=\"language-text\">durable</code> queue to be bound to the exchange for the message to be stored for later consumption.\nHence, for guaranteed message delivery, you need a <code class=\"language-text\">durable</code> queue.</p>\n<p>To pre-create durable queues and bind them to the exchange, the producer application should set the following property:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">spring.cloud.stream.bindings.&lt;channelName&gt;.producer.requiredGroups</code></pre></div>\n      </div>\n<p>The <code class=\"language-text\">requiredGroups</code> property accepts a comma-separated list of groups to which the producer must ensure message delivery.\nWhen this property is set, a durable queue is created by using the <code class=\"language-text\">&lt;exchange&gt;.&lt;requiredGroup&gt;</code> format.</p>\n<h4 id=\"building\" style=\"position:relative;\"><a href=\"#building\" aria-label=\"building permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building</h4>\n<p>Now we can build the Usage Detail Sender application.</p>\n<p>In the <code class=\"language-text\">usage-detail-sender</code> directory, use the following command to build the project using maven:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">./mvnw clean package</code></pre></div>\n      </div>\n<h4 id=\"testing\" style=\"position:relative;\"><a href=\"#testing\" aria-label=\"testing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testing</h4>\n<p>Spring Cloud Stream provides the <code class=\"language-text\">spring-cloud-stream-test-support</code> dependency to test the Spring Cloud Stream application.\nInstead of the <code class=\"language-text\">RabbitMQ</code> binder, the tests use the <code class=\"language-text\">Test</code> binder to trace and test your application's outbound and inbound messages.\nThe <code class=\"language-text\">Test</code> binder uses a utility class called <code class=\"language-text\">MessageCollector</code>, which stores the messages in-memory.</p>\n<p>To unit test the <code class=\"language-text\">UsageDetailSender</code> application, add following code in the <code class=\"language-text\">UsageDetailSenderApplicationTests</code> class:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagedetailsender</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">TimeUnit</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>fasterxml<span class=\"token punctuation\">.</span>jackson<span class=\"token punctuation\">.</span>databind<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ObjectMapper</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>json<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">JSONObject</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Test</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span>runner<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RunWith</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>beans<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Autowired</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringBootTest</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Source</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>binder<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageCollector</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Message</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>junit4<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringRunner</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span>assertTrue<span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@RunWith</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SpringRunner</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@SpringBootTest</span><span class=\"token punctuation\">(</span>webEnvironment <span class=\"token operator\">=</span> <span class=\"token class-name\">SpringBootTest</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">WebEnvironment</span><span class=\"token punctuation\">.</span>RANDOM_PORT<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageDetailSenderApplicationTests</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token annotation punctuation\">@Autowired</span>\n\t<span class=\"token keyword\">private</span> <span class=\"token class-name\">MessageCollector</span> messageCollector<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token annotation punctuation\">@Autowired</span>\n\t<span class=\"token keyword\">private</span> <span class=\"token class-name\">Source</span> source<span class=\"token punctuation\">;</span>\n\n \t<span class=\"token annotation punctuation\">@Test</span>\n \t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">contextLoads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n \t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testUsageDetailSender</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token class-name\">Message</span> message <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>messageCollector<span class=\"token punctuation\">.</span><span class=\"token function\">forChannel</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">output</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">poll</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">TimeUnit</span><span class=\"token punctuation\">.</span>SECONDS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\">String</span> usageDetailJSON <span class=\"token operator\">=</span> message<span class=\"token punctuation\">.</span><span class=\"token function\">getPayload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">assertTrue</span><span class=\"token punctuation\">(</span>usageDetailJSON<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"userId\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">assertTrue</span><span class=\"token punctuation\">(</span>usageDetailJSON<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"duration\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">assertTrue</span><span class=\"token punctuation\">(</span>usageDetailJSON<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<ul>\n<li>The <code class=\"language-text\">contextLoads</code> test case verifies that the application starts successfully.</li>\n<li>The <code class=\"language-text\">testUsageDetailSender</code> test case uses the <code class=\"language-text\">Test</code> binder's <code class=\"language-text\">MessageCollector</code> to collect the messages sent by the <code class=\"language-text\">UsageDetailSender</code>.</li>\n</ul>\n<h3 id=\"processor\" style=\"position:relative;\"><a href=\"#processor\" aria-label=\"processor permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Processor</h3>\n<p>In this step, we create the <code class=\"language-text\">UsageCostProcessor</code> processor.</p>\n<p>Either <a href=\"https://start.spring.io/starter.zip?type=maven-project&#x26;language=java&#x26;bootVersion=2.1.4.RELEASE&#x26;baseDir=usage-cost-processor-rabbit&#x26;groupId=io.spring.dataflow.sample&#x26;artifactId=usage-cost-processor-rabbit&#x26;name=usage-cost-processor-rabbit&#x26;description=Demo+project+for+Spring+Boot&#x26;packageName=io.spring.dataflow.sample.usagecostprocessor&#x26;packaging=jar&#x26;javaVersion=1.8&#x26;inputSearch=&#x26;dependencies=amqp&#x26;dependencies=cloud-stream&#x26;dependencies=actuator&#x26;dependencies=web&#x26;dependencies=cloud-connectors\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download the initialzr generated project directly</a> or visit the <a href=\"https://start.spring.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Initialzr site</a> and follow these instructions:</p>\n<ol>\n<li>Create a new Maven project with a Group name of <code class=\"language-text\">io.spring.dataflow.sample</code> and an Artifact name of <code class=\"language-text\">usage-cost-processor-rabbit</code>.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Rabbitmq</code> to select the RabbitMQ binder dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Cloud Stream</code> to select the Spring Cloud Stream dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Actuator</code> to select the Spring Boot actuator dependency.</li>\n<li>If your target platform is <code class=\"language-text\">Cloud Foundry</code>, type <code class=\"language-text\">Cloud Connectors</code> to select the Spring Cloud Connector dependency.</li>\n<li>Click the <strong>Generate Project</strong> button.</li>\n</ol>\n<p>Now you should <code class=\"language-text\">unzip</code> the <code class=\"language-text\">usage-cost-processor-rabbit.zip</code> file and import the project into your favorite IDE.</p>\n<h4 id=\"business-logic-1\" style=\"position:relative;\"><a href=\"#business-logic-1\" aria-label=\"business logic 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Business Logic</h4>\n<p>Now we can create the code required for this application. To do so:</p>\n<ol>\n<li>Create the <code class=\"language-text\">UsageDetail</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagecostprocessor</code>. Its contents resemble the contents of <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-rabbitmq/usage-cost-processor/src/main/java/io/spring/dataflow/sample/UsageDetail.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">UsageDetail.java</a>.\nThe <code class=\"language-text\">UsageDetail</code> class contains <code class=\"language-text\">userId</code>, <code class=\"language-text\">data</code>, and <code class=\"language-text\">duration</code> properties</li>\n<li>Create the <code class=\"language-text\">UsageCostDetail</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagecostprocessor</code> package. Its contents resemble the contents of <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-rabbitmq/usage-cost-processor/src/main/java/io/spring/dataflow/sample/UsageCostDetail.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">UsageCostDetail.java</a>.\nThe <code class=\"language-text\">UsageCostDetail</code> class contains <code class=\"language-text\">userId</code>, <code class=\"language-text\">callCost</code>, and <code class=\"language-text\">dataCost</code> properties.</li>\n<li>Create the <code class=\"language-text\">UsageCostProcessor</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagecostprocessor</code> package, which receives the <code class=\"language-text\">UsageDetail</code> message, computes the call and data cost, and sends a <code class=\"language-text\">UsageCostDetail</code> message. The following listing shows the source code:</li>\n</ol>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagecostprocessor</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageDetail</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">EnableBinding</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamListener</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Processor</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span>handler<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SendTo</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@EnableBinding</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Processor</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageCostProcessor</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">double</span> ratePerSecond <span class=\"token operator\">=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">double</span> ratePerMB <span class=\"token operator\">=</span> <span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token annotation punctuation\">@StreamListener</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Processor</span><span class=\"token punctuation\">.</span>INPUT<span class=\"token punctuation\">)</span>\n\t<span class=\"token annotation punctuation\">@SendTo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Processor</span><span class=\"token punctuation\">.</span>OUTPUT<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">UsageCostDetail</span> <span class=\"token function\">processUsageCost</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UsageDetail</span> usageDetail<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token class-name\">UsageCostDetail</span> usageCostDetail <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tusageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setUserId</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getUserId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tusageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setCallCost</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getDuration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ratePerSecond<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tusageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">setDataCost</span><span class=\"token punctuation\">(</span>usageDetail<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ratePerMB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> usageCostDetail<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<p>In the preceding application, the <code class=\"language-text\">@EnableBinding</code> annotation indicates that you want to bind your application to the messaging middleware. The annotation takes one or more interfaces as a parameter — in this case, the <a href=\"https://github.com/spring-cloud/spring-cloud-stream/blob/master/spring-cloud-stream/src/main/java/org/springframework/cloud/stream/messaging/Processor.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Processor</a> that defines and input and output channel.</p>\n<p>The <code class=\"language-text\">@StreamListener</code> annotation binds the application's <code class=\"language-text\">input</code> channel to the <code class=\"language-text\">processUsageCost</code> method by converting the incoming JSON into <code class=\"language-text\">UsageDetail</code> object.</p>\n<p>The <code class=\"language-text\">@SendTo</code> annotation sends the <code class=\"language-text\">processUsageCost</code> method's output to the application's <code class=\"language-text\">output</code> channel, which is, in turn, sent to the a RabbitMQ message broker by using a <code class=\"language-text\">TopicExchange</code>.</p>\n<h4 id=\"configuration-1\" style=\"position:relative;\"><a href=\"#configuration-1\" aria-label=\"configuration 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuration</h4>\n<p>When configuring the <code class=\"language-text\">processor</code> application, we need to set the following properties:</p>\n<ul>\n<li>The <code class=\"language-text\">input</code> binding destination (RabbitMQ exchange) where this application is subscribed through an <code class=\"language-text\">anonymous</code> auto-delete or <code class=\"language-text\">durable</code> queue.</li>\n<li>The <code class=\"language-text\">group</code> to specify the consumer group to which this consumer application belongs.</li>\n<li>The <code class=\"language-text\">output</code> binding destination (RabbitMQ exchange) where the producer publishes the data.</li>\n<li>The <code class=\"language-text\">requiredGroups</code> to specify the consumer groups to ensure the message delivery guarantee.</li>\n</ul>\n<p>In <code class=\"language-text\">src/main/resources/application.properties</code>, you can add the following properties:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">spring.cloud.stream.bindings.input.destination=usage-detail\nspring.cloud.stream.bindings.input.group=usage-cost-consumer\nspring.cloud.stream.bindings.output.destination=usage-cost\nspring.cloud.stream.bindings.output.producer.requiredGroups=logger</code></pre></div>\n      </div>\n<ul>\n<li>The <code class=\"language-text\">spring.cloud.stream.bindings.input.destination</code> and <code class=\"language-text\">spring.cloud.stream.bindings.input.group</code> properties bind the <code class=\"language-text\">UsageCostProcessor</code> object's <code class=\"language-text\">input</code> to the <code class=\"language-text\">usage-detail</code> RabbitMQ exchange through the <code class=\"language-text\">usage-detail.usage-cost-consumer</code> durable queue.</li>\n<li>The <code class=\"language-text\">spring.cloud.stream.bindings.output.destination</code> property binds the <code class=\"language-text\">UsageCostProcessor</code> object's output to the <code class=\"language-text\">usage-cost</code> RabbitMQ exchange.</li>\n<li>The <code class=\"language-text\">spring.cloud.stream.bindings.output.producer.requiredGroups</code> property makes sure to create a durable queue named <code class=\"language-text\">usage-cost.logger</code>, which consumes from the <code class=\"language-text\">usage-cost</code> RabbitMQ exchange.</li>\n</ul>\n<p>There are many configuration options that you can choose to extend/override to achieve the desired runtime behavior when using RabbitMQ as the message broker. The RabbitMQ-specific binder configuration properties are listed in the <a href=\"https://cloud.spring.io/spring-cloud-static/spring-cloud-stream-binder-rabbit/current/reference/html/spring-cloud-stream-binder-rabbit.html#_configuration_options\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RabbitMQ-binder documentation</a></p>\n<h4 id=\"building-1\" style=\"position:relative;\"><a href=\"#building-1\" aria-label=\"building 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building</h4>\n<p>Now we can build the Usage Cost Processor application.\nIn the <code class=\"language-text\">usage-cost-processor</code> directory, use the following command to build the project using maven.</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./mvnw clean package</code></pre></div>\n      </div>\n<h4 id=\"testing-1\" style=\"position:relative;\"><a href=\"#testing-1\" aria-label=\"testing 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testing</h4>\n<p>Spring Cloud Stream provides the <code class=\"language-text\">spring-cloud-stream-test-support</code> dependency to test the Spring Cloud Stream application. Instead of the RabbitMQ binder, it uses the <code class=\"language-text\">Test</code> binder to trace and test your application's outbound and inbound messages. The <code class=\"language-text\">Test</code> binder uses a utility class <code class=\"language-text\">MessageCollector</code>, which stores the messages in-memory.</p>\n<p>To unit test the <code class=\"language-text\">UsageCostProcessor</code>, add the following code in the <code class=\"language-text\">UsageCostProcessorApplicationTests</code> class:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagecostprocessor</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>concurrent<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">TimeUnit</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Test</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span>runner<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RunWith</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>beans<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Autowired</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringBootTest</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Processor</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>binder<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageCollector</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Message</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageBuilder</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>junit4<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringRunner</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span>assertTrue<span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@RunWith</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SpringRunner</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@SpringBootTest</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageCostProcessorApplicationTests</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token annotation punctuation\">@Autowired</span>\n  <span class=\"token keyword\">private</span> <span class=\"token class-name\">Processor</span> processor<span class=\"token punctuation\">;</span>\n\n  <span class=\"token annotation punctuation\">@Autowired</span>\n  <span class=\"token keyword\">private</span> <span class=\"token class-name\">MessageCollector</span> messageCollector<span class=\"token punctuation\">;</span>\n\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">contextLoads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testUsageCostProcessor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>processor<span class=\"token punctuation\">.</span><span class=\"token function\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MessageBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">withPayload</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{\\\"userId\\\":\\\"user3\\\",\\\"duration\\\":101,\\\"data\\\":502}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Message</span> message <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>messageCollector<span class=\"token punctuation\">.</span><span class=\"token function\">forChannel</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>processor<span class=\"token punctuation\">.</span><span class=\"token function\">output</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">poll</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">TimeUnit</span><span class=\"token punctuation\">.</span>SECONDS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">assertTrue</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">getPayload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{\\\"userId\\\":\\\"user3\\\",\\\"callCost\\\":10.100000000000001,\\\"dataCost\\\":25.1}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<ul>\n<li>The test case <code class=\"language-text\">contextLoads</code> verifies the application starts successfully.</li>\n<li>The test case <code class=\"language-text\">testUsageCostProcessor</code> uses the <code class=\"language-text\">Test</code> binder's <code class=\"language-text\">MessageCollector</code> to collect the messages from the <code class=\"language-text\">UsageCostProcessor</code> object's <code class=\"language-text\">output</code>.</li>\n</ul>\n<h3 id=\"sink\" style=\"position:relative;\"><a href=\"#sink\" aria-label=\"sink permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sink</h3>\n<p>In this step, we create the <code class=\"language-text\">UsageCostLogger</code> sink.</p>\n<p>Either <a href=\"https://start.spring.io/starter.zip?type=maven-project&#x26;language=java&#x26;bootVersion=2.1.4.RELEASE&#x26;baseDir=usage-cost-logger-rabbit&#x26;groupId=io.spring.dataflow.sample&#x26;artifactId=usage-cost-logger-rabbit&#x26;name=usage-cost-logger-rabbit&#x26;description=Demo+project+for+Spring+Boot&#x26;packageName=io.spring.dataflow.sample.usagecostlogger&#x26;packaging=jar&#x26;javaVersion=1.8&#x26;dependencies=cloud-stream&#x26;dependencies=amqp&#x26;dependencies=actuator&#x26;dependencies=web&#x26;dependencies=cloud-connectors\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download the initialzr generated project directly</a> or visit the <a href=\"https://start.spring.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Initialzr site</a> and follow these instructions:</p>\n<ol>\n<li>Create a new Maven project with a Group name of <code class=\"language-text\">io.spring.dataflow</code> and an Artifact name of <code class=\"language-text\">usage-cost-logger-rabbit</code>.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">rabbitmq</code> to select the RabbitMQ binder dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">cloud stream</code> to select the Spring Cloud Stream dependency.</li>\n<li>In the <strong>Dependencies</strong> text box, type <code class=\"language-text\">Actuator</code> to select the Spring Boot actuator dependency.</li>\n<li>If your target platform is <code class=\"language-text\">Cloud Foundry</code>, type <code class=\"language-text\">Cloud Connectors</code> to select the Spring Cloud Connector dependency.</li>\n<li>Click the <strong>Generate Project</strong> button.</li>\n</ol>\n<p>Now you should <code class=\"language-text\">unzip</code> the <code class=\"language-text\">usage-cost-logger-rabbit.zip</code> file and import the project into your favorite IDE.</p>\n<h4 id=\"business-logic-2\" style=\"position:relative;\"><a href=\"#business-logic-2\" aria-label=\"business logic 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Business Logic</h4>\n<p>To create the business logic:</p>\n<ol>\n<li>Create a <code class=\"language-text\">UsageCostDetail</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.sagecostlogger</code> package. Its contents should resemble the contents of <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/stream-developer-guides/streams/standalone-stream-rabbitmq/usage-cost-logger/src/main/java/io/spring/dataflow/sample/UsageCostDetail.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">UsageCostDetail.java</a>.\nThe <code class=\"language-text\">UsageCostDetail</code> class contains <code class=\"language-text\">userId</code>, <code class=\"language-text\">callCost</code>, and <code class=\"language-text\">dataCost</code> properties.</li>\n<li>Create the <code class=\"language-text\">UsageCostLogger</code> class in the <code class=\"language-text\">io.spring.dataflow.sample.usagecostlogger</code> package, which receives the <code class=\"language-text\">UsageCostDetail</code> message and logs it. The following listing shows the source code:</li>\n</ol>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagecostlogger</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>slf4j<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Logger</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>slf4j<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">LoggerFactory</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">EnableBinding</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamListener</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Sink</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@EnableBinding</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Sink</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageCostLogger</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Logger</span> logger <span class=\"token operator\">=</span> <span class=\"token class-name\">LoggerFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLogger</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UsageCostLoggerApplication</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token annotation punctuation\">@StreamListener</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Sink</span><span class=\"token punctuation\">.</span>INPUT<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UsageCostDetail</span> usageCostDetail<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\tlogger<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span>usageCostDetail<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<p>In the preceding application, the <code class=\"language-text\">@EnableBinding</code> annotation indicates that you want to bind your application to the messaging middleware. The annotation takes one or more interfaces as a parameter — in this case, the <a href=\"https://github.com/spring-cloud/spring-cloud-stream/blob/master/spring-cloud-stream/src/main/java/org/springframework/cloud/stream/messaging/Sink.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Sink</a> interface that defines an input channel.</p>\n<p>The <code class=\"language-text\">@StreamListener</code> annotation binds the application's <code class=\"language-text\">input</code> channel to the <code class=\"language-text\">process</code> method by converting the incoming JSON to a <code class=\"language-text\">UsageCostDetail</code> object.</p>\n<h4 id=\"configuration-2\" style=\"position:relative;\"><a href=\"#configuration-2\" aria-label=\"configuration 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuration</h4>\n<p>When configuring the <code class=\"language-text\">sink</code> application, we need to set:</p>\n<ul>\n<li>The <code class=\"language-text\">input</code> binding destination (RabbitMQ exchange) to which this application is subscribed through an <code class=\"language-text\">anonymous</code> auto-delete or <code class=\"language-text\">durable</code> queue.</li>\n<li>The <code class=\"language-text\">group</code> to specify the consumer group to which this consumer application belongs.</li>\n</ul>\n<p>In <code class=\"language-text\">src/main/resources/application.properties</code>, you can add the following properties:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">spring.cloud.stream.bindings.input.destination=usage-cost\nspring.cloud.stream.bindings.input.group=logger</code></pre></div>\n      </div>\n<p>The <code class=\"language-text\">spring.cloud.stream.bindings.input.destination</code> and <code class=\"language-text\">spring.cloud.stream.bindings.input.group</code> properties bind the <code class=\"language-text\">UsageCostLogger</code> object's <code class=\"language-text\">input</code> to the <code class=\"language-text\">usage-cost</code> RabbitMQ exchange through the <code class=\"language-text\">usage-cost.logger</code> durable queue.</p>\n<h4 id=\"building-2\" style=\"position:relative;\"><a href=\"#building-2\" aria-label=\"building 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building</h4>\n<p>Now we can build the Usage Cost Logger application.\nIn the <code class=\"language-text\">usage-cost-logger</code> directory, use the following command to build the project with Maven:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./mvnw clean package</code></pre></div>\n      </div>\n<h4 id=\"testing-2\" style=\"position:relative;\"><a href=\"#testing-2\" aria-label=\"testing 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testing</h4>\n<p>To unit test the <code class=\"language-text\">UsageCostLogger</code>, add the following code in the <code class=\"language-text\">UsageCostLoggerApplicationTests</code> class:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"> <span class=\"token keyword\">package</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span>usagecostlogger</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">io<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>dataflow<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Test</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>junit<span class=\"token punctuation\">.</span>runner<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RunWith</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>mockito<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ArgumentCaptor</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>beans<span class=\"token punctuation\">.</span>factory<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Autowired</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>autoconfigure<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">EnableAutoConfiguration</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringBootTest</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">EnableBinding</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Sink</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Bean</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Primary</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>messaging<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">MessageBuilder</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>junit4<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringRunner</span><span class=\"token punctuation\">;</span>\n\n <span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>mockito<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Mockito</span><span class=\"token punctuation\">.</span>spy<span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">import</span> <span class=\"token keyword\">static</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>mockito<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Mockito</span><span class=\"token punctuation\">.</span>verify<span class=\"token punctuation\">;</span>\n\n <span class=\"token annotation punctuation\">@RunWith</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SpringRunner</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n <span class=\"token annotation punctuation\">@SpringBootTest</span><span class=\"token punctuation\">(</span>webEnvironment <span class=\"token operator\">=</span> <span class=\"token class-name\">SpringBootTest</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">WebEnvironment</span><span class=\"token punctuation\">.</span>RANDOM_PORT<span class=\"token punctuation\">)</span>\n <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UsageCostLoggerApplicationTests</span> <span class=\"token punctuation\">{</span>\n\n \t<span class=\"token annotation punctuation\">@Autowired</span>\n \t<span class=\"token keyword\">protected</span> <span class=\"token class-name\">Sink</span> sink<span class=\"token punctuation\">;</span>\n\n \t<span class=\"token annotation punctuation\">@Autowired</span>\n \t<span class=\"token keyword\">protected</span> <span class=\"token class-name\">UsageCostLogger</span> usageCostLogger<span class=\"token punctuation\">;</span>\n\n \t<span class=\"token annotation punctuation\">@Test</span>\n \t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">contextLoads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n \t<span class=\"token punctuation\">}</span>\n\n \t<span class=\"token annotation punctuation\">@Test</span>\n \t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testUsageCostLogger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n \t\t<span class=\"token class-name\">ArgumentCaptor</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">></span></span> captor <span class=\"token operator\">=</span> <span class=\"token class-name\">ArgumentCaptor</span><span class=\"token punctuation\">.</span><span class=\"token function\">forClass</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UsageCostDetail</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sink<span class=\"token punctuation\">.</span><span class=\"token function\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MessageBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">withPayload</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{\\\"userId\\\":\\\"user3\\\",\\\"callCost\\\":10.100000000000001,\\\"dataCost\\\":25.1}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \t\t<span class=\"token function\">verify</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>usageCostLogger<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">process</span><span class=\"token punctuation\">(</span>captor<span class=\"token punctuation\">.</span><span class=\"token function\">capture</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \t<span class=\"token punctuation\">}</span>\n\n \t<span class=\"token annotation punctuation\">@EnableAutoConfiguration</span>\n \t<span class=\"token annotation punctuation\">@EnableBinding</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Sink</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n \t<span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestConfig</span> <span class=\"token punctuation\">{</span>\n\n \t\t<span class=\"token comment\">// Override `UsageCostLogger` bean for spying.</span>\n \t\t<span class=\"token annotation punctuation\">@Bean</span>\n \t\t<span class=\"token annotation punctuation\">@Primary</span>\n \t\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">UsageCostLogger</span> <span class=\"token function\">usageCostLogger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n \t\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">spy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">UsageCostLogger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \t\t<span class=\"token punctuation\">}</span>\n \t<span class=\"token punctuation\">}</span>\n <span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<ul>\n<li>The <code class=\"language-text\">contextLoads</code> test case verifies the application starts successfully.</li>\n<li>The <code class=\"language-text\">testUsageCostLogger</code> test case verifies that the <code class=\"language-text\">process</code> method of <code class=\"language-text\">UsageCostLogger</code> is invoked by using <code class=\"language-text\">Mockito</code>.\nTo do this, the static <code class=\"language-text\">TestConfig</code> class overrides the existing <code class=\"language-text\">UsageCostLogger</code> bean to create a mock bean of <code class=\"language-text\">UsageCostLogger</code>.\nSince we are mocking the <code class=\"language-text\">UsageCostLogger</code> bean, the <code class=\"language-text\">TestConfig</code> also explicitly annotates <code class=\"language-text\">@EnableBinding</code> and <code class=\"language-text\">@EnableAutoConfiguration</code>.</li>\n</ul>\n<h2 id=\"deployment\" style=\"position:relative;\"><a href=\"#deployment\" aria-label=\"deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deployment</h2>\n<p>In this section, we deploy the applications created earlier to the local machine, Cloud Foundry, and Kubernetes.</p>\n<p>When you deploy these three applications (<code class=\"language-text\">UsageDetailSender</code>, <code class=\"language-text\">UsageCostProcessor</code>, and <code class=\"language-text\">UsageCostLogger</code>), the flow of message is as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">UsageDetailSender -&gt; UsageCostProcessor -&gt; UsageCostLogger</code></pre></div>\n      </div>\n<p>The <code class=\"language-text\">UsageDetailSender</code> source application's output is connected to the <code class=\"language-text\">UsageCostProcessor</code> processor application's input.\nThe <code class=\"language-text\">UsageCostProcessor</code> application's output is connected to the <code class=\"language-text\">UsageCostLogger</code> sink application's input.</p>\n<p>When these applications run, the <code class=\"language-text\">RabbitMQ</code> binder binds the applications' output and input boundaries into the corresponding exchanges and queues at RabbitMQ message broker.</p>\n<h3 id=\"local\" style=\"position:relative;\"><a href=\"#local\" aria-label=\"local permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Local</h3>\n<p>You can run the applications as standalone applications on your <code class=\"language-text\">local</code> environment.</p>\n<p>To install and run the <code class=\"language-text\">RabbitMQ</code> docker image, run the following command:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker run -d --hostname rabbitmq --name rabbitmq -p <span class=\"token number\">15672</span>:15672 -p <span class=\"token number\">5672</span>:5672 rabbitmq:3.7.14-management</code></pre></div>\n      </div>\n<p>Once installed, you can log in to the RabbitMQ management console on your local machine on <a href=\"http://localhost:15672\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost:15672</a>.\nYou can use the default account username and password: <code class=\"language-text\">guest</code> and <code class=\"language-text\">guest</code>.</p>\n<h4 id=\"running-the-usagedetailsender-source\" style=\"position:relative;\"><a href=\"#running-the-usagedetailsender-source\" aria-label=\"running the usagedetailsender source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running the <code class=\"language-text\">UsageDetailSender</code> Source</h4>\n<p>By using the <a href=\"#configuring-the-usagedetailsender-application\">pre-defined</a> configuration properties(along with a unique server port) for <code class=\"language-text\">UsageDetailSender</code>, you can run the application, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">java -jar target/usage-detail-sender-rabbit-0.0.1-SNAPSHOT.jar --server.port=9001 &amp;</code></pre></div>\n      </div>\n<p>When this application is running, you can see that the <code class=\"language-text\">usage-detail</code> RabbitMQ exchange is created and the durable queue named <code class=\"language-text\">usage-detail.usage-cost-consumer</code> is bound to this exchange, as the following example shows:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 114.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsSAAALEgHS3X78AAACq0lEQVQ4y51VuXLiQBCd//+HTR1B4MAJVRs5cuEtExBgLhswh0FCI4QkdPG2X7PjlW3Yonaquro1R/frU6byZiiGv0Be+XOhN8TWQ7ALURQFyrJUopxlGfI81++qqnA8Hr+RKSddFD9/AMsBymlXeRxsYKMIh8MBYRgijmNsNhtst1vd+7qoyC1Timz3KewuArf3SYogsLDW6sVIFAdBgCRJcHd3h0ajgZubG7TbbUXLM67dbqd3TS5u+J4H3/fUjTC0IvuqkN/7/R6enPMhFd7e3qLZbOLh4UHRLxYLDYWnOnyY5XKJ6WSK+XyO4XCom8/Pz+h0Ovr99PSk31R+ydX6mdkLzJfxGP1+X60xRkRDA1S+Xq+VEwXP0jRVosw9lygnG/r9/v4ubvsKm4iZAGb1K5o61VF9yjIzaDXoMUJ7it926yOW2DG+WQ2JI5YNHxNlLMmqykIAcL86KQwjeSwGc9koqqPIR2RFiUNefCbZS7JTPVIhQ9Pr9VEcQiTRRgzkMMwUiYsWKlFWijvV8S/nnnKhQtAxZlysy+FgiCwvEaenWBrCZg3x8IOLAXLGl5wGiYbc2kDvaY0Kf319VW/i9HBS6NrKtZJrq0vcyfXuqC91mSic4ktZPUfOgIbkj2z4mJklsWwiSRAVX6Pw7HBgkU4mE40X0bKQXYz+Z5lTtiTQ4e6fhXw1QmZ5MV8oSg4C10bkdN2RFnWtxS6RccF1mXOusuDZjuv1RuK7vR7hpQlCAzoLWQFnJo0rs28xdG10aXGwEm0cJyrTiOuUOoAPhOwAlgwz69rQySwhjrGxjLfZbIY3oel0itFohPv7e3S73U/KFCGV9Xo9GaYjHaiDwUAUvGA8GiunotVqpWON85JlxXutVguPj4/fkJr6n+0c5Wcy+7Wj6vw3sDr0n19tBxIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/f8ddf902ba9160159c43ab2fc334eb85/507e6/standalone-rabbitmq-usage-detail-sender.webp 200w,\n/static/f8ddf902ba9160159c43ab2fc334eb85/28a80/standalone-rabbitmq-usage-detail-sender.webp 400w,\n/static/f8ddf902ba9160159c43ab2fc334eb85/8d2ea/standalone-rabbitmq-usage-detail-sender.webp 800w,\n/static/f8ddf902ba9160159c43ab2fc334eb85/df622/standalone-rabbitmq-usage-detail-sender.webp 1048w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/f8ddf902ba9160159c43ab2fc334eb85/36ca5/standalone-rabbitmq-usage-detail-sender.png 200w,\n/static/f8ddf902ba9160159c43ab2fc334eb85/a3397/standalone-rabbitmq-usage-detail-sender.png 400w,\n/static/f8ddf902ba9160159c43ab2fc334eb85/a331c/standalone-rabbitmq-usage-detail-sender.png 800w,\n/static/f8ddf902ba9160159c43ab2fc334eb85/5f503/standalone-rabbitmq-usage-detail-sender.png 1048w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/f8ddf902ba9160159c43ab2fc334eb85/a331c/standalone-rabbitmq-usage-detail-sender.png\"\n          alt=\"Standalone Usage Detail Sender RabbitMQ\"\n          title=\"Standalone Usage Detail Sender RabbitMQ\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<p>Also, if you click on the <code class=\"language-text\">Queues</code> and check the queue <code class=\"language-text\">usage-detail.usage-cost-consumer</code>, you can see the messages being consumed and stored in this durable queue, as the following example shows:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAABt0lEQVQ4y5VTa2+CQBDk//8yo/ZDP1UtqICClPdTEGF6s+YMUdu0l2y427ud3Z1ZjGH/jsF6wxja6BIfRVXicrmg6zqUZYm2bfGfZVzSAE3goi9TlEkkIE3TIMsyFEWBNEnkvFgsMJvNUNe1JBzHEcMwPJlRVA1OYYRWPUqzHHleqKrOSNNUAvlNFOhyucR8PpdzXTe4Xq/o+/7JjK8gwOpjBd/3JavOzC+DtE8vfc+7V2ZUirM8zwV9ejE9c89qaT8BTQAr4YrcVFV9v9BVktPz+fx3UcgJgx5Xz4q6m/mef1dcT4DneYiiSPY0FsA3hmWaWK1uHB6PR7iuC099t16ArbOX8263g+M42O/2sG1b3q7Xa2w2GxwOB7nTtBlUkAE0BgdKpCgMERUVsjKH7oABmh7u6aPRxy/9AkieGjUG2qGVHAelsGpDn+/+X0zmkAKwBVYWqsqYkQJNxZgGTcfn0USUWgEQkK0RTJNOMO6fxFJd8M95tQhq6NGggmybPJLXOI4RnAJRksNPP39Hqmt+mtIRuYyjWN4wVuZwmoEBplKdylmWJaoTgH4m0FQwIX2s9HFuvwFo9DoX8E0sMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/1147f57214ed4720318e94501d6149a4/507e6/standalone-rabbitmq-usage-detail-sender-message-guarantee.webp 200w,\n/static/1147f57214ed4720318e94501d6149a4/28a80/standalone-rabbitmq-usage-detail-sender-message-guarantee.webp 400w,\n/static/1147f57214ed4720318e94501d6149a4/8d2ea/standalone-rabbitmq-usage-detail-sender-message-guarantee.webp 800w,\n/static/1147f57214ed4720318e94501d6149a4/68fc1/standalone-rabbitmq-usage-detail-sender-message-guarantee.webp 1200w,\n/static/1147f57214ed4720318e94501d6149a4/b1bb6/standalone-rabbitmq-usage-detail-sender-message-guarantee.webp 1533w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/1147f57214ed4720318e94501d6149a4/36ca5/standalone-rabbitmq-usage-detail-sender-message-guarantee.png 200w,\n/static/1147f57214ed4720318e94501d6149a4/a3397/standalone-rabbitmq-usage-detail-sender-message-guarantee.png 400w,\n/static/1147f57214ed4720318e94501d6149a4/a331c/standalone-rabbitmq-usage-detail-sender-message-guarantee.png 800w,\n/static/1147f57214ed4720318e94501d6149a4/8537d/standalone-rabbitmq-usage-detail-sender-message-guarantee.png 1200w,\n/static/1147f57214ed4720318e94501d6149a4/a9604/standalone-rabbitmq-usage-detail-sender-message-guarantee.png 1533w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/1147f57214ed4720318e94501d6149a4/a331c/standalone-rabbitmq-usage-detail-sender-message-guarantee.png\"\n          alt=\"Standalone Usage Detail Sender RabbitMQ Message Guarantee\"\n          title=\"Standalone Usage Detail Sender RabbitMQ Message Guarantee\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<p>When configuring the consumer applications for this <code class=\"language-text\">Source</code> application, you can set the <code class=\"language-text\">group</code> binding property to connect to the corresponding durable queue.</p>\n<div class=\"custom-block admonition note\"><div class=\"custom-block-body\"><p>If you do not set the <code class=\"language-text\">requiredGroups</code> property, you can see that there is no <code class=\"language-text\">queue</code> for consuming the messages from the <code class=\"language-text\">usage-detail</code> exchange and, therefore, the messages are lost if the consumer is not up before this application is started.</p></div></div>\n<h4 id=\"running-the-processor\" style=\"position:relative;\"><a href=\"#running-the-processor\" aria-label=\"running the processor permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running the Processor</h4>\n<p>By using the <a href=\"#configuring-the-usagecostprocessor-application\">pre-defined</a> configuration properties (along with a unique server port) for <code class=\"language-text\">UsageCostProcessor</code>, you can run the application, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">java -jar target/usage-cost-processor-rabbit-0.0.1-SNAPSHOT.jar --server.port=9002 &amp;</code></pre></div>\n      </div>\n<p>From the RabbitMQ console, you can see:</p>\n<ul>\n<li>The <code class=\"language-text\">UsageCostProcessor</code> application consumes from the <code class=\"language-text\">usage-detail.usage-cost-consumer</code> durable queue, based on the <code class=\"language-text\">spring.cloud.stream.bindings.input.group=usage-cost-consumer</code> property.</li>\n<li>The <code class=\"language-text\">UsageCostProcessor</code> application produces the <code class=\"language-text\">UsageCostDetail</code> and sends it to the exchange <code class=\"language-text\">usage-cost</code>, based on the <code class=\"language-text\">spring.cloud.stream.bindings.output.destination=usage-cost</code> property.</li>\n<li>The <code class=\"language-text\">usage-cost.logger</code> durable queue is created. It consumes the messages from the <code class=\"language-text\">usage-cost</code> exchange, based on the <code class=\"language-text\">spring.cloud.stream.bindings.output.producer.requiredGroups=logger</code> property.</li>\n</ul>\n<p>When this application is running, you can see that the <code class=\"language-text\">usage-cost</code> RabbitMQ exchange is created and the durable queue named <code class=\"language-text\">usage-cost.logger</code> is bound to this exchange, as the following image shows:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 109.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAACfklEQVQ4y5VUyW7iQBD1/38FF4YvyB2NxIEDHKIgMYRNEGzM4hXj3W/qFZhBCWaSlsrVrrZfv1qNqshRrEYo7AVKz0blbpH5B7iBjyRNUJYliqJQybJMhXvaq6r6IgYf+e9fqEZdlOYfVOsR8uNGAc/xGVEUIQxDuK6rkqYpPi9i1Mvg45xm8IIQWV6oBALgeR7yPEeSJHAcR5l1u110Oh202230ej21+b6vQLz0fD5fAAMxWpapbOI4xm63w36/1z0BLcvSCwjy8vKi0u/31bbZbJQ1/+HFRipxWi6XejCfz2HbNrbWFoPBALPZDOPxGNZ2i2eL8by5zBfTNDGZTLBYLHA6nVQIzBspQRCoe2RbC1nVwrN6bzBjztG5Bd0ScHNjCkj4JfD3cs+KOamu3yjDmgWZMS4UBrlmE8eJZFxYXd+ZLP7MmO/3BxS5sEwisRf/APlR08qKEnFe3pjSNeowDDCdzgQsRHw6iuv5pQ7panCKkIohkRK6ibzHoiMyFGZRkopOEcueyzke8fb2Jt+VCKNYANNL2ZCl5wdwPf+qPdWehEG1lBXrzXEvdu75D5PB8BSyT68dZNBVGu+r/Tur6XuNIYPriNus9Lq16kw2SdO5uuwJmGla6goLnLpO0qMB8EwurSexsre2GthuZHlfZz9ZCsj6Y7vR9fvCrUcX2X5XjEs9hdpqLB8CEJiX0E7GPwE1HtEmEKcHLyHgfSz/6/KjwHLV3dBUMo1JYXEyKYwXKVMfDgesViudg5xE3B+lK2hnOJ4x1sLm2JpJT85l/k3f37Fer/Hx8aElRE3Xh8MhWq0WXl9fbzPwISADXk8YlesYeyQ8Z7KeMfwLiPmp/VmQO8EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/3f76c29f31d1256656933a8129c59692/507e6/standalone-rabbitmq-usage-cost-processor.webp 200w,\n/static/3f76c29f31d1256656933a8129c59692/28a80/standalone-rabbitmq-usage-cost-processor.webp 400w,\n/static/3f76c29f31d1256656933a8129c59692/8d2ea/standalone-rabbitmq-usage-cost-processor.webp 800w,\n/static/3f76c29f31d1256656933a8129c59692/f28cb/standalone-rabbitmq-usage-cost-processor.webp 1079w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/3f76c29f31d1256656933a8129c59692/36ca5/standalone-rabbitmq-usage-cost-processor.png 200w,\n/static/3f76c29f31d1256656933a8129c59692/a3397/standalone-rabbitmq-usage-cost-processor.png 400w,\n/static/3f76c29f31d1256656933a8129c59692/a331c/standalone-rabbitmq-usage-cost-processor.png 800w,\n/static/3f76c29f31d1256656933a8129c59692/b8c6a/standalone-rabbitmq-usage-cost-processor.png 1079w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/3f76c29f31d1256656933a8129c59692/a331c/standalone-rabbitmq-usage-cost-processor.png\"\n          alt=\"Standalone Usage Cost Processor RabbitMQ Required Groups\"\n          title=\"Standalone Usage Cost Processor RabbitMQ Required Groups\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<p>Also, if you click on the <code class=\"language-text\">Queues</code> and check the <code class=\"language-text\">usage-cost.logger</code> queue, you can see the messages being consumed and stored in this durable queue, as the following image shows:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAB30lEQVQ4y5VT2Y7iMBDM//8VL7ywSDwxQCabhGQg900SyFHr6h2jaIaVdixVHHfL5T6qjenjiMn6hTl28MiuqJoawzDg8Xjgdruh6zr8ZBlDHqIPHIxVijZPUCtCklRVhbIskee5kO/3e6zXa7HzwWmaXsJo2h6XMEbb35EVBbIsQ9/3SJJEdp6J3W6H1WqFMAxR1zXGcRTirzDSNMGbev3D9+WFeZ5l59JnYrloJ+ErGKxTqSJjWkuHflFfpp+gben/Rtg0jdSqbVvw/+n8rAltxH83pVJkRVHKgUQ6xXkaMX1GEsfxs24EH6KNtdWZcTFbw/M8WJaFNE0lkvv9jk5F6wURXN/D5XKB4zg4n89wXVcQRRFOpxOOxxN4n6AaeFcIN5sNttstDocDTPMdrv0bb1EBNw0Uga0iyeVBXuKeJqlESGLa+E9QFUbXtSIFnQI12BODasT4V+DjMH5rxFIqumGEoXNnY2iQrkpn1cV/CFjX8aWw+WEajE6LVjqvJuKnYyddZnSmaT7JJGVVC4K+r1Gx8Kwh/VzLMlAdhlY+wbRt2xbySCEIAlyvV9lt25Fx5Nl6t+CryWJWbAr3Qg2HjN5yrBgd5cHu+UoyJIqi+Cl6RsUIb+pMm45yuf4AizaHDnwz+MwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/2b8a9ffe290ce6c32081958b68a9be85/507e6/standalone-rabbitmq-usage-cost-processor-message-guarantee.webp 200w,\n/static/2b8a9ffe290ce6c32081958b68a9be85/28a80/standalone-rabbitmq-usage-cost-processor-message-guarantee.webp 400w,\n/static/2b8a9ffe290ce6c32081958b68a9be85/8d2ea/standalone-rabbitmq-usage-cost-processor-message-guarantee.webp 800w,\n/static/2b8a9ffe290ce6c32081958b68a9be85/68fc1/standalone-rabbitmq-usage-cost-processor-message-guarantee.webp 1200w,\n/static/2b8a9ffe290ce6c32081958b68a9be85/b1bb6/standalone-rabbitmq-usage-cost-processor-message-guarantee.webp 1533w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/2b8a9ffe290ce6c32081958b68a9be85/36ca5/standalone-rabbitmq-usage-cost-processor-message-guarantee.png 200w,\n/static/2b8a9ffe290ce6c32081958b68a9be85/a3397/standalone-rabbitmq-usage-cost-processor-message-guarantee.png 400w,\n/static/2b8a9ffe290ce6c32081958b68a9be85/a331c/standalone-rabbitmq-usage-cost-processor-message-guarantee.png 800w,\n/static/2b8a9ffe290ce6c32081958b68a9be85/8537d/standalone-rabbitmq-usage-cost-processor-message-guarantee.png 1200w,\n/static/2b8a9ffe290ce6c32081958b68a9be85/a9604/standalone-rabbitmq-usage-cost-processor-message-guarantee.png 1533w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/2b8a9ffe290ce6c32081958b68a9be85/a331c/standalone-rabbitmq-usage-cost-processor-message-guarantee.png\"\n          alt=\"Standalone Usage Cost Processor RabbitMQ Message Guarantee\"\n          title=\"Standalone Usage Cost Processor RabbitMQ Message Guarantee\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<h4 id=\"running-the-sink\" style=\"position:relative;\"><a href=\"#running-the-sink\" aria-label=\"running the sink permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running the Sink</h4>\n<p>By using the <a href=\"#configuring-the-usagecostlogger-application\">pre-defined</a> configuration properties (along with a unique server port) for <code class=\"language-text\">UsageCostLogger</code>, you can run the application, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">java -jar target/usage-cost-logger-rabbit-0.0.1-SNAPSHOT.jar --server.port=9003 &amp;</code></pre></div>\n      </div>\n<p>Now you can see that this application logs the usage cost detail it receives from the <code class=\"language-text\">usage-cost</code> RabbitMQ exchange through the <code class=\"language-text\">usage-cost.logger</code> durable queue, as the following example shows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2019-05-08 08:16:46.442  INFO 10769 --- [o6VmGALOP_onw-1] i.s.d.s.u.UsageCostLoggerApplication     : {&quot;userId&quot;: &quot;user2&quot;, &quot;callCost&quot;: &quot;28.3&quot;, &quot;dataCost&quot;: &quot;29.8&quot; }\n2019-05-08 08:16:47.446  INFO 10769 --- [o6VmGALOP_onw-1] i.s.d.s.u.UsageCostLoggerApplication     : {&quot;userId&quot;: &quot;user2&quot;, &quot;callCost&quot;: &quot;12.0&quot;, &quot;dataCost&quot;: &quot;23.75&quot; }\n2019-05-08 08:16:48.451  INFO 10769 --- [o6VmGALOP_onw-1] i.s.d.s.u.UsageCostLoggerApplication     : {&quot;userId&quot;: &quot;user4&quot;, &quot;callCost&quot;: &quot;16.0&quot;, &quot;dataCost&quot;: &quot;30.05&quot; }\n2019-05-08 08:16:49.454  INFO 10769 --- [o6VmGALOP_onw-1] i.s.d.s.u.UsageCostLoggerApplication     : {&quot;userId&quot;: &quot;user1&quot;, &quot;callCost&quot;: &quot;17.7&quot;, &quot;dataCost&quot;: &quot;18.0&quot; }</code></pre></div>\n      </div>\n<h3 id=\"cloud-foundry\" style=\"position:relative;\"><a href=\"#cloud-foundry\" aria-label=\"cloud foundry permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cloud Foundry</h3>\n<p>This section walks you through how to deploy the <code class=\"language-text\">UsageDetailSender</code>, <code class=\"language-text\">UsageCostProcessor</code>, and <code class=\"language-text\">UsageCostLogger</code> applications on PWS CloudFoundry environment.</p>\n<h4 id=\"creating-a-rabbitmq-service\" style=\"position:relative;\"><a href=\"#creating-a-rabbitmq-service\" aria-label=\"creating a rabbitmq service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating a RabbitMQ service</h4>\n<p>To create a RabbitMQ service:</p>\n<ol>\n<li>Log in to the PWS with your credentials.</li>\n<li>From the CF market place, create a RabbitMQ service instance that uses the <code class=\"language-text\">cloudamqp</code> service on the <code class=\"language-text\">lemur</code> plan, as follows:</li>\n</ol>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">cf create-service cloudamqp lemur rabbitmq</code></pre></div>\n      </div>\n<h4 id=\"cloud-foundry-deployment\" style=\"position:relative;\"><a href=\"#cloud-foundry-deployment\" aria-label=\"cloud foundry deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cloud Foundry Deployment</h4>\n<p>To deploy on Cloud Foundry:</p>\n<ol>\n<li>Create a CF manifest YAML file named <code class=\"language-text\">usage-detail-sender.yml</code> for the <code class=\"language-text\">UsageDetailSender</code> by using its <a href=\"#configuring-the-usagedetailsender-application\">configuration properties</a>, as follows:</li>\n</ol>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">applications:\n- name: usage-detail-sender\n  timeout: 120\n  path: ./target/usage-detail-sender-rabbit-0.0.1-SNAPSHOT.jar\n  memory: 1G\n  buildpack: java_buildpack\n  services:\n    - rabbitmq</code></pre></div>\n      </div>\n<p>Push the <code class=\"language-text\">UsageDetailSender</code> application by using its manifest YAML file, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cf push -f usage-detail-sender.yml</code></pre></div>\n      </div>\n<p>Create a CF manifest YAML file named <code class=\"language-text\">usage-cost-processor.yml</code> for the <code class=\"language-text\">UsageCostProcessor</code> by using its <a href=\"#configuring-the-usagecostprocessor-application\">configuration properties</a>, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">applications:\n- name: usage-cost-processor\n  timeout: 120\n  path: ./target/usage-cost-processor-rabbit-0.0.1-SNAPSHOT.jar\n  memory: 1G\n  buildpack: java_buildpack\n  services:\n    - rabbitmq</code></pre></div>\n      </div>\n<p>Push the <code class=\"language-text\">UsageCostProcessor</code> application by using its manifest YAML file, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cf push -f usage-cost-processor.yml</code></pre></div>\n      </div>\n<p>Create a CF manifest YAML file named <code class=\"language-text\">usage-cost-logger.yml</code> for the <code class=\"language-text\">UsageCostLogger</code> by using its <a href=\"#configuring-the-usagecostlogger-application\">configuration properties</a>, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">applications:\n- name: usage-cost-logger\n  timeout: 120\n  path: ./target/usage-cost-logger-rabbit-0.0.1-SNAPSHOT.jar\n  memory: 1G\n  buildpack: java_buildpack\n  services:\n    - rabbitmq</code></pre></div>\n      </div>\n<p>Push the <code class=\"language-text\">UsageCostLogger</code> application by using its manifest YAML file, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cf push -f usage-cost-logger.yml</code></pre></div>\n      </div>\n<p>You can see the applications running by using the <code class=\"language-text\">cf apps</code> command, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cf apps</code></pre></div>\n      </div>\n<p>The following listings shows typical output:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">name                   requested state   instances   memory   disk   urls\nusage-cost-logger      started           1/1         1G       1G     usage-cost-logger.cfapps.io\nusage-cost-processor   started           1/1         1G       1G     usage-cost-processor.cfapps.io\nusage-detail-sender    started           1/1         1G       1G     usage-detail-sender.cfapps.io</code></pre></div>\n      </div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">   2019-05-13T23:23:33.36+0530 [APP/PROC/WEB/0] OUT 2019-05-13 17:53:33.362  INFO 15 --- [e-cost.logger-1] i.s.d.s.u.UsageCostLoggerApplication     : {&quot;userId&quot;: &quot;user5&quot;, &quot;callCost&quot;: &quot;1.0&quot;, &quot;dataCost&quot;: &quot;12.350000000000001&quot; }\n   2019-05-13T23:23:33.46+0530 [APP/PROC/WEB/0] OUT 2019-05-13 17:53:33.467  INFO 15 --- [e-cost.logger-1] i.s.d.s.u.UsageCostLoggerApplication     : {&quot;userId&quot;: &quot;user1&quot;, &quot;callCost&quot;: &quot;19.0&quot;, &quot;dataCost&quot;: &quot;10.0&quot; }\n   2019-05-13T23:23:34.46+0530 [APP/PROC/WEB/0] OUT 2019-05-13 17:53:34.466  INFO 15 --- [e-cost.logger-1] i.s.d.s.u.UsageCostLoggerApplication     : {&quot;userId&quot;: &quot;user4&quot;, &quot;callCost&quot;: &quot;2.2&quot;, &quot;dataCost&quot;: &quot;5.15&quot; }\n   2019-05-13T23:23:35.46+0530 [APP/PROC/WEB/0] OUT 2019-05-13 17:53:35.469  INFO 15 --- [e-cost.logger-1] i.s.d.s.u.UsageCostLoggerApplication     : {&quot;userId&quot;: &quot;user3&quot;, &quot;callCost&quot;: &quot;21.0&quot;, &quot;dataCost&quot;: &quot;17.3&quot; }</code></pre></div>\n      </div>\n<h3 id=\"running-on-kubernetes\" style=\"position:relative;\"><a href=\"#running-on-kubernetes\" aria-label=\"running on kubernetes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running on Kubernetes</h3>\n<p>This section walks you through how to deploy the three Spring Cloud Stream applications on Kubernetes.</p>\n<h4 id=\"setting-up-the-kubernetes-cluster\" style=\"position:relative;\"><a href=\"#setting-up-the-kubernetes-cluster\" aria-label=\"setting up the kubernetes cluster permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setting up the Kubernetes cluster</h4>\n<p>For this example, we need a running <a href=\"/docs/1.0.x/installation/kubernetes/#creating-a-kubernetes-cluster\">Kubernetes cluster</a>. For this example, we deploy to <code class=\"language-text\">minikube</code>.</p>\n<h5 id=\"verifying-minikube-is-running\" style=\"position:relative;\"><a href=\"#verifying-minikube-is-running\" aria-label=\"verifying minikube is running permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verifying Minikube is running</h5>\n<p>To verify that you have a running Minikube instance, run the following command (show with sample output):</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token variable\">$minikube</span> status\n\nhost: Running\nkubelet: Running\napiserver: Running\nkubectl: Correctly Configured: pointing to minikube-vm at <span class=\"token number\">192.168</span>.99.100</code></pre></div>\n      </div>\n<h4 id=\"installing-rabbitmq\" style=\"position:relative;\"><a href=\"#installing-rabbitmq\" aria-label=\"installing rabbitmq permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installing RabbitMQ</h4>\n<p>You can install the RabbitMQ message broker by using the default configuration from Spring Cloud Data Flow.\nTo do so, run the following command:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f https://raw.githubusercontent.com/spring-cloud/spring-cloud-dataflow/master/src/kubernetes/rabbitmq/rabbitmq-deployment.yaml <span class=\"token punctuation\">\\</span>\n-f https://raw.githubusercontent.com/spring-cloud/spring-cloud-dataflow/master/src/kubernetes/rabbitmq/rabbitmq-svc.yaml</code></pre></div>\n      </div>\n<h4 id=\"building-the-docker-images\" style=\"position:relative;\"><a href=\"#building-the-docker-images\" aria-label=\"building the docker images permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Building the Docker Images</h4>\n<p>To build the Docker images, we use the <a href=\"https://github.com/GoogleContainerTools/jib/tree/master/jib-maven-plugin#build-your-image\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">jib maven plugin</a>. If you downloaded the <a href=\"#development\">source distribution</a>, the jib plugin is already configured. If you built the apps from scratch, add the following under <code class=\"language-text\">plugins</code> in each <code class=\"language-text\">pom.xml</code> file:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.google.cloud.tools<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>jib-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>0.10.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>from</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>image</span><span class=\"token punctuation\">></span></span>springcloud/openjdk<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>image</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>from</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>to</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>image</span><span class=\"token punctuation\">></span></span>${docker.org}/${project.artifactId}:${docker.version}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>image</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>to</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>container</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>useCurrentTimestamp</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>useCurrentTimestamp</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>container</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></code></pre></div>\n      </div>\n<p>Then add the following properties, under <code class=\"language-text\">properties</code>. For this example, we use the following properties:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>docker.org</span><span class=\"token punctuation\">></span></span>springcloudstream<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>docker.org</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>docker.version</span><span class=\"token punctuation\">></span></span>${project.version}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>docker.version</span><span class=\"token punctuation\">></span></span></code></pre></div>\n      </div>\n<p>Now run the maven build to create the Docker images in the <code class=\"language-text\">minikube</code> docker registry, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">eval</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>minikube docker-env<span class=\"token variable\">)</span></span>\n$./mvnw package jib:dockerBuild</code></pre></div>\n      </div>\n<div class=\"custom-block admonition tip\"><div class=\"custom-block-body\"><p>If you downloaded the project source, the project includes a parent pom file to build all the modules with a single command. Otherwise, run the builds for the source, processor, and sink individually. You need to run <code class=\"language-text\">eval $(minikube docker-env)</code> only once for each terminal session.</p></div></div>\n<h4 id=\"deploying-the-stream\" style=\"position:relative;\"><a href=\"#deploying-the-stream\" aria-label=\"deploying the stream permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying the Stream</h4>\n<p>To deploy the stream, you must first copy and paste the following YAML content and save it to <code class=\"language-text\">usage-cost-stream.yaml</code></p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>detail<span class=\"token punctuation\">-</span>sender\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>stream\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>detail<span class=\"token punctuation\">-</span>sender\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> springcloudstream/usage<span class=\"token punctuation\">-</span>detail<span class=\"token punctuation\">-</span>sender<span class=\"token punctuation\">-</span>rabbit<span class=\"token punctuation\">:</span>0.0.1<span class=\"token punctuation\">-</span>SNAPSHOT\n      <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_RABBITMQ_ADDRESSES\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> rabbitmq\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SERVER_PORT\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'80'</span>\n  <span class=\"token key atrule\">restartPolicy</span><span class=\"token punctuation\">:</span> Always\n\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>processor\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>stream\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>processor\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> springcloudstream/usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>processor<span class=\"token punctuation\">-</span>rabbit<span class=\"token punctuation\">:</span>0.0.1<span class=\"token punctuation\">-</span>SNAPSHOT\n      <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_RABBITMQ_ADDRESSES\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> rabbitmq\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SERVER_PORT\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'80'</span>\n  <span class=\"token key atrule\">restartPolicy</span><span class=\"token punctuation\">:</span> Always\n\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>logger\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>stream\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>logger\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> springcloudstream/usage<span class=\"token punctuation\">-</span>cost<span class=\"token punctuation\">-</span>logger<span class=\"token punctuation\">-</span>rabbit<span class=\"token punctuation\">:</span>0.0.1<span class=\"token punctuation\">-</span>SNAPSHOT\n      <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_RABBITMQ_ADDRESSES\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> rabbitmq\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SERVER_PORT\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'80'</span>\n  <span class=\"token key atrule\">restartPolicy</span><span class=\"token punctuation\">:</span> Always</code></pre></div>\n      </div>\n<p>Then you can deploy the apps, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f usage-cost-stream.yaml</code></pre></div>\n      </div>\n<p>If all is well, you should see the following output:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pod/usage-detail-sender created\npod/usage-cost-processor created\npod/usage-cost-logger created</code></pre></div>\n      </div>\n<p>The preceding YAML specifies three pod resources, for the source, processor, and sink applications. Each pod has a single container that references the respective docker image.</p>\n<p>We set the logical hostname for the RabbitMQ broker for each app to connect to it. Here we use the RabbitMQ service name, <code class=\"language-text\">rabbitmq</code> in this case. We also set the label <code class=\"language-text\">app: user-cost-stream</code> to logically group our apps.</p>\n<h4 id=\"verifying-the-deployment\" style=\"position:relative;\"><a href=\"#verifying-the-deployment\" aria-label=\"verifying the deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verifying the Deployment</h4>\n<p>To verify the deployment, use the following command to tail the log for the <code class=\"language-text\">usage-cost-logger</code> sink:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl logs -f usage-cost-logger</code></pre></div>\n      </div>\n<p>You should see messages similar to the following streaming:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:18.550  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Mark\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"21.1\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"26.05\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:19.553  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Ilaya\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"4.2\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"15.75\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:20.549  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Mark\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"28.400000000000002\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"15.0\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:21.553  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Ilaya\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"16.8\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"28.5\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:22.551  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Mark\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"22.700000000000003\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"20.3\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:23.556  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"16.6\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"2.6\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:24.557  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"6.7\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1.0\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:25.555  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Glenn\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"3.7\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"2.6500000000000004\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:26.557  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"24.200000000000003\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"32.9\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:27.556  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Glenn\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"19.200000000000003\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"7.4\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:28.559  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Sabby\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"17.7\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"27.35\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:29.562  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Ilaya\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"26.8\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"32.45\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:30.561  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"26.5\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"33.300000000000004\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:31.562  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Sabby\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"16.1\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"5.0\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:32.564  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"16.3\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"23.6\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:33.567  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Ilaya\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"29.400000000000002\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"2.1\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token number\">2019</span>-05-02 <span class=\"token number\">15</span>:48:34.567  INFO <span class=\"token number\">1</span> --- <span class=\"token punctuation\">[</span>container-0-C-1<span class=\"token punctuation\">]</span> i.s.d.s.u.UsageCostLoggerApplication     <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"userId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Janne\"</span>, <span class=\"token string\">\"callCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"5.2\"</span>, <span class=\"token string\">\"dataCost\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"20.200000000000003\"</span> <span class=\"token punctuation\">}</span></code></pre></div>\n      </div>\n<h4 id=\"cleaning-up\" style=\"position:relative;\"><a href=\"#cleaning-up\" aria-label=\"cleaning up permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cleaning Up</h4>\n<p>To delete the stream, we can use the label we created earlier, as follows:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete pod -l <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>usage-cost-stream</code></pre></div>\n      </div>\n<p>To uninstall RabbitMQ, run the following command:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete all -l <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>rabbitmq</code></pre></div>\n      </div>\n<h2 id=\"whats-next\" style=\"position:relative;\"><a href=\"#whats-next\" aria-label=\"whats next permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What's Next</h2>\n<p>The <a href=\"/docs/1.0.x/stream-developer-guides/streams/standalone-stream-kafka/\">Apache Kafka guide</a> shows you how to create the same three applications but with Apache Kafka instead.\nAlternatively, you can use Spring Cloud Data Flow to deploy the three applications, as detailed in <a href=\"/docs/1.0.x/stream-developer-guides/streams/data-flow-stream/\">Stream Processing using Spring Cloud Data Flow</a>.</p>","headings":[{"value":"Stream Processing with RabbitMQ","depth":1},{"value":"Development","depth":2},{"value":"Source","depth":3},{"value":"Business Logic","depth":4},{"value":"Configuration","depth":4},{"value":"Durable Queues","depth":5},{"value":"Building","depth":4},{"value":"Testing","depth":4},{"value":"Processor","depth":3},{"value":"Business Logic","depth":4},{"value":"Configuration","depth":4},{"value":"Building","depth":4},{"value":"Testing","depth":4},{"value":"Sink","depth":3},{"value":"Business Logic","depth":4},{"value":"Configuration","depth":4},{"value":"Building","depth":4},{"value":"Testing","depth":4},{"value":"Deployment","depth":2},{"value":"Local","depth":3},{"value":"Running the <code class=\"language-text\">UsageDetailSender</code> Source","depth":4},{"value":"Running the Processor","depth":4},{"value":"Running the Sink","depth":4},{"value":"Cloud Foundry","depth":3},{"value":"Creating a RabbitMQ service","depth":4},{"value":"Cloud Foundry Deployment","depth":4},{"value":"Running on Kubernetes","depth":3},{"value":"Setting up the Kubernetes cluster","depth":4},{"value":"Verifying Minikube is running","depth":5},{"value":"Installing RabbitMQ","depth":4},{"value":"Building the Docker Images","depth":4},{"value":"Deploying the Stream","depth":4},{"value":"Verifying the Deployment","depth":4},{"value":"Cleaning Up","depth":4},{"value":"What's Next","depth":2}],"fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/standalone-stream-rabbitmq/","version":"1.0.x","category":"stream-developer-guides","sourcePath":"pages/3-stream-developer-guides/2-streams/1-standalone-stream-rabbitmq.md"},"frontmatter":{"title":"Stream Application Development on RabbitMQ","summary":null,"path":"stream-developer-guides/streams/standalone-stream-rabbitmq/","toc":null,"prevNext":null}}},"pageContext":{"slug":"/docs/1.0.x/stream-developer-guides/streams/standalone-stream-rabbitmq/","version":"1.0.x","versionPath":""}},"staticQueryHashes":["1084522749","2044043181"]}