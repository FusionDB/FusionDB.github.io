{"componentChunkName":"component---src-templates-documentation-js","path":"/docs/1.0.x/recipes/batch/sftp-to-jdbc/","result":{"data":{"pages":{"edges":[{"node":{"id":"a7163ea7-fee2-59e2-93a9-97295900514c","fields":{"path":"/docs/1.0.x/installation/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Installation","description":"How to install Data Flow","path":"installation/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bd5a11a7-18e7-51b4-b947-2bc07cfbe3a3","fields":{"path":"/docs/1.0.x/installation/local/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Local Machine","description":"Local Machine Installation Guide","path":"installation/local/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"768f6200-d825-5a92-8fb0-d9d4f8526774","fields":{"path":"/docs/1.0.x/installation/local/docker/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Docker Compose","description":"Installation using Docker Compose","path":"installation/local/docker","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ed09e37c-0ee2-5a34-9ebd-531a260bbb27","fields":{"path":"/docs/1.0.x/installation/local/docker-customize/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Docker Compose Customization","description":"Customize the Docker Compose installation","path":"installation/local/docker-customize","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1f4acbf8-19d9-5571-8144-f6bdbb17673e","fields":{"path":"/docs/1.0.x/installation/local/manual/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Manual","description":"Manual installation","path":"installation/local/manual","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9187e14f-7805-52c1-9523-5662cc0bd05c","fields":{"path":"/docs/1.0.x/installation/cloudfoundry/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Cloud Foundry","description":"Data Flow Cloud Foundry Installation Guide","path":"installation/cloudfoundry/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a9d29299-0143-5805-9560-ceea1b8cd733","fields":{"path":"/docs/1.0.x/installation/cloudfoundry/cf-cli/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Cloud Foundry CLI","description":"Install using the Cloud Foundry CLI","path":"installation/cloudfoundry/cf-cli","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e2dd0da6-655a-5dce-9a94-432190a36574","fields":{"path":"/docs/1.0.x/installation/cloudfoundry/cf-local/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Running locally","description":"Configure the local servers to deploy to Cloud Foundry","path":"installation/cloudfoundry/cf-local","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"aa81741b-4e8f-5fe0-8180-b3b35c334f0a","fields":{"path":"/docs/1.0.x/installation/kubernetes/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Kubernetes","description":"Data Flow Kubernetes Installation Guide","path":"installation/kubernetes/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0bc509b9-db54-5702-a81e-b07664512949","fields":{"path":"/docs/1.0.x/installation/kubernetes/creating-a-cluster/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Creating a Cluster","description":"Creating a Kubernetes Cluster","path":"installation/kubernetes/creating-a-cluster","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f89cb3e7-dec0-569b-ac11-140d9cfd2d67","fields":{"path":"/docs/1.0.x/installation/kubernetes/helm/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Helm","description":"Installation using Helm","path":"installation/kubernetes/helm","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"6e3e57c0-9b0c-5ba0-81aa-060a1bb1e756","fields":{"path":"/docs/1.0.x/installation/kubernetes/kubectl/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"kubectl","description":"Installation using kubectl","path":"installation/kubernetes/kubectl","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c30d6475-ca22-5473-be63-985c9c083df8","fields":{"path":"/docs/1.0.x/installation/kubernetes/compatibility/","version":"1.0.x","category":"installation"},"frontmatter":{"title":"Kubernetes Compatibility","description":"Compatibility with Kubernetes Versions","path":"installation/kubernetes/compatibility","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4dbf43e6-0df8-53b6-b39f-2c70b6828763","fields":{"path":"/docs/1.0.x/design/","version":"1.0.x","category":"design"},"frontmatter":{"title":"Design","description":"FusionDB design guides","path":"design/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5a2858ae-3b79-55aa-8df1-647ba72aa53e","fields":{"path":"/docs/1.0.x/design/concept/","version":"1.0.x","category":"design"},"frontmatter":{"title":"Concept","description":"design of concept","path":"design/concept/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f58b38f1-eb57-55e6-b728-d8e3eeee0598","fields":{"path":"/docs/1.0.x/design/fql/","version":"1.0.x","category":"design"},"frontmatter":{"title":"SQL Layer","description":"SQL Layer","path":"design/fql/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bd069586-c290-529b-bde5-b4c61a092b74","fields":{"path":"/docs/1.0.x/design/core/","version":"1.0.x","category":"design"},"frontmatter":{"title":"Core Layer","description":"core layer","path":"design/core/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"8d26cb10-fc16-58e0-b279-45a91d727de4","fields":{"path":"/docs/1.0.x/design/runtime/","version":"1.0.x","category":"design"},"frontmatter":{"title":"Runtime","description":"runtime","path":"design/runtime/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bc1203e6-5c24-53ef-b7d5-b3991641cdf9","fields":{"path":"/docs/1.0.x/design/developer/","version":"1.0.x","category":"design"},"frontmatter":{"title":"Developer","description":"developer","path":"design/developer/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0c42c162-4438-5ab6-b02f-2b6f41249831","fields":{"path":"/docs/1.0.x/concepts/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Concepts","description":"Core Concepts in Spring Cloud Data Flow","path":"concepts/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f47d7680-99d8-579c-9dcd-02996bd06384","fields":{"path":"/docs/1.0.x/concepts/architecture/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Architecture","description":"Introduction to Data Flow's Architecture.","path":"concepts/architecture/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"dfc24dc1-1a43-5a42-902f-1026287574e2","fields":{"path":"/docs/1.0.x/concepts/streams/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Stream Processing","description":"Stream Processing Framework and Concepts","path":"concepts/streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"05f7a75c-e562-586f-8f96-037e7286bfd8","fields":{"path":"/docs/1.0.x/concepts/batch-jobs/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Batch Processing","description":"Batch Processing Framework and Concepts","path":"concepts/batch-jobs/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"7303a994-5abf-5a72-b277-45ffcdee4f94","fields":{"path":"/docs/1.0.x/concepts/monitoring/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Monitoring","description":"Runtime monitoring of Stream data pipelines","path":"concepts/monitoring/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c6b97537-de48-5131-817c-887a6fe1737e","fields":{"path":"/docs/1.0.x/concepts/tooling/","version":"1.0.x","category":"concepts"},"frontmatter":{"title":"Tooling","description":"Dashboard and Shell","path":"concepts/tooling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"549f2604-a208-557f-9ddb-97b59fb49d8d","fields":{"path":"/docs/1.0.x/stream-developer-guides/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Developer guides ","description":"Learn how to create Streaming data pipelines using prebuilt microservices or create your own.","path":"stream-developer-guides/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5c3d87ba-a23e-5278-949b-45177dd60e7d","fields":{"path":"/docs/1.0.x/stream-developer-guides/getting-started/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Getting Started","description":"Getting Started with Stream Processing","path":"stream-developer-guides/getting-started/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"30d8143a-a157-5987-aa8d-beb7f891ca54","fields":{"path":"/docs/1.0.x/stream-developer-guides/getting-started/stream/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Processing","description":"Create and deploy a streaming data pipeline using prebuilt applications on your Local Machine","path":"stream-developer-guides/getting-started/stream/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bb31aa1b-70a3-511c-b1ef-9f8919098de0","fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Development","description":"Stream Processing Developer Guide","path":"stream-developer-guides/streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"d434a513-de03-56c9-97b6-bdfcde73ca8c","fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/standalone-stream-rabbitmq/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Application Development on RabbitMQ","description":"Create your own microservices for Stream processing using RabbitMQ and deploy them manually","path":"stream-developer-guides/streams/standalone-stream-rabbitmq/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"b37a90e1-3d89-515b-a905-415846b703df","fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/standalone-stream-kafka/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Application Development on Apache Kafka","description":"Create your own microservices for Stream processing using Apache Kafka and deploy them manually","path":"stream-developer-guides/streams/standalone-stream-kafka/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"7c7daf75-55ef-59f5-9b14-55525f8b6df6","fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/data-flow-stream/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Stream Processing using Spring Cloud Data Flow","description":"Create and Deploy a Stream Processing Pipeline using Spring Cloud Data Flow","path":"stream-developer-guides/streams/data-flow-stream/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"621b87c8-4882-5c45-874d-e7997d9a4814","fields":{"path":"/docs/1.0.x/stream-developer-guides/streams/stream-other-binders/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Spring Application Development on other Messaging Middleware","description":"Create your own microservices for Stream processing using other messaging middleware such as Google Pub/Sub, Amazon Kinesis, and Solace JMS","path":"stream-developer-guides/streams/stream-other-binders/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c58d486a-d5d6-55fc-aabd-ba45cb90dfea","fields":{"path":"/docs/1.0.x/stream-developer-guides/programming-models/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Programming Models","description":"Programming models","path":"stream-developer-guides/programming-models/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"75d3de31-78b4-5b83-9854-d8a02fc374ff","fields":{"path":"/docs/1.0.x/stream-developer-guides/continuous-delivery/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Continuous Delivery","description":"CD using Skipper","path":"stream-developer-guides/continuous-delivery/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c43a1bb1-f77b-5dbb-9129-f8bbccc3f143","fields":{"path":"/docs/1.0.x/stream-developer-guides/continuous-delivery/cd-basics/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Continuous Delivery of streaming applications","description":"Continuous Delivery of Streaming applications","path":"stream-developer-guides/continuous-delivery/cd-basics/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"453f1240-1e06-501e-84d6-f5c75294f51b","fields":{"path":"/docs/1.0.x/stream-developer-guides/troubleshooting/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Troubleshooting","description":"Troubleshooting Streams","path":"stream-developer-guides/troubleshooting/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9880ea3d-b6ff-5f0f-b6cc-5e369e6f7532","fields":{"path":"/docs/1.0.x/stream-developer-guides/troubleshooting/debugging-stream-apps/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Debugging Stream Applications","description":"Debugging Stream Applications outside of Data Flow","path":"stream-developer-guides/troubleshooting/debugging-stream-apps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3beeb29d-18a6-5f43-90fe-68f959519e78","fields":{"path":"/docs/1.0.x/stream-developer-guides/troubleshooting/debugging-scdf-streams/","version":"1.0.x","category":"stream-developer-guides"},"frontmatter":{"title":"Debugging Stream applications deployed by Data Flow","description":"Debugging Data Flow Stream deployments","path":"stream-developer-guides/troubleshooting/debugging-scdf-streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0eed7576-fb62-53fa-99ea-7e52579622fd","fields":{"path":"/docs/1.0.x/batch-developer-guides/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Batch Developer guides ","description":"Learn how to create Batch data pipelines using prebuilt microservices or create your own","path":"batch-developer-guides/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"102bd156-c483-51bb-88f5-fa855409c280","fields":{"path":"/docs/1.0.x/batch-developer-guides/getting-started/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Getting Started","description":"Getting Started with Batch","path":"batch-developer-guides/getting-started/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ea535601-baa1-5bfe-9153-75372559647c","fields":{"path":"/docs/1.0.x/batch-developer-guides/getting-started/task/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Task Processing","description":"Create and deploy a simple Task pipeline using a prebuilt Task application on your local machine","path":"batch-developer-guides/getting-started/task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"850aaf5b-ad19-5a57-bd92-d05ce20a94f3","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Batch Development","description":"Batch Developer Guide","path":"batch-developer-guides/batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"dec105a5-4b6f-5f71-9351-b196a8277c30","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/spring-task/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Simple Task","description":"Create a simple Spring Boot Application using Spring Cloud Task","path":"batch-developer-guides/batch/spring-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9479ba94-433e-52f3-8bd0-3fa5566870dc","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/spring-batch/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Spring Batch Jobs","description":"Create a Spring Batch Job","path":"batch-developer-guides/batch/spring-batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"444e21c6-559a-536d-b239-67427a6e6e59","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/data-flow-simple-task/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Register and Launch a Spring Cloud Task application using Data Flow","description":"Register and Launch a Spring Cloud Task application using Data Flow","path":"batch-developer-guides/batch/data-flow-simple-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c36bf11d-6a72-528f-a52b-76c85db1002e","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/data-flow-spring-batch/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Register and launch a Spring Batch application using Data Flow","description":"Register and launch a Spring Batch application using Data Flow","path":"batch-developer-guides/batch/data-flow-spring-batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"8229c50e-ed25-5c35-b801-74ddb159ad25","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/data-flow-composed-task/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Create and launch a Composed Task using Data Flow","description":"Create and launch a Composed Task using Data Flow","path":"batch-developer-guides/batch/data-flow-composed-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"6a82f60f-8635-5b10-a8c0-919bb4e421b7","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/data-flow-simple-task-kubernetes/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Deploying a task application on Kubernetes with Data Flow","description":"Guide to deploying spring-cloud-stream-task applications on Kubernetes using Spring Cloud Data Flow","path":"batch-developer-guides/batch/data-flow-simple-task-kubernetes/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e3203d7d-4257-57da-91ce-fb162be67962","fields":{"path":"/docs/1.0.x/batch-developer-guides/batch/data-flow-simple-task-cloudfoundry/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Deploying a task application on Cloud Foundry using Spring Cloud Data Flow","description":"Guide to deploying spring-cloud-stream-task applications on Cloud Foundry using Spring Cloud Data Flow","path":"batch-developer-guides/batch/data-flow-simple-task-cloudfoundry/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4b4804df-3108-5a77-9a1b-9acf3d7993c1","fields":{"path":"/docs/1.0.x/batch-developer-guides/continuous-deployment/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Continuous Deployment","description":"Continuous Deployment for task applications","path":"batch-developer-guides/continuous-deployment/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"42f40244-c1c6-54d0-9f55-19a6abeb1e18","fields":{"path":"/docs/1.0.x/batch-developer-guides/continuous-deployment/cd-basics/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Continuous Deployment of task applications","description":"This section discusses how to use Continuous Deployment of Tasks in SCDF","path":"batch-developer-guides/continuous-deployment/cd-basics/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"aff8ddff-db2c-58b7-8318-eb71b0345870","fields":{"path":"/docs/1.0.x/batch-developer-guides/troubleshooting/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Troubleshooting","description":"Troubleshooting Batch Jobs","path":"batch-developer-guides/troubleshooting/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9306cc1f-4df5-5f11-9c91-38630700a788","fields":{"path":"/docs/1.0.x/batch-developer-guides/troubleshooting/debugging-task-apps/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Debugging Batch applications","description":"Debugging Batch applications","path":"batch-developer-guides/troubleshooting/debugging-task-apps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ac39f173-da48-5471-af07-8cc0ae79c5a6","fields":{"path":"/docs/1.0.x/batch-developer-guides/troubleshooting/debugging-scdf-tasks/","version":"1.0.x","category":"batch-developer-guides"},"frontmatter":{"title":"Debugging Batch applications deployed by Data Flow","description":"Debugging Batch applications deployed by Data Flow","path":"batch-developer-guides/troubleshooting/debugging-scdf-tasks/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"f756eab0-a1c7-5519-91b8-b756b66427d5","fields":{"path":"/docs/1.0.x/feature-guides/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Feature guides","description":"High level overview of Data Flow Features","path":"feature-guides/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a6130b0a-97c5-58c9-a992-8a913de8363c","fields":{"path":"/docs/1.0.x/feature-guides/general/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"General","description":"General Features in Data Flow","path":"feature-guides/general/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"2da44c23-5791-5f72-98e7-b06ad935f91a","fields":{"path":"/docs/1.0.x/feature-guides/general/application-metadata/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Application Metadata","description":"Create and use application properties metadata","path":"feature-guides/general/application-metadata/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"9595e887-0056-5bf5-81fe-af8041b4f37a","fields":{"path":"/docs/1.0.x/feature-guides/streams/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Streams","description":"Stream Features in Data Flow","path":"feature-guides/streams/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"beec2961-d478-51c8-a16d-1f8381bc054a","fields":{"path":"/docs/1.0.x/feature-guides/streams/deployment-properties/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Deployment Properties","description":"Initiate a stream deployment with deployment property overrides","path":"feature-guides/streams/deployment-properties/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1bc3d5fc-8110-5fdd-80cd-6e943f6cbf84","fields":{"path":"/docs/1.0.x/feature-guides/streams/function-composition/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Composing Functions","description":"Daisy-chain Java functions in an existing Spring Cloud Stream application","path":"feature-guides/streams/function-composition/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a2850433-5830-5d6b-929e-ef00b1ffe2dd","fields":{"path":"/docs/1.0.x/feature-guides/streams/named-destinations/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Named Destinations","description":"Use the Named Destinations to interact with the Topics/Queues directly","path":"feature-guides/streams/named-destinations/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0b1fdd2b-63ee-55e4-ac39-c1af84975009","fields":{"path":"/docs/1.0.x/feature-guides/streams/monitoring/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Stream Monitoring","description":"Monitoring streaming data pipelines with Prometheus and InfluxDB","path":"feature-guides/streams/monitoring/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"1f7e22c3-dd60-59eb-89aa-d32ff0aa146e","fields":{"path":"/docs/1.0.x/feature-guides/streams/stream-application-dsl/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Stream Application DSL","description":"Learn how to use the Stream Application DSL","path":"feature-guides/streams/stream-application-dsl/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"8f9cb8a7-8f95-5e41-9b7b-64f217f9ad53","fields":{"path":"/docs/1.0.x/feature-guides/streams/labels/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Labeling Applications","description":"Label the stream applications to uniquely interact with them","path":"feature-guides/streams/labels/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"dadb6660-e6bd-5e0a-a0cc-5ffd6c97ac39","fields":{"path":"/docs/1.0.x/feature-guides/streams/application-count/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Application Count","description":"Initiate stream deployment with multiple application instances","path":"feature-guides/streams/application-count/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"22c21f61-5468-5a3c-9b95-944b4587bb94","fields":{"path":"/docs/1.0.x/feature-guides/streams/fanin-fanout/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Fan-in and Fan-out","description":"Publish and subscribe to multiple destinations using the fan-in and fan-out capabilities","path":"feature-guides/streams/fanin-fanout/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a1bcdf2b-cf7d-5ba3-be0f-717da33a7598","fields":{"path":"/docs/1.0.x/feature-guides/streams/partitioning/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Data Partitioning","description":"Learn more about data partitioning support to build stateful streaming data pipelines","path":"feature-guides/streams/partitioning/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"2b2f20ee-7207-5d37-9938-46f11ebfbb35","fields":{"path":"/docs/1.0.x/feature-guides/streams/scaling/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Scaling","description":"Scaling streaming data pipeline with Spring Cloud Data Flow","path":"feature-guides/streams/scaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e48190e2-51d0-5e97-be89-ddec511e3c8e","fields":{"path":"/docs/1.0.x/feature-guides/streams/java-dsl/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Java DSL","description":"Programmatically create streams using the Java DSL","path":"feature-guides/streams/java-dsl/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"74c1c9cc-59a1-56e3-84b0-d37c2cc01644","fields":{"path":"/docs/1.0.x/feature-guides/streams/taps/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Tapping a Stream","description":"Create a stream from another stream without interrupting the data processing","path":"feature-guides/streams/taps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c0fc1912-0647-5493-8682-ad556ca18123","fields":{"path":"/docs/1.0.x/feature-guides/batch/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Batch","description":"Batch Features in Data Flow","path":"feature-guides/batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ef7306d1-1bb4-5c4f-a6d4-6a1916fb9936","fields":{"path":"/docs/1.0.x/feature-guides/batch/deployment-properties/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Deployment Properties","description":"Initiate a Batch deployment with deployment property overrides","path":"feature-guides/batch/deployment-properties/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"0bf731f8-f15b-5fa5-93c6-66a1a50a217e","fields":{"path":"/docs/1.0.x/feature-guides/batch/scheduling/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Scheduling Batch Jobs","description":"Learn how to schedule Batch Jobs","path":"feature-guides/batch/scheduling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"8634ea59-9d3a-5a8c-893b-d2410db40a50","fields":{"path":"/docs/1.0.x/feature-guides/batch/partitioning/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Remote Partitioned Batch Job","description":"Learn more about partitioning support for Batch Jobs","path":"feature-guides/batch/partitioning/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"b1fe2d75-240a-5805-9e57-d7a22fd00967","fields":{"path":"/docs/1.0.x/feature-guides/batch/monitoring/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Task Monitoring","description":"Monitoring task data pipelines with InfluxDB","path":"feature-guides/batch/monitoring/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"be9476c4-fca5-5462-bd55-1fec11d57015","fields":{"path":"/docs/1.0.x/feature-guides/batch/restarting/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Restarting Batch Jobs","description":"Learn how to restart Batch Jobs","path":"feature-guides/batch/restarting/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3ae5c6a5-8daa-5e78-ac01-62e5055f259d","fields":{"path":"/docs/1.0.x/feature-guides/batch/composed-task/","version":"1.0.x","category":"feature-guides"},"frontmatter":{"title":"Composed Tasks","description":"Learn how to create and manage composed tasks","path":"feature-guides/batch/composed-task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c9418073-406e-5381-9caa-c1f4f5de3bd0","fields":{"path":"/docs/1.0.x/recipes/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Recipes","description":"Recipes that help solve some common use-cases","path":"recipes/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"c1e87d44-5cad-57de-9697-b938aacb6787","fields":{"path":"/docs/1.0.x/recipes/polyglot/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Polyglot","description":"Using multiple programming languages","path":"recipes/polyglot/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"6fcdc3d3-3437-555c-bd6c-ae9a555d7cdc","fields":{"path":"/docs/1.0.x/recipes/polyglot/processor/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Python Stream Processor","description":"Python Application as a Data Flow Stream Processor","path":"recipes/polyglot/processor/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e2182467-6e67-518d-a081-7bac0ab112bf","fields":{"path":"/docs/1.0.x/recipes/polyglot/task/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Python Task","description":"Create and Deploy a Python Task","path":"recipes/polyglot/task/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5bbaaf56-042c-519c-bf0c-479b8296ca3f","fields":{"path":"/docs/1.0.x/recipes/polyglot/app/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Python Application","description":"Create and Deploy a Python Application in a Stream","path":"recipes/polyglot/app/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ab2e3101-f6b7-585f-aa51-f589b6cd53f1","fields":{"path":"/docs/1.0.x/recipes/rabbitmq/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"RabbitMQ","description":"RabbitMQ","path":"recipes/rabbitmq/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e7ac46b6-d8da-5011-95cd-3bd677878f2d","fields":{"path":"/docs/1.0.x/recipes/rabbitmq/rabbit-source-sink/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"RabbitMQ as Source and Sink","description":"RabbitMQ as Source and Sink + RabbitMQ binder","path":"recipes/rabbitmq/rabbit-source-sink/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"beaa0cd8-6417-5886-92d1-f86fb0fb9be9","fields":{"path":"/docs/1.0.x/recipes/kafka/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Apache Kafka","description":"Kafka","path":"recipes/kafka/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"926fbf39-6a6c-51ba-8ce1-0c88b1583941","fields":{"path":"/docs/1.0.x/recipes/kafka/ext-kafka-cluster-cf/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"External Kafka Cluster","description":"Connect to an external Kafka Cluster from Cloud Foundry","path":"recipes/kafka/ext-kafka-cluster-cf/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5e8ac125-4c49-5506-b8b7-96fd7eb225a0","fields":{"path":"/docs/1.0.x/recipes/kinesis/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Amazon Kinesis","description":"Amazon Kinesis","path":"recipes/kinesis/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"85cce150-f34f-5e56-8d1c-474e13a59c60","fields":{"path":"/docs/1.0.x/recipes/kinesis/simple-producer-consumer/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Amazon Kinesis Binder","description":"A sample of Spring Cloud Stream + Amazon Kinesis Binder in action","path":"recipes/kinesis/simple-producer-consumer/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"17cf6afa-cacd-51b1-a38d-269c327433bd","fields":{"path":"/docs/1.0.x/recipes/multi-platform-deployment/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Multiple Platform Deployments","description":"Multiple Platform Deployments","path":"recipes/multi-platform-deployment/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3cecd815-ef4e-5849-a3bd-8244340450c3","fields":{"path":"/docs/1.0.x/recipes/multi-platform-deployment/multiple-platform-accounts/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Role of Multiple Platform Deployments","description":"A walk-through of multiple platform requirements and the configurations for Cloud Foundry and Kubernetes","path":"recipes/multi-platform-deployment/multiple-platform-accounts","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"24631eae-3b20-587f-ad1e-ec09f0a70b92","fields":{"path":"/docs/1.0.x/recipes/scaling/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Scaling","description":"Prometheus and Data Flow to autoscale streaming data pipelines","path":"recipes/scaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"a8642f26-c053-56c4-9d54-d98f6d52e6a2","fields":{"path":"/docs/1.0.x/recipes/scaling/manual-scaling/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Manual Scaling","description":"Scale applications using SCDF Shell","path":"recipes/scaling/manual-scaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ab0eae66-b0a8-5173-9f37-3f7f7954a307","fields":{"path":"/docs/1.0.x/recipes/scaling/autoscaling/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Autoscaling","description":"Autoscale streaming data pipeline with SCDF and Prometheus","path":"recipes/scaling/autoscaling/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"4bdd938e-edb1-5932-b003-c44f6b7b7362","fields":{"path":"/docs/1.0.x/recipes/batch/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Batch","description":"Using Spring Cloud Data Flow with Spring Batch","path":"recipes/batch/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"5f7e4b28-d4d4-5db2-b8f6-5cf784348f99","fields":{"path":"/docs/1.0.x/recipes/batch/batch-only-mode/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Batch-only Mode","description":"Set up Spring Cloud Data Flow to use only batch and not streams","path":"recipes/batch/batch-only-mode/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"05184c9b-cfba-5ba5-9989-bfa5fcdff52b","fields":{"path":"/docs/1.0.x/recipes/batch/sftp-to-jdbc/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"SFTP to JDBC","description":"Ingest Files from SFTP to a JDBC data store using Data Flow and Spring Batch","path":"recipes/batch/sftp-to-jdbc/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3b1f9b94-4bb5-5a7e-95b4-406de275f1e3","fields":{"path":"/docs/1.0.x/recipes/functional-apps/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Functional Applications","description":"Using Functional Approach in Spring Cloud Stream applications","path":"recipes/functional-apps/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"09de46bd-144f-515c-8ceb-fe299888efa8","fields":{"path":"/docs/1.0.x/recipes/functional-apps/scst-function-bindings/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Functional Applications","description":"Configuring the Spring Cloud Stream Functional applications","path":"recipes/functional-apps/scst-function-bindings/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"2219bb7b-fe37-58d5-983b-c8f87bc826db","fields":{"path":"/docs/1.0.x/recipes/cloud-providers/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"Cloud Providers","description":"Using functionality provided by cloud providers","path":"recipes/cloud-providers/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"e6479091-7b1b-5c7c-beab-754b1d921760","fields":{"path":"/docs/1.0.x/recipes/cloud-providers/gke-regional-clusters/","version":"1.0.x","category":"recipes"},"frontmatter":{"title":"GKE Regional Clusters","description":"Deploying Spring Cloud Data Flow to a GKE Regional Cluster","path":"recipes/cloud-providers/gke-regional-clusters/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"3ed354bf-b384-5e0f-aa07-7ccb41a8dc84","fields":{"path":"/docs/1.0.x/resources/","version":"1.0.x","category":"resources"},"frontmatter":{"title":"Resources","description":"Sample Applications, References Docs, Videos, Blogs...","path":"resources/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"dbb3d525-e9e5-5de6-8a1e-3de452708798","fields":{"path":"/docs/1.0.x/resources/reference-docs/","version":"1.0.x","category":"resources"},"frontmatter":{"title":"Reference Documentation","description":"Collection of reference guides for Spring Cloud Data Flow","path":"resources/reference-docs/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"ba1fee96-388f-5785-bd61-2c828c0380b4","fields":{"path":"/docs/1.0.x/resources/samples/","version":"1.0.x","category":"resources"},"frontmatter":{"title":"Samples","description":"Collection of samples","path":"resources/samples/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"bac2f165-b025-53f8-aa62-9218cb36cc52","fields":{"path":"/docs/1.0.x/resources/faq/","version":"1.0.x","category":"resources"},"frontmatter":{"title":"Frequently Asked Questions","description":"","path":"resources/faq/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"310d895e-f2b0-51e9-ac91-5b2b527c8a6e","fields":{"path":"/docs/1.0.x/applications/","version":"1.0.x","category":"applications"},"frontmatter":{"title":"Applications","description":"Using stream and task applications","path":"applications/","meta_title":null,"meta_description":null,"keywords":null}}},{"node":{"id":"438e7b00-2573-56f0-a213-853e846f5e60","fields":{"path":"/docs/1.0.x/applications/pre-packaged/","version":"1.0.x","category":"applications"},"frontmatter":{"title":"Pre-packaged Applications","description":"Pre-packaged stream and task applications","path":"applications/pre-packaged","meta_title":null,"meta_description":null,"keywords":["application","pre-packaged"]}}}]},"page":{"html":"<h1 id=\"sftp-to-jdbc-file-ingest\" style=\"position:relative;\"><a href=\"#sftp-to-jdbc-file-ingest\" aria-label=\"sftp to jdbc file ingest permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SFTP to JDBC File Ingest</h1>\n<p>This recipe provides step by step instructions to build a Data Flow pipeline to ingest files from an SFTP source and save the contents to a JDBC data store.\nThe pipeline is designed to launch a task whenever a new file is detected by the SFTP source.\nIn this case, the task is a Spring Batch job that processes the file, converting the contents of each line to uppercase, and inserting it into a table.</p>\n<p>The <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/tree/master/dataflow-website/recipes/file-ingest/file-to-jdbc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">file ingest</a> batch job reads from a CSV text file with lines formatted as <code class=\"language-text\">first_name,last_name</code> and writes each entry to a database table using a <a href=\"https://docs.spring.io/spring-batch/trunk/apidocs/org/springframework/batch/item/database/JdbcBatchItemWriter.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">JdbcBatchItemWriter</a>] that executes <code class=\"language-text\">INSERT INTO people (first_name, last_name) VALUES (:firstName, :lastName)</code> for each line.</p>\n<p>You can <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/recipes/file-ingest/file-to-jdbc/file-to-jdbc.zip?raw=true\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">download the project</a> that contains the source code and sample data from your browser, or from the command line:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/recipes/file-ingest/file-to-jdbc/file-to-jdbc.zip?raw<span class=\"token operator\">=</span>true -O file-to-jdbc.zip</code></pre></div>\n      </div>\n<div class=\"admonition tip\"><p>If you choose not to build the task application yourself, the executable jar is published to the <a href=\"https://repo.spring.io/libs-snapshot-local/io/spring/cloud/dataflow/ingest/ingest/1.0.0.BUILD-SNAPSHOT/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Maven repository</a> and to the <a href=\"https://hub.docker.com/r/springcloud/ingest/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">springcloud/ingest</a> Docker repository.</p></div>\n<p>The pipeline is built using the following pre-packaged Spring Cloud Stream applications:</p>\n<ul>\n<li><a href=\"https://github.com/spring-cloud-stream-app-starters/sftp/tree/master/spring-cloud-starter-stream-source-sftp-dataflow\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sftp-dataflow-source</a> an SFTP source configured to emit a Task Launch Request whenever it detects a new file in one or more polled SFTP directories.</li>\n<li><a href=\"https://github.com/spring-cloud-stream-app-starters/tasklauncher-dataflow/tree/master/spring-cloud-starter-stream-sink-task-launcher-dataflow\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dataflow-task-launcher-sink</a> a sink that acts as a REST client to the Data Flow server to launch a Data Flow task.</li>\n</ul>\n<p>This pipeline runs on all supported Data Flow platforms.\nThe SFTP source downloads each file from the SFTP server to a local directory before sending the task launch request.\nThe request sets <code class=\"language-text\">localFilePath</code> as a command line argument for the task. When running on a cloud platform, we need to mount a shared directory available to the SFTP source container and the task container.\nFor this example, we will set up an NFS mounted directory.\nConfiguring the environment and containers for NFS is platform specific and is described here for Cloud Foundry v2.3+ and minikube.</p>\n<h2 id=\"prerequisites\" style=\"position:relative;\"><a href=\"#prerequisites\" aria-label=\"prerequisites permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Prerequisites</h2>\n<h3 id=\"data-flow-installation\" style=\"position:relative;\"><a href=\"#data-flow-installation\" aria-label=\"data flow installation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Data Flow Installation</h3>\n<p>Make sure you have installed Spring Cloud Data Flow to the platform of your choice:</p>\n<ul>\n<li><a href=\"/docs/1.0.x/installation/local/\">Local</a></li>\n<li><a href=\"/docs/1.0.x/installation/cloudfoundry/\">Cloud Foundry</a></li>\n<li><a href=\"/docs/1.0.x/installation/kubernetes/\">Kubernetes</a></li>\n</ul>\n<!-- TODO: Support for Postgres -->\n<div class=\"admonition note\"><p><strong>NOTE</strong>: For kubernetes, the sample task application is configured to use <code class=\"language-text\">mysql</code>. The Data Flow server must also be configured for mysql.</p></div>\n<h3 id=\"using-data-flow\" style=\"position:relative;\"><a href=\"#using-data-flow\" aria-label=\"using data flow permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using Data Flow</h3>\n<p>This example assumes that you know how to use Spring Cloud Data Flow to register and deploy applications using the Spring Cloud Data Flow dashboard or the Spring Cloud Data Flow shell. If you need further instructions on using Data Flow please refer to <a href=\"/docs/1.0.x/stream-developer-guides/streams/data-flow-stream/\">Stream Processing using Spring Cloud Data Flow</a> and <a href=\"/docs/1.0.x/batch-developer-guides/batch/data-flow-spring-batch/\">Register and launch a batch application using Spring Cloud Data Flow</a>.</p>\n<h3 id=\"sftp-server\" style=\"position:relative;\"><a href=\"#sftp-server\" aria-label=\"sftp server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SFTP server</h3>\n<p>This example requires access to an SFTP server. For running on a <code class=\"language-text\">local</code> machine and <code class=\"language-text\">minikube</code>, we will use the host machine as the SFTP server. For <code class=\"language-text\">Cloud Foundry</code>, and <code class=\"language-text\">Kubernetes</code> in general, an external SFTP server is required.\nOn the SFTP server, create a <code class=\"language-text\">/remote-files</code> directory. This is where we will drop files to trigger the pipeline.</p>\n<h3 id=\"nfs-configuration\" style=\"position:relative;\"><a href=\"#nfs-configuration\" aria-label=\"nfs configuration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NFS configuration</h3>\n<div class=\"admonition tip\"><p>NFS is not required when running locally.</p></div>\n<h4 id=\"cloud-foundry-nfs-configuration\" style=\"position:relative;\"><a href=\"#cloud-foundry-nfs-configuration\" aria-label=\"cloud foundry nfs configuration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cloud Foundry NFS configuration</h4>\n<p>This feature is provided in Pivotal Cloud Foundry by <a href=\"https://docs.pivotal.io/pivotalcf/2-5/devguide/services/using-vol-services.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NFS Volume Services</a></p>\n<p>To run this example, we will need:</p>\n<ul>\n<li>a Cloud Foundry instance v2.3+ with NFS Volume Services <a href=\"https://docs.pivotal.io/pivotalcf/2-5/opsguide/enable-vol-services.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">enabled</a></li>\n<li>An NFS server accessible from the Cloud Foundry instance</li>\n<li>An <code class=\"language-text\">nfs</code> service instance properly configured</li>\n</ul>\n<div class=\"admonition note\"><p><strong>NOTE:</strong> For simplicity, this example assumes the <code class=\"language-text\">nfs</code> service is created with common configuration as follows with a common mount point <code class=\"language-text\">/var/scdf</code> for all bound apps. It is also possible to set these parameters when binding the nfs service to an application using <a href=\"https://docs.spring.io/spring-cloud-dataflow/docs/current/reference/htmlsingle/#configure-service-binding-parameters\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">deployment propterties</a>:</p><div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">cf create-service nfs Existing nfs -c <span class=\"token string\">'{\"share\":&lt;nfs-host>/staging\",\"uid\":&lt;uid>,\"gid\":&lt;gid>, \"mount\":\"/var/scdf\"}'</span></code></pre></div>\n      </div></div>\n<h4 id=\"kubernetes-nfs-configuration\" style=\"position:relative;\"><a href=\"#kubernetes-nfs-configuration\" aria-label=\"kubernetes nfs configuration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kubernetes NFS configuration</h4>\n<p>Kubernetes provides many options for configuring and sharing persistent volumes. For this example, we will use <code class=\"language-text\">minikube</code> and use the host machine as the NFS server. The following instructions works for <code class=\"language-text\">OS/X</code> and should be similar for Linux hosts:</p>\n<p>Make sure minikube is started. The commands below provide NFS access to the minikube VM. The minikube IP is subject to change each time it is started, so these steps should be performed after each start.</p>\n<p>Here we will expose a shared directory called <code class=\"language-text\">/staging</code>.</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> /staging\n<span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> <span class=\"token number\">777</span> /staging\n<span class=\"token function\">sudo</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"/staging -alldirs -mapall=\"</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">id</span> -u<span class=\"token variable\">)</span></span><span class=\"token string\">\":\"</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">id</span> -g<span class=\"token variable\">)</span></span><span class=\"token string\">\" <span class=\"token variable\"><span class=\"token variable\">$(</span>minikube <span class=\"token function\">ip</span><span class=\"token variable\">)</span></span>\"</span> <span class=\"token operator\">>></span> /etc/exports\n<span class=\"token function\">sudo</span> nfsd restart</code></pre></div>\n      </div>\n<p>Verify the nfs mounts:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">showmount -e <span class=\"token number\">127.0</span>.0.1\nExports list on <span class=\"token number\">127.0</span>.0.1:\n/staging <span class=\"token number\">192.168</span>.99.105</code></pre></div>\n      </div>\n<p>Configure persistent volume and persistent volume claim resources. Copy the following and save it to a file named <code class=\"language-text\">nfs-config.yml</code>:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> PersistentVolume\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nfs<span class=\"token punctuation\">-</span>volume\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">capacity</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">storage</span><span class=\"token punctuation\">:</span> 4Gi\n  <span class=\"token key atrule\">accessModes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> ReadWriteMany\n  <span class=\"token key atrule\">persistentVolumeReclaimPolicy</span><span class=\"token punctuation\">:</span> Retain\n  <span class=\"token key atrule\">storageClassName</span><span class=\"token punctuation\">:</span> standard\n  <span class=\"token key atrule\">nfs</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># The address 192.168.99.1 is the Minikube gateway to the host for VirtualBox. This way</span>\n    <span class=\"token comment\"># not the container IP will be visible by the NFS server on the host machine,</span>\n    <span class=\"token comment\"># but the IP address of the `minikube ip` command. You will need to</span>\n    <span class=\"token comment\"># grant access to the `minikube ip` IP address.</span>\n    <span class=\"token key atrule\">server</span><span class=\"token punctuation\">:</span> 192.168.99.1\n    <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/staging'</span>\n\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> PersistentVolumeClaim\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nfs<span class=\"token punctuation\">-</span>volume<span class=\"token punctuation\">-</span>claim\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> default\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">storageClassName</span><span class=\"token punctuation\">:</span> standard\n  <span class=\"token key atrule\">accessModes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> ReadWriteMany\n  <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">storage</span><span class=\"token punctuation\">:</span> 4Gi</code></pre></div>\n      </div>\n<p>Create the resources:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f nfs-config.yml</code></pre></div>\n      </div>\n<h2 id=\"deployment\" style=\"position:relative;\"><a href=\"#deployment\" aria-label=\"deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deployment</h2>\n<h3 id=\"local\" style=\"position:relative;\"><a href=\"#local\" aria-label=\"local permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Local</h3>\n<p>For local deployment, this example uses Kafka as the message broker.\nCreate directories for the remote and local files:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> -p /tmp/remote-files /tmp/local-files</code></pre></div>\n      </div>\n<h4 id=\"register-the-applications\" style=\"position:relative;\"><a href=\"#register-the-applications\" aria-label=\"register the applications permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Register the applications</h4>\n<p>If you downloaded and built the <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/recipes/file-ingest/file-to-jdbc/file-to-jdbc.zip?raw=true\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sample project</a>, you can register it using a <code class=\"language-text\">file://</code> url, e.g. <code class=\"language-text\">file://&lt;path-to-project&gt;/target/ingest-1.0.0-SNAPSHOT.jar</code>\nOtherwise use the published maven jar:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">app register --name fileIngest --type task --uri maven://io.spring.cloud.dataflow.ingest:ingest:1.0.0.BUILD-SNAPSHOT</code></pre></div>\n      </div>\n<p>Register the prepackaged <code class=\"language-text\">sftp</code> source and <code class=\"language-text\">task-launcher</code> sink applications:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">app register --name <span class=\"token function\">sftp</span> --type <span class=\"token builtin class-name\">source</span>  --uri maven://org.springframework.cloud.stream.app:sftp-dataflow-source-kafka:2.1.0.RELEASE</code></pre></div>\n      </div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">app register --name task-launcher --type sink --uri maven://org.springframework.cloud.stream.app:task-launcher-dataflow-sink-kafka:1.0.1.RELEASE</code></pre></div>\n      </div>\n<h4 id=\"create-the-task\" style=\"position:relative;\"><a href=\"#create-the-task\" aria-label=\"create the task permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Create the task</h4>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">task create fileIngestTask --definition fileIngest</code></pre></div>\n      </div>\n<h4 id=\"create-and-deploy-the-stream\" style=\"position:relative;\"><a href=\"#create-and-deploy-the-stream\" aria-label=\"create and deploy the stream permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Create and deploy the stream</h4>\n<div class=\"admonition note\"><p><strong>NOTE</strong>: Replace <code class=\"language-text\">&lt;user&gt;</code> and <code class=\"language-text\">&lt;pass&gt;</code> below.\nThe <code class=\"language-text\">username</code> and <code class=\"language-text\">password</code> are the credentials for the local (or remote) user.\nIf you are not using a local SFTP server, specify the host using the <code class=\"language-text\">host</code>,\nand optionally <code class=\"language-text\">port</code>, parameters. If not defined, <code class=\"language-text\">host</code> defaults to <code class=\"language-text\">127.0.0.1</code>\nand <code class=\"language-text\">port</code> defaults to <code class=\"language-text\">22</code>.</p></div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">stream create --name inboundSftp --definition <span class=\"token string\">\"sftp --username=&lt;user> --password=&lt;pass> --allow-unknown-keys=true --task.launch.request.taskName=fileIngestTask --remote-dir=/tmp/remote-files/ --local-dir=/tmp/local-files/ | task-launcher\"</span> --deploy</code></pre></div>\n      </div>\n<div class=\"admonition tip\"><p>The <a href=\"https://github.com/spring-cloud-stream-app-starters/tasklauncher-dataflow/tree/master/spring-cloud-starter-stream-sink-task-launcher-dataflow\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dataflow-task-launcher-sink</a> uses a <a href=\"https://docs.spring.io/spring-cloud-stream/docs/Elmhurst.BUILD-SNAPSHOT/api/org/springframework/cloud/stream/binder/PollableMessageSource.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PollableMessageSource</a> controlled by a dynamic trigger with exponential backoff. By default, the sink polls its input destination every 1 second. If there are no task launch requests, the polling period will continue to double up to a maximum of 30 seconds. If a task launch request is present, the trigger resets to 1 second. The trigger parameters may be configured by setting the <code class=\"language-text\">task-launcher</code> sink properties <code class=\"language-text\">trigger.period</code> and <code class=\"language-text\">trigger.max-period</code> in the stream definition.</p></div>\n<h4 id=\"verify-stream-deployment\" style=\"position:relative;\"><a href=\"#verify-stream-deployment\" aria-label=\"verify stream deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verify Stream deployment</h4>\n<p>We can see the status of the streams to be deployed with <code class=\"language-text\">stream list</code>, for example:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow:<span class=\"token operator\">></span>stream list\n╔═══════════╤════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╤════════════════════════════╗\n║Stream Name│                                                         Stream Definition                                                          │           Status           ║\n╠═══════════╪════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╪════════════════════════════╣\n║inboundSftp│sftp --password<span class=\"token operator\">=</span><span class=\"token string\">'******'</span> --remote-dir<span class=\"token operator\">=</span>/tmp/remote-files/ --local-dir<span class=\"token operator\">=</span>/tmp/local-files/ --task.launch.request.taskName<span class=\"token operator\">=</span>fileIngestTask│The stream has been         ║\n║           │--allow-unknown-keys<span class=\"token operator\">=</span>true --username<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>user<span class=\"token operator\">></span> <span class=\"token operator\">|</span> task-launcher                                                                         │successfully deployed       ║\n╚═══════════╧════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╧════════════════════════════╝</code></pre></div>\n      </div>\n<h4 id=\"inspect-the-application-logs\" style=\"position:relative;\"><a href=\"#inspect-the-application-logs\" aria-label=\"inspect the application logs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inspect the application logs</h4>\n<p>In the event the stream failed to deploy, or you would like to inspect the logs for any reason, you can get the location of the logs to applications created for the <code class=\"language-text\">inboundSftp</code> stream using the <code class=\"language-text\">runtime apps</code> command:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow:<span class=\"token operator\">></span>runtime apps\n╔═══════════════════════════╤═══════════╤════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗\n║   App Id / Instance Id    │Unit Status│                                                                     No. of Instances / Attributes                                                                      ║\n╠═══════════════════════════╪═══════════╪════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣\n║inboundSftp.sftp           │ deployed  │                                                                                   <span class=\"token number\">1</span>                                                                                    ║\n║                           │           │       guid <span class=\"token operator\">=</span> <span class=\"token number\">23057</span>                                                                                                                                                     ║\n║                           │           │        pid <span class=\"token operator\">=</span> <span class=\"token number\">71927</span>                                                                                                                                                     ║\n║                           │           │       port <span class=\"token operator\">=</span> <span class=\"token number\">23057</span>                                                                                                                                                     ║\n╟───────────────────────────┼───────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╢\n║inboundSftp.sftp-0         │ deployed  │     stderr <span class=\"token operator\">=</span> /var/folders/hd/5yqz2v2d3sxd3n879f4sg4gr0000gn/T/spring-cloud-deployer-120915912946760306/inboundSftp-1540821009913/inboundSftp.sftp/stderr_0.log         ║\n║                           │           │     stdout <span class=\"token operator\">=</span> /var/folders/hd/5yqz2v2d3sxd3n879f4sg4gr0000gn/T/spring-cloud-deployer-120915912946760306/inboundSftp-1540821009913/inboundSftp.sftp/stdout_0.log         ║\n║                           │           │        url <span class=\"token operator\">=</span> http://192.168.64.1:23057                                                                                                                                 ║\n║                           │           │working.dir <span class=\"token operator\">=</span> /var/folders/hd/5yqz2v2d3sxd3n879f4sg4gr0000gn/T/spring-cloud-deployer-120915912946760306/inboundSftp-1540821009913/inboundSftp.sftp                      ║\n╟───────────────────────────┼───────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╢\n║inboundSftp.task-launcher  │ deployed  │                                                                                   <span class=\"token number\">1</span>                                                                                    ║\n╟───────────────────────────┼───────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╢\n║                           │           │       guid <span class=\"token operator\">=</span> <span class=\"token number\">60081</span>                                                                                                                                                     ║\n║                           │           │        pid <span class=\"token operator\">=</span> <span class=\"token number\">71926</span>                                                                                                                                                     ║\n║                           │           │       port <span class=\"token operator\">=</span> <span class=\"token number\">60081</span>                                                                                                                                                     ║\n║inboundSftp.task-launcher-0│ deployed  │     stderr <span class=\"token operator\">=</span> /var/folders/hd/5yqz2v2d3sxd3n879f4sg4gr0000gn/T/spring-cloud-deployer-120915912946760306/inboundSftp-1540820991695/inboundSftp.task-launcher/stderr_0.log║\n║                           │           │     stdout <span class=\"token operator\">=</span> /var/folders/hd/5yqz2v2d3sxd3n879f4sg4gr0000gn/T/spring-cloud-deployer-120915912946760306/inboundSftp-1540820991695/inboundSftp.task-launcher/stdout_0.log║\n║                           │           │        url <span class=\"token operator\">=</span> http://192.168.64.1:60081                                                                                                                                 ║\n║                           │           │working.dir <span class=\"token operator\">=</span> /var/folders/hd/5yqz2v2d3sxd3n879f4sg4gr0000gn/T/spring-cloud-deployer-120915912946760306/inboundSftp-1540820991695/inboundSftp.task-launcher             ║\n╚═══════════════════════════╧═══════════╧════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝</code></pre></div>\n      </div>\n<h4 id=\"drop-a-file-into-the-remote-directory\" style=\"position:relative;\"><a href=\"#drop-a-file-into-the-remote-directory\" aria-label=\"drop a file into the remote directory permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Drop a file into the remote directory</h4>\n<p>Normally data would be uploaded to an SFTP server.\nWe will simulate this by copying a file into the directory specified by <code class=\"language-text\">--remote-dir</code>.\nSample data can be found in the <code class=\"language-text\">data/</code> directory of the <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/recipes/file-ingest/file-to-jdbc/file-to-jdbc.zip?raw=true\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sample project</a>.</p>\n<p>Copy <code class=\"language-text\">data/name-list.csv</code> into the <code class=\"language-text\">/tmp/remote-files</code> directory which the SFTP source is monitoring.\nWhen this file is detected, the <code class=\"language-text\">sftp</code> source will download it to the <code class=\"language-text\">/tmp/local-files</code> directory specified by <code class=\"language-text\">--local-dir</code>, and emit a Task Launch Request.\nThe Task Launch Request includes the name of the task to launch along with the local file path, given as a command line argument.\nSpring Batch binds each command line argument to a corresponding JobParameter.\nThe FileIngestTask job processes the file given by the JobParameter named <code class=\"language-text\">localFilePath</code>.\nSince there have not been any recent requests, the task will launch within 30 seconds after the request is published (see tip above about configuring the launch trigger).</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cp</span> data/name-list.csv /tmp/remote-files</code></pre></div>\n      </div>\n<p>When the batch job launches, you will see something like this in the SCDF console log:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token number\">2018</span>-10-26 <span class=\"token number\">16</span>:47:24.879  INFO <span class=\"token number\">86034</span> --- <span class=\"token punctuation\">[</span>nio-9393-exec-7<span class=\"token punctuation\">]</span> o.s.c.d.spi.local.LocalTaskLauncher      <span class=\"token builtin class-name\">:</span> Command to be executed: /Library/Java/JavaVirtualMachines/jdk1.8.0_60.jdk/Contents/Home/jre/bin/java -jar <span class=\"token operator\">&lt;</span>path-to<span class=\"token operator\">></span>/batch/file-ingest/target/ingest-1.0.0.jar <span class=\"token assign-left variable\">localFilePath</span><span class=\"token operator\">=</span>/tmp/local-files/name-list.csv --spring.cloud.task.executionid<span class=\"token operator\">=</span><span class=\"token number\">1</span>\n<span class=\"token number\">2018</span>-10-26 <span class=\"token number\">16</span>:47:25.100  INFO <span class=\"token number\">86034</span> --- <span class=\"token punctuation\">[</span>nio-9393-exec-7<span class=\"token punctuation\">]</span> o.s.c.d.spi.local.LocalTaskLauncher      <span class=\"token builtin class-name\">:</span> launching task fileIngestTask-8852d94d-9dd8-4760-b0e4-90f75ee028de\n   Logs will be <span class=\"token keyword\">in</span> /var/folders/hd/5yqz2v2d3sxd3n879f4sg4gr0000gn/T/fileIngestTask3100511340216074735/1540586844871/fileIngestTask-8852d94d-9dd8-4760-b0e4-90f75ee028de</code></pre></div>\n      </div>\n<h4 id=\"inspect-job-executions\" style=\"position:relative;\"><a href=\"#inspect-job-executions\" aria-label=\"inspect job executions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inspect Job Executions</h4>\n<p>After data is received and the batch job runs, it will be recorded as a Job Execution. We can view job executions by for example issuing the following command in the Spring Cloud Data Flow shell:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow:<span class=\"token operator\">></span>job execution list\n╔═══╤═══════╤═════════╤════════════════════════════╤═════════════════════╤══════════════════╗\n║ID │Task ID│Job Name │         Start Time         │Step Execution Count │Definition Status ║\n╠═══╪═══════╪═════════╪════════════════════════════╪═════════════════════╪══════════════════╣\n║1  │1      │ingestJob│Tue May 01 <span class=\"token number\">23</span>:34:05 EDT <span class=\"token number\">2018</span>│1                    │Created           ║\n╚═══╧═══════╧═════════╧════════════════════════════╧═════════════════════╧══════════════════╝</code></pre></div>\n      </div>\n<p>As well as list more details about that specific job execution:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow:<span class=\"token operator\">></span>job execution display --id <span class=\"token number\">1</span>\n╔═══════════════════════════════════════╤══════════════════════════════╗\n║                  Key                  │            Value             ║\n╠═══════════════════════════════════════╪══════════════════════════════╣\n║Job Execution Id                       │1                             ║\n║Task Execution Id                      │1                             ║\n║Task Instance Id                       │1                             ║\n║Job Name                               │ingestJob                     ║\n║Create Time                            │Fri Oct <span class=\"token number\">26</span> <span class=\"token number\">16</span>:57:51 EDT <span class=\"token number\">2018</span>  ║\n║Start Time                             │Fri Oct <span class=\"token number\">26</span> <span class=\"token number\">16</span>:57:51 EDT <span class=\"token number\">2018</span>  ║\n║End Time                               │Fri Oct <span class=\"token number\">26</span> <span class=\"token number\">16</span>:57:53 EDT <span class=\"token number\">2018</span>  ║\n║Running                                │false                         ║\n║Stopping                               │false                         ║\n║Step Execution Count                   │1                             ║\n║Execution Status                       │COMPLETED                     ║\n║Exit Status                            │COMPLETED                     ║\n║Exit Message                           │                              ║\n║Definition Status                      │Created                       ║\n║Job Parameters                         │                              ║\n║-spring.cloud.task.executionid<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span> │1                             ║\n║run.id<span class=\"token punctuation\">(</span>LONG<span class=\"token punctuation\">)</span>                           │1                             ║\n║localFilePath<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span>                  │/tmp/local-files/name-list.csv║\n╚═══════════════════════════════════════╧══════════════════════════════╝</code></pre></div>\n      </div>\n<h4 id=\"verify-data\" style=\"position:relative;\"><a href=\"#verify-data\" aria-label=\"verify data permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verify data</h4>\n<p>When the the batch job runs, it processes the file in the local directory <code class=\"language-text\">/tmp/local-files</code> and transforms each item to uppercase names and inserts it into the database.</p>\n<p>You may use any database tool that supports the H2 database to inspect the data.\nIn this example we use the database tool <code class=\"language-text\">DBeaver</code>.\nLets inspect the table to ensure our data was processed correctly.</p>\n<p>Within DBeaver, create a connection to the database using the JDBC URL <code class=\"language-text\">jdbc:h2:tcp://localhost:19092/mem:dataflow</code>, and user <code class=\"language-text\">sa</code> with no password.\nWhen connected, expand the <code class=\"language-text\">PUBLIC</code> schema, then expand <code class=\"language-text\">Tables</code> and then double click on the table <code class=\"language-text\">PEOPLE</code>.\nWhen the table data loads, click the \"Data\" tab to view the data.</p>\n<h3 id=\"cloud-foundry\" style=\"position:relative;\"><a href=\"#cloud-foundry\" aria-label=\"cloud foundry permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cloud Foundry</h3>\n<h4 id=\"prerequisites-1\" style=\"position:relative;\"><a href=\"#prerequisites-1\" aria-label=\"prerequisites 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Prerequisites</h4>\n<p>Running this example on Cloud Foundry requires configuring an NFS server and creating an <code class=\"language-text\">nfs</code> service to access it as discribed in the <a href=\"/docs/1.0.x/recipes/file-ingest/sftp-to-jdbc/#cloud-foundry-nfs-configuration\">Cloud Foundry NFS Configuration</a> section.\nWe also require an external SFTP server with a <code class=\"language-text\">/remote-files</code> directory.</p>\n<p>This also requires:</p>\n<ul>\n<li>A <code class=\"language-text\">mysql</code> service instance</li>\n<li>A <code class=\"language-text\">rabbit</code> service instance</li>\n<li><a href=\"https://github.com/pivotal-cf/PivotalMySQLWeb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PivotalMySQLWeb</a> or another database tool to view the data</li>\n</ul>\n<h4 id=\"register-the-applications-1\" style=\"position:relative;\"><a href=\"#register-the-applications-1\" aria-label=\"register the applications 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Register the applications</h4>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">app register --name fileIngest --type task --uri maven://io.spring.cloud.dataflow.ingest:ingest:1.0.0.BUILD-SNAPSHOT</code></pre></div>\n      </div>\n<p>Register the prepackaged <code class=\"language-text\">sftp</code> source and <code class=\"language-text\">task-launcher</code> sink applications:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">app register --name <span class=\"token function\">sftp</span> --type <span class=\"token builtin class-name\">source</span>  --uri maven://org.springframework.cloud.stream.app:sftp-dataflow-source-kafka:2.1.0.RELEASE</code></pre></div>\n      </div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">app register --name task-launcher --type sink --uri maven://org.springframework.cloud.stream.app:task-launcher-dataflow-sink-kafka:1.0.1.RELEASE</code></pre></div>\n      </div>\n<h4 id=\"create-the-task-1\" style=\"position:relative;\"><a href=\"#create-the-task-1\" aria-label=\"create the task 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Create the task</h4>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">task create fileIngestTask --definition fileIngest</code></pre></div>\n      </div>\n<h4 id=\"create-the-stream\" style=\"position:relative;\"><a href=\"#create-the-stream\" aria-label=\"create the stream permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Create the stream</h4>\n<p>The <code class=\"language-text\">sftp</code> source is configured to publish a task launch request to launch the <code class=\"language-text\">fileIngestTask</code> task.\nThe launch request binds the <code class=\"language-text\">nfs</code> service to the task container using deployment properties <code class=\"language-text\">task.launch.request.deployment-properties=deployer.*.cloudfoundry.services=nfs</code>.</p>\n<div class=\"admonition note\"><p><strong>NOTE</strong>: Replace <code class=\"language-text\">&lt;user&gt;</code>, <code class=\"language-text\">&lt;pass&gt;</code>,<code class=\"language-text\">&lt;host&gt;</code> and <code class=\"language-text\">&lt;data-flow-server-uri&gt;</code> in the stream definition below.</p></div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">stream create --name inboundSftp --definition <span class=\"token string\">\"sftp --username=&lt;user> --password=&lt;pass> --host=&lt;host>  --allow-unknown-keys=true --remote-dir=/remote-files/ --local-dir=/var/scdf/shared-files/ --task.launch.request.taskName=fileIngestTask --task.launch.request.deployment-properties=deployer.*.cloudfoundry.services=nfs | task-launcher --spring.cloud.dataflow.client.server-uri=&lt;data-flow-server-uri>\"</span></code></pre></div>\n      </div>\n<div class=\"admonition tip\"><p>The <a href=\"https://github.com/spring-cloud-stream-app-starters/tasklauncher-dataflow/tree/master/spring-cloud-starter-stream-sink-task-launcher-dataflow\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dataflow-task-launcher-sink</a> uses a <a href=\"https://docs.spring.io/spring-cloud-stream/docs/Elmhurst.BUILD-SNAPSHOT/api/org/springframework/cloud/stream/binder/PollableMessageSource.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PollableMessageSource</a> controlled by a dynamic trigger with exponential backoff. By default, the sink polls its input destination every 1 second. If there are no task launch requests, the polling period will continue to double up to a maximum of 30 seconds. If a task launch request is present, the trigger resets to 1 second. The trigger parameters may be configured by setting the <code class=\"language-text\">task-launcher</code> sink properties <code class=\"language-text\">trigger.period</code> and <code class=\"language-text\">trigger.max-period</code> in the stream definition.</p></div>\n<h4 id=\"deploy-the-stream\" style=\"position:relative;\"><a href=\"#deploy-the-stream\" aria-label=\"deploy the stream permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploy the stream</h4>\n<p>When we deploy the stream we must also configure the <code class=\"language-text\">sftp</code> pod with the</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">stream deploy inboundSftp --properties <span class=\"token string\">\"deployer.sftp.cloudfoundry.services=nfs\"</span></code></pre></div>\n      </div>\n<h4 id=\"verify-stream-deployment-1\" style=\"position:relative;\"><a href=\"#verify-stream-deployment-1\" aria-label=\"verify stream deployment 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verify Stream deployment</h4>\n<p>We can see the status of the streams to be deployed with <code class=\"language-text\">stream list</code>, for example:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow:<span class=\"token operator\">></span>stream list\n╔═══════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╤═══════════════════╗\n║Stream Name│                                                                                     Stream Definition                                                                                     │      Status       ║\n╠═══════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╪═══════════════════╣\n║inboundSftp│sftp --task.launch.request.deployment-properties<span class=\"token operator\">=</span><span class=\"token string\">'deployer.*.cloudfoundry.services=nfs'</span> --sftp.factory.password<span class=\"token operator\">=</span><span class=\"token string\">'******'</span> --sftp.local-dir<span class=\"token operator\">=</span>/var/scdf/shared-files/                          │The stream has been║\n║           │--sftp.factory.allow-unknown-keys<span class=\"token operator\">=</span>true --sftp.factory.username<span class=\"token operator\">=</span><span class=\"token string\">'******'</span> --sftp.remote-dir<span class=\"token operator\">=</span>/remote-files/ --sftp.factory.host<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>host<span class=\"token operator\">></span> --task.launch.request.taskName<span class=\"token operator\">=</span>fileIngestTask <span class=\"token operator\">|</span>        │successfully       ║\n║           │task-launcher --spring.cloud.dataflow.client.server-uri<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>data-flow-server-uri                                                                                                              │deployed           ║\n╚═══════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╧═══════════════════╝</code></pre></div>\n      </div>\n<h4 id=\"inspect-the-application-logs-1\" style=\"position:relative;\"><a href=\"#inspect-the-application-logs-1\" aria-label=\"inspect the application logs 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inspect the application logs</h4>\n<p>Use the Cloud Foundry CLI to list the apps. The <code class=\"language-text\">source</code> and <code class=\"language-text\">sink</code> applications should be in a started state.</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">cf apps\nGetting apps <span class=\"token keyword\">in</span> org myorg / space myspace as someuser<span class=\"token punctuation\">..</span>.\nOK\n\nname                                   requested state   instances   memory   disk   urls\n<span class=\"token punctuation\">..</span>.\nKy7Uk6q-inboundSftp-sftp-v1            started           <span class=\"token number\">1</span>/1         2G       1G     Ky7Uk6q-inboundSftp-sftp-v1.apps.hayward.cf-app.com\nKy7Uk6q-inboundSftp-task-launcher-v1   started           <span class=\"token number\">1</span>/1         2G       1G     Ky7Uk6q-inboundSftp-task-launcher-v1.apps.hayward.cf-app.com\n<span class=\"token punctuation\">..</span>.</code></pre></div>\n      </div>\n<p>The log files of the <code class=\"language-text\">sftp</code> source would be useful to debug issues such as SFTP connection failures and to verify SFTP downloads.</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">cf logs Ky7Uk6q-inboundSftp-sftp-v1 --recent</code></pre></div>\n      </div>\n<p>The logs for the <code class=\"language-text\">task-launcher</code> application would be useful to debug data flow connection issues and verify task launch requests:</p>\n<h4 id=\"drop-a-file-into-the-remote-directory-1\" style=\"position:relative;\"><a href=\"#drop-a-file-into-the-remote-directory-1\" aria-label=\"drop a file into the remote directory 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Drop a file into the remote directory</h4>\n<p>Sample data can be found in the <code class=\"language-text\">data/</code> directory of the <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/recipes/file-ingest/file-to-jdbc/file-to-jdbc.zip?raw=true\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sample project</a>.</p>\n<p>Connect to the SFTP server and upload <code class=\"language-text\">data/name-list.csv</code> into the <code class=\"language-text\">remote-files</code> directory:</p>\n<p>When this file is detected, the <code class=\"language-text\">sftp</code> source will download it to the <code class=\"language-text\">/var/scdf/shared-files</code> directory specified by <code class=\"language-text\">--local-dir</code>. Here we are using the shared mount path <code class=\"language-text\">/var/scdf</code> that we configured for the <code class=\"language-text\">nfs</code> service. When the file is downloaded, the source emits a Task Launch Request.\nThe Task Launch Request includes the name of the task to launch along with the local file path, given as a command line argument.\nSpring Batch binds each command line argument to a corresponding JobParameter.\nThe FileIngestTask job processes the file given by the JobParameter named <code class=\"language-text\">localFilePath</code>.\nSince there have not been any recent requests, the task will launch within 30 seconds after the request is published (see tip above about configuring the launch trigger).</p>\n<h4 id=\"inspect-job-executions-1\" style=\"position:relative;\"><a href=\"#inspect-job-executions-1\" aria-label=\"inspect job executions 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inspect Job Executions</h4>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow:<span class=\"token operator\">></span>job execution list\n╔═══╤═══════╤═════════╤════════════════════════════╤═════════════════════╤══════════════════╗\n║ID │Task ID│Job Name │         Start Time         │Step Execution Count │Definition Status ║\n╠═══╪═══════╪═════════╪════════════════════════════╪═════════════════════╪══════════════════╣\n║1  │1      │ingestJob│Tue Jun <span class=\"token number\">11</span> <span class=\"token number\">15</span>:56:27 EDT <span class=\"token number\">2019</span>│1                    │Created           ║\n╚═══╧═══════╧═════════╧════════════════════════════╧═════════════════════╧══════════════════╝</code></pre></div>\n      </div>\n<p>As well as list more details about that specific job execution:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow:<span class=\"token operator\">></span>job execution display --id <span class=\"token number\">1</span>\n╔═══════════════════════════════════════╤════════════════════════════════════╗\n║                  Key                  │               Value                ║\n╠═══════════════════════════════════════╪════════════════════════════════════╣\n║Job Execution Id                       │6                                   ║\n║Task Execution Id                      │6                                   ║\n║Task Instance Id                       │6                                   ║\n║Job Name                               │ingestJob                           ║\n║Create Time                            │Thu Jun <span class=\"token number\">13</span> <span class=\"token number\">17</span>:06:28 EDT <span class=\"token number\">2019</span>        ║\n║Start Time                             │Thu Jun <span class=\"token number\">13</span> <span class=\"token number\">17</span>:06:29 EDT <span class=\"token number\">2019</span>        ║\n║End Time                               │Thu Jun <span class=\"token number\">13</span> <span class=\"token number\">17</span>:06:57 EDT <span class=\"token number\">2019</span>        ║\n║Running                                │false                               ║\n║Stopping                               │false                               ║\n║Step Execution Count                   │1                                   ║\n║Execution Status                       │COMPLETED                           ║\n║Exit Status                            │COMPLETED                           ║\n║Exit Message                           │                                    ║\n║Definition Status                      │Created                             ║\n║Job Parameters                         │                                    ║\n║-spring.cloud.task.executionid<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span> │1                                   ║\n║run.id<span class=\"token punctuation\">(</span>LONG<span class=\"token punctuation\">)</span>                           │1                                   ║\n║localFilePath<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span>                  │/var/scdf/shared-files/name-list.csv║\n╚═══════════════════════════════════════╧════════════════════════════════════╝</code></pre></div>\n      </div>\n<h4 id=\"verify-data-1\" style=\"position:relative;\"><a href=\"#verify-data-1\" aria-label=\"verify data 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verify data</h4>\n<p>When the the batch job runs, it processes the file in the local directory <code class=\"language-text\">/var/scdf/shared-files</code> and transforms each item to uppercase names and inserts it into the database.</p>\n<p>Use <a href=\"https://github.com/pivotal-cf/PivotalMySQLWeb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PivotalMySQLWeb</a> to inspect the data.</p>\n<h3 id=\"kubernetes\" style=\"position:relative;\"><a href=\"#kubernetes\" aria-label=\"kubernetes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kubernetes</h3>\n<h4 id=\"prerequisites-2\" style=\"position:relative;\"><a href=\"#prerequisites-2\" aria-label=\"prerequisites 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Prerequisites</h4>\n<p>This example assumes Data Flow is installed on minikube with <code class=\"language-text\">kafka</code> and <code class=\"language-text\">mysql</code>. It is recommended to use the <a href=\"/docs/1.0.x/installation/kubernetes/helm/\">helm chart</a>.</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">helm <span class=\"token function\">install</span> --name my-release --set kafka.enabled<span class=\"token operator\">=</span>true,rabbitmq.enabled<span class=\"token operator\">=</span>false,server.service.type<span class=\"token operator\">=</span>NodePort stable/spring-cloud-data-flow</code></pre></div>\n      </div>\n<p>Running this example on Kubernetes requires configuring an NFS server and creating an corresponding <code class=\"language-text\">persistent volume</code> and <code class=\"language-text\">persistent volume claim</code> resources as described in the <a href=\"/docs/1.0.x/recipes/file-ingest/sftp-to-jdbc/#kubernetes-nfs-configuration\">Kubernetes NFS Configuration</a> section.\nWe also require an external SFTP server with a <code class=\"language-text\">/remote-files</code> directory.</p>\n<h4 id=\"register-the-applications-2\" style=\"position:relative;\"><a href=\"#register-the-applications-2\" aria-label=\"register the applications 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Register the applications</h4>\n<p>If you downloaded the <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/recipes/file-ingest/file-to-jdbc/file-to-jdbc.zip?raw=true\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sample project</a> you can build and publish the docker image to the minikube registry:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">eval</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>minikube docker-env<span class=\"token variable\">)</span></span>\n./mvnw clean package docker:build -Pkubernetes</code></pre></div>\n      </div>\n<p>Otherwise, you can skip this step to pull the image from dockerhub.</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">app register --name fileIngest --type task --uri docker://springcloud/ingest</code></pre></div>\n      </div>\n<p>Register the prepackaged <code class=\"language-text\">sftp</code> source and <code class=\"language-text\">task-launcher</code> sink applications:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">app register --name <span class=\"token function\">sftp</span> --type <span class=\"token builtin class-name\">source</span>  --uri docker://springcloudstream/sftp-dataflow-source-kafka:2.1.0.RELEASE --metadata-uri maven://org.springframework.cloud.stream.app:sftp-dataflow-source-kafka:jar:metadata:2.1.0.RELEASE</code></pre></div>\n      </div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">app register --name task-launcher --type sink --uri docker://springcloudstream/task-launcher-dataflow-sink-kafka:1.0.1.RELEASE --metadata-uri maven://org.springframework.cloud.stream.app:task-launcher-dataflow-sink-kafka:jar:metadata:1.0.1.RELEASE</code></pre></div>\n      </div>\n<h4 id=\"create-the-task-2\" style=\"position:relative;\"><a href=\"#create-the-task-2\" aria-label=\"create the task 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Create the task</h4>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">task create fileIngestTask --definition fileIngest</code></pre></div>\n      </div>\n<h4 id=\"create-the-stream-1\" style=\"position:relative;\"><a href=\"#create-the-stream-1\" aria-label=\"create the stream 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Create the stream</h4>\n<p>The <code class=\"language-text\">sftp</code> source is configured to publish a task launch request to launch the <code class=\"language-text\">fileIngestTask</code> task.\nThe launch request mounts the nfs share to the task pod using deployment properties\n<code class=\"language-text\">deployer.*.kubernetes.volumes=[{&#39;name&#39;:&#39;staging&#39;,&#39;persistentVolumeClaim&#39;:{&#39;claimName&#39;:&#39;nfs-volume-claim&#39;}}]</code> and\n<code class=\"language-text\">deployer.*.kubernetes.volumeMounts=[{&#39;mountPath&#39;:&#39;/staging/shared-files&#39;,&#39;name&#39;:&#39;staging&#39;}]</code>.</p>\n<div class=\"admonition note\"><p><strong>NOTE</strong>: Replace <code class=\"language-text\">&lt;user&gt;</code>, <code class=\"language-text\">&lt;pass&gt;</code> and <code class=\"language-text\">&lt;data-flow-server-uri&gt;</code> in the stream definition below. The <code class=\"language-text\">&lt;host&gt;</code> value here is the default minikube gateway for VirtualBox.</p><p>To get the <code class=\"language-text\">&lt;data-flow-server-uri&gt;</code> find the name of the service and use the <code class=\"language-text\">minikube service</code> command:</p><div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash:\"><pre class=\"language-bash:\"><code class=\"language-bash:\">kubectl get svc\n...\nmy-release-data-flow-server     NodePort       10.97.74.123     &lt;none&gt;        80:30826/TCP\n\nminikube service my-release-data-flow-server --url\nhttp://192.168.99.105:30826</code></pre></div>\n      </div></div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">stream create inboundSftp --definition <span class=\"token string\">\"sftp --host=192.168.99.1 --username=&lt;user> --password=&lt;pass> --allow-unknown-keys=true --remote-dir=/remote-files --local-dir=/staging/shared-files --task.launch.request.taskName=fileIngestTask --task.launch.request.deployment-properties=deployer.*.kubernetes.volumes=[{'name':'staging','persistentVolumeClaim':{'claimName':'nfs-volume-claim'}}],deployer.*.kubernetes.volumeMounts=[{'mountPath':'/staging/shared-files','name':'staging'}] | task-launcher --spring.cloud.dataflow.client.server-uri=&lt;dataflow-uri>\"</span></code></pre></div>\n      </div>\n<div class=\"admonition tip\"><p>The <a href=\"https://github.com/spring-cloud-stream-app-starters/tasklauncher-dataflow/tree/master/spring-cloud-starter-stream-sink-task-launcher-dataflow\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dataflow-task-launcher-sink</a> uses a <a href=\"https://docs.spring.io/spring-cloud-stream/docs/Elmhurst.BUILD-SNAPSHOT/api/org/springframework/cloud/stream/binder/PollableMessageSource.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PollableMessageSource</a> controlled by a dynamic trigger with exponential backoff. By default, the sink polls its input destination every 1 second. If there are no task launch requests, the polling period will continue to double up to a maximum of 30 seconds. If a task launch request is present, the trigger resets to 1 second. The trigger parameters may be configured by setting the <code class=\"language-text\">task-launcher</code> sink properties <code class=\"language-text\">trigger.period</code> and <code class=\"language-text\">trigger.max-period</code> in the stream definition.</p></div>\n<h4 id=\"deploy-the-stream-1\" style=\"position:relative;\"><a href=\"#deploy-the-stream-1\" aria-label=\"deploy the stream 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploy the stream</h4>\n<p>When we deploy the stream we must also configure a volume mount for the <code class=\"language-text\">sftp</code> source.</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">stream deploy inboundSftp --properties <span class=\"token string\">\"deployer.sftp.kubernetes.volumes=[{'name':'staging','persistentVolumeClaim':{'claimName':'nfs-volume-claim'}}],deployer.sftp.kubernetes.volumeMounts=[{'mountPath':'/staging/shared-files','name':'staging'}]\"</span></code></pre></div>\n      </div>\n<h4 id=\"verify-stream-deployment-2\" style=\"position:relative;\"><a href=\"#verify-stream-deployment-2\" aria-label=\"verify stream deployment 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verify Stream deployment</h4>\n<p>We can see the status of the streams to be deployed with <code class=\"language-text\">stream list</code>, for example:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow:<span class=\"token operator\">></span>stream list\n╔═══════════╤═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╤════════════╗\n║Stream Name│                                                                                                                  Stream Definition                                                                                                                  │   Status   ║\n╠═══════════╪═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╪════════════╣\n║inboundSftp│sftp                                                                                                                                                                                                                                                 │The stream  ║\n║           │--task.launch.request.deployment-properties<span class=\"token operator\">=</span><span class=\"token string\">\"deployer.*.kubernetes.volumes=[{'name':'staging','persistentVolumeClaim':{'claimName':'nfs-volume-claim'}}],deployer.*.kubernetes.volumeMounts=[{'mountPath':'/staging/shared-files','name':'staging'}]\"</span>│has been    ║\n║           │--sftp.factory.password<span class=\"token operator\">=</span><span class=\"token string\">'******'</span> --sftp.local-dir<span class=\"token operator\">=</span>/staging/shared-files --sftp.factory.allow-unknown-keys<span class=\"token operator\">=</span>true --sftp.factory.username<span class=\"token operator\">=</span><span class=\"token string\">'******'</span> --sftp.remote-dir<span class=\"token operator\">=</span>/remote-files --sftp.factory.host<span class=\"token operator\">=</span><span class=\"token number\">192.168</span>.99.1                                     │successfully║\n║           │--task.launch.request.taskName<span class=\"token operator\">=</span>fileIngestTask <span class=\"token operator\">|</span> task-launcher --spring.cloud.dataflow.client.server-uri<span class=\"token operator\">=</span>http://192.168.99.105:30826                                                                                                                  │deployed    ║\n╚═══════════╧═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╧════════════╝</code></pre></div>\n      </div>\n<h4 id=\"inspect-the-application-logs-2\" style=\"position:relative;\"><a href=\"#inspect-the-application-logs-2\" aria-label=\"inspect the application logs 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inspect the application logs</h4>\n<p>Use <code class=\"language-text\">kubectl</code> to list the apps. The <code class=\"language-text\">source</code> and <code class=\"language-text\">sink</code> applications should be in a started state.</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get pods\nNAME                                             READY   STATUS    RESTARTS   AGE\n<span class=\"token punctuation\">..</span>.\ninboundsftp-sftp-v12-6d55d469bd-t8znd            <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          6m24s\ninboundsftp-task-launcher-v12-555d4785c5-zjr6b   <span class=\"token number\">1</span>/1     Running   <span class=\"token number\">0</span>          6m24s\n<span class=\"token punctuation\">..</span>.</code></pre></div>\n      </div>\n<p>The log files of the <code class=\"language-text\">sftp</code> source would be useful to debug issues such as SFTP connection failures and to verify SFTP downloads.</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl logs inboundsftp-sftp-v12-6d55d469bd-t8znd</code></pre></div>\n      </div>\n<p>The logs for the <code class=\"language-text\">task-launcher</code> application would be useful to debug data flow connection issues and verify task launch requests:</p>\n<h4 id=\"drop-a-file-into-the-remote-directory-2\" style=\"position:relative;\"><a href=\"#drop-a-file-into-the-remote-directory-2\" aria-label=\"drop a file into the remote directory 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Drop a file into the remote directory</h4>\n<p>Sample data can be found in the <code class=\"language-text\">data/</code> directory of the <a href=\"https://github.com/spring-cloud/spring-cloud-dataflow-samples/blob/master/dataflow-website/recipes/file-ingest/file-to-jdbc/file-to-jdbc.zip?raw=true\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sample project</a>.</p>\n<p>Connect to the SFTP server and upload <code class=\"language-text\">data/name-list.csv</code> into the <code class=\"language-text\">remote-files</code> directory:</p>\n<p>When this file is detected, the <code class=\"language-text\">sftp</code> source will download it to the <code class=\"language-text\">/var/scdf/shared-files</code> directory specified by <code class=\"language-text\">--local-dir</code>. Here we are using the shared mount path <code class=\"language-text\">/var/scdf</code> that we configured for the <code class=\"language-text\">nfs</code> service. When the file is downloaded, the source emits a Task Launch Request.\nThe Task Launch Request includes the name of the task to launch along with the local file path, given as a command line argument.\nSpring Batch binds each command line argument to a corresponding JobParameter.\nThe FileIngestTask job processes the file given by the JobParameter named <code class=\"language-text\">localFilePath</code>.\nSince there have not been any recent requests, the task will launch within 30 seconds after the request is published (see tip above about configuring the launch trigger).</p>\n<h4 id=\"inspect-job-executions-2\" style=\"position:relative;\"><a href=\"#inspect-job-executions-2\" aria-label=\"inspect job executions 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inspect Job Executions</h4>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow:<span class=\"token operator\">></span>job execution list\n╔═══╤═══════╤═════════╤════════════════════════════╤═════════════════════╤══════════════════╗\n║ID │Task ID│Job Name │         Start Time         │Step Execution Count │Definition Status ║\n╠═══╪═══════╪═════════╪════════════════════════════╪═════════════════════╪══════════════════╣\n║1  │1      │ingestJob│Thu Jun <span class=\"token number\">13</span> 08:39:59 EDT <span class=\"token number\">2019</span>│1                    │Created           ║\n╚═══╧═══════╧═════════╧════════════════════════════╧═════════════════════╧══════════════════╝</code></pre></div>\n      </div>\n<p>As well as list more details about that specific job execution:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow:<span class=\"token operator\">></span>job execution display --id <span class=\"token number\">1</span>\n╔═══════════════════════════════════════════╤═══════════════════════════════════╗\n║                    Key                    │               Value               ║\n╠═══════════════════════════════════════════╪═══════════════════════════════════╣\n║Job Execution Id                           │1                                  ║\n║Task Execution Id                          │424                                ║\n║Task Instance Id                           │1                                  ║\n║Job Name                                   │ingestJob                          ║\n║Create Time                                │Thu Jun <span class=\"token number\">13</span> 08:39:59 EDT <span class=\"token number\">2019</span>       ║\n║Start Time                                 │Thu Jun <span class=\"token number\">13</span> 08:39:59 EDT <span class=\"token number\">2019</span>       ║\n║End Time                                   │Thu Jun <span class=\"token number\">13</span> 08:40:07 EDT <span class=\"token number\">2019</span>       ║\n║Running                                    │false                              ║\n║Stopping                                   │false                              ║\n║Step Execution Count                       │1                                  ║\n║Execution Status                           │COMPLETED                          ║\n║Exit Status                                │COMPLETED                          ║\n║Exit Message                               │                                   ║\n║Definition Status                          │Created                            ║\n║Job Parameters                             │                                   ║\n║-spring.cloud.task.executionid<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span>     │424                                ║\n║run.id<span class=\"token punctuation\">(</span>LONG<span class=\"token punctuation\">)</span>                               │1                                  ║\n║-spring.datasource.username<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span>        │******                             ║\n║-spring.cloud.task.name<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span>            │fileIngestTask                     ║\n║-spring.datasource.password<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span>        │******                             ║\n║-spring.datasource.driverClassName<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span> │org.mariadb.jdbc.Driver            ║\n║localFilePath<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span>                      │/staging/shared-files/name-list.csv║\n║-spring.datasource.url<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span>             │******                             ║\n╚═══════════════════════════════════════════╧═══════════════════════════════════╝</code></pre></div>\n      </div>\n<h4 id=\"verify-data-2\" style=\"position:relative;\"><a href=\"#verify-data-2\" aria-label=\"verify data 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verify data</h4>\n<p>When the the batch job runs, it processes the file in the local directory <code class=\"language-text\">/staging/shared-files</code> and transforms each item to uppercase names and inserts it into the database.</p>\n<p>Open a shell in the <code class=\"language-text\">mysql</code> container to query the <code class=\"language-text\">people</code> table.:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get pods\n<span class=\"token punctuation\">..</span>.\nmy-release-mysql-56f988dd6c-qlm8q                <span class=\"token number\">1</span>/1     Running\n<span class=\"token punctuation\">..</span>.</code></pre></div>\n      </div>\n<!-- Rolling my own to disable erroneous formating -->\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\">\n<pre class=\"language-bash\"><code>kubectl exec -it my-release-mysql-56f988dd6c-qlm8q -- /bin/bash\n# mysql -u root -p$MYSQL_ROOT_PASSWORD\nmysql&gt; select * from dataflow.people;\n</code></pre></div>\n      </div>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+-----------+------------+-----------+\n| person_id | first_name | last_name |\n+-----------+------------+-----------+\n|         1 | AARON      | AABERG    |\n|         2 | AARON      | AABY      |\n|         3 | ABBEY      | AADLAND   |\n|         4 | ABBIE      | AAGAARD   |\n|         5 | ABBY       | AAKRE     |\n|         6 | ABDUL      | AALAND    |\n|         7 | ABE        | AALBERS   |\n|         8 | ABEL       | AALDERINK |\n|         9 | ABIGAIL    | AALUND    |\n|        10 | ABRAHAM    | AAMODT    |\n|      ...                           |\n+-----------+------------+-----------+</code></pre></div>\n      </div>\n<h2 id=\"limiting-concurrent-task-executions\" style=\"position:relative;\"><a href=\"#limiting-concurrent-task-executions\" aria-label=\"limiting concurrent task executions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Limiting concurrent task executions</h2>\n<p>This recipe processes a single file with 5000+ items. What if we drop 100 files to the remote directory?\nThe <code class=\"language-text\">sftp</code> source will process them immediately, generating 100 task launch requests. The Dataflow Server launches tasks asynchronously so this could potentially overwhelm the resources of the runtime platform.\nFor example, when running the Data Flow server on your local machine, each launched task creates a new JVM. In Cloud Foundry, each task creates a new container instance, and in Kubernetes a pod.</p>\n<p>Fortunately, Spring Cloud Data Flow provides configuration settings to <a href=\"https://docs.spring.io/spring-cloud-dataflow/docs/current/reference/htmlsingle/#spring-cloud-dataflow-task-limit-concurrent-executions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">limit the number of concurrently running tasks</a></p>\n<p>We can use this sample to see how this works.</p>\n<h3 id=\"lower-the-maximum-concurrent-task-executions\" style=\"position:relative;\"><a href=\"#lower-the-maximum-concurrent-task-executions\" aria-label=\"lower the maximum concurrent task executions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lower the maximum concurrent task executions</h3>\n<p>The sample project includes 20 files in the <code class=\"language-text\">data/spilt</code> directory. To observe the limit in action we can set the maximum concurrent tasks to 3.</p>\n<p>For running tasks on a local server, restart the server, adding a command line argument <code class=\"language-text\">spring.cloud.dataflow.task.platform.local.accounts[default].maximum-concurrent-tasks=3</code>.</p>\n<p>If running on Cloud Foundry:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">cf set-env <span class=\"token operator\">&lt;</span>dataflow-server<span class=\"token operator\">></span> SPRING_CLOUD_DATAFLOW_TASK_PLATFORM_CLOUDFOUNDRY_ACCOUNTS<span class=\"token punctuation\">[</span>DEFAULT<span class=\"token punctuation\">]</span>_DEPLOYMENT_MAXIMUMCONCURRENTTASKS <span class=\"token number\">3</span></code></pre></div>\n      </div>\n<p>If running on Kubernetes, edit the Data Flow server <code class=\"language-text\">configmap</code>, for example:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">kubectl edit configmap my-release-data-flow-server</code></pre></div>\n      </div>\n<p>Add the 'maximum-concurrent-tasks` property as shown below:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">data</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">application.yaml</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token punctuation\">-</span>\n    <span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">cloud</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">dataflow</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">task</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">platform</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">kubernetes</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">accounts</span><span class=\"token punctuation\">:</span>\n                  <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token key atrule\">maximum-concurrent-tasks</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n                    <span class=\"token key atrule\">limits</span><span class=\"token punctuation\">:</span>\n                      <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 1024Mi\n                      <span class=\"token key atrule\">cpu</span><span class=\"token punctuation\">:</span> 500m</code></pre></div>\n      </div>\n<p>After editing the configmap, delete the Data Flow server pod to force it to restart then wait for it to restart.</p>\n<h3 id=\"verify-maximum-concurrent-task-executions-is-enforced\" style=\"position:relative;\"><a href=\"#verify-maximum-concurrent-task-executions-is-enforced\" aria-label=\"verify maximum concurrent task executions is enforced permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verify maximum concurrent task executions is enforced.</h3>\n<p>The task launcher sink polls the input destination. The polling period adjusts according to the presence of task launch requests and also to the number of currently running tasks reported via the Data Flow server's <code class=\"language-text\">tasks/executions/current</code> REST endpoint.\nThe sink queries this endpoint and will pause polling the input for new requests if the number of concurrent tasks for the task platform is at its limit.\nThis introduces a 1-30 second lag between the creation of the task launch request and the execution of the request, sacrificing some performance for resilience.\nTask launch requests will never be sent to a dead letter queue because the server is busy or unavailable.\nThe exponential backoff also prevents the app from querying the server excessively when there are no task launch requests.</p>\n<h3 id=\"monitor-the-task-executions\" style=\"position:relative;\"><a href=\"#monitor-the-task-executions\" aria-label=\"monitor the task executions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Monitor the task executions</h3>\n<p>Tail the <code class=\"language-text\">task-launcher</code> container logs.</p>\n<p>You can also monitor the Data Flow server for current task executions:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">watch</span> <span class=\"token function\">curl</span> <span class=\"token operator\">&lt;</span>dataflow-server-url<span class=\"token operator\">></span>/tasks/executions/current\nEvery <span class=\"token number\">2</span>.0s: <span class=\"token function\">curl</span> http://192.168.99.105:30826/tasks/executions/current\n\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  <span class=\"token number\">0</span>     <span class=\"token number\">0</span>    <span class=\"token number\">0</span>     <span class=\"token number\">0</span>    <span class=\"token number\">0</span>     <span class=\"token number\">0</span>      <span class=\"token number\">0</span>      <span class=\"token number\">0</span> --:--:-- --:--:-- --:--:--     0100    <span class=\"token number\">92</span>    <span class=\"token number\">0</span>    <span class=\"token number\">92</span>    <span class=\"token number\">0</span>     <span class=\"token number\">0</span>   <span class=\"token number\">1202</span>      <span class=\"token number\">0</span> --:--:-- --:--:-- --:--:\n--  <span class=\"token number\">1210</span>\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"name\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"default\"</span>,<span class=\"token string\">\"type\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"Kubernetes\"</span>,<span class=\"token string\">\"maximumTaskExecutions\"</span>:3,<span class=\"token string\">\"runningExecutionCount\"</span>:0<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span></code></pre></div>\n      </div>\n<h3 id=\"run-the-sample-with-multiple-files\" style=\"position:relative;\"><a href=\"#run-the-sample-with-multiple-files\" aria-label=\"run the sample with multiple files permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Run the sample with multiple files</h3>\n<p>With the sample stream deployed, upload the 20 files in <code class=\"language-text\">data/spilt</code> to <code class=\"language-text\">/remote-files</code> files. In the <code class=\"language-text\">task-launcher</code> logs, you should see the exponential backoff working:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2019-06-14 15:00:48.247  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling period reset to 1000 ms.\n2019-06-14 15:00:49.265  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Launching Task fileIngestTask on platform default\n2019-06-14 15:00:50.433  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Launching Task fileIngestTask on platform default\n2019-06-14 15:00:51.686  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Launching Task fileIngestTask on platform default\n2019-06-14 15:00:52.929  WARN 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : The data Flow task platform default has reached its concurrent task execution limit: (3)\n2019-06-14 15:00:52.929  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling paused- increasing polling period to 2 seconds.\n2019-06-14 15:00:55.008  WARN 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : The data Flow task platform default has reached its concurrent task execution limit: (3)\n2019-06-14 15:00:55.008  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling paused- increasing polling period to 4 seconds.\n2019-06-14 15:00:59.039  WARN 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : The data Flow task platform default has reached its concurrent task execution limit: (3)\n2019-06-14 15:00:59.040  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling paused- increasing polling period to 8 seconds.\n2019-06-14 15:01:07.104  WARN 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : The data Flow task platform default has reached its concurrent task execution limit: (3)\n2019-06-14 15:01:07.104  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling paused- increasing polling period to 16 seconds.\n2019-06-14 15:01:23.127  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling resumed\n2019-06-14 15:01:23.128  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Launching Task fileIngestTask on platform default\n2019-06-14 15:01:23.232  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling period reset to 1000 ms.\n2019-06-14 15:01:24.277  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Launching Task fileIngestTask on platform default\n2019-06-14 15:01:25.483  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Launching Task fileIngestTask on platform default\n2019-06-14 15:01:26.743  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Launching Task fileIngestTask on platform default\n2019-06-14 15:01:28.035  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Launching Task fileIngestTask on platform default\n2019-06-14 15:01:29.324  WARN 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : The data Flow task platform default has reached its concurrent task execution limit: (3)\n2019-06-14 15:01:29.325  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling paused- increasing polling period to 2 seconds.\n2019-06-14 15:01:31.435  WARN 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : The data Flow task platform default has reached its concurrent task execution limit: (3)\n2019-06-14 15:01:31.436  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling paused- increasing polling period to 4 seconds.\n2019-06-14 15:01:35.531  WARN 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : The data Flow task platform default has reached its concurrent task execution limit: (3)\n2019-06-14 15:01:35.532  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling paused- increasing polling period to 8 seconds.\n2019-06-14 15:01:43.615  WARN 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : The data Flow task platform default has reached its concurrent task execution limit: (3)\n2019-06-14 15:01:43.615  INFO 1 --- [pool-2-thread-1] o.s.c.s.a.t.l.d.s.LaunchRequestConsumer  : Polling paused- increasing polling period to 16 seconds.</code></pre></div>\n      </div>\n<h2 id=\"avoiding-duplicate-processing\" style=\"position:relative;\"><a href=\"#avoiding-duplicate-processing\" aria-label=\"avoiding duplicate processing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Avoiding duplicate processing</h2>\n<p>The <code class=\"language-text\">sftp</code> source will not process files that it has already seen.\nIt uses a <a href=\"https://docs.spring.io/spring-integration/docs/current/reference/html/#jdbc-metadata-store\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Metadata Store</a> to keep track of files by extracting content from messages at runtime.\nOut of the box, it uses an in-memory Metadata Store, but it is pluggable to a persistent store used for production deployments\nThus, if we re-deploy the stream, or restart the <code class=\"language-text\">sftp</code> source, this state is lost and files will be reprocessed.</p>\n<p>Thanks to the magic of Spring, we can auto-configure one of the available persistent Metadata Stores to prevent duplicate processing.</p>\n<p>In this example, we will <a href=\"https://github.com/spring-cloud-stream-app-starters/core/tree/master/common/stream-apps-metadata-store-common#jdbc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">auto configure the JDBC Metadata Store</a> since we are already using a JDBC database.</p>\n<h3 id=\"configure-and-build-the-sftp-source\" style=\"position:relative;\"><a href=\"#configure-and-build-the-sftp-source\" aria-label=\"configure and build the sftp source permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configure and Build the SFTP source</h3>\n<p>For this we add some JDBC dependencies to the <code class=\"language-text\">sftp-dataflow</code> source.</p>\n<p>Clone the [sftp]<a href=\"https://github.com/spring-cloud-stream-app-starters/sftp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/spring-cloud-stream-app-starters/sftp</a> stream app starter.\nFrom the sftp directory. Replace <code class=\"language-text\">&lt;binder&gt;</code> below with <code class=\"language-text\">kafka</code> or <code class=\"language-text\">rabbit</code> as appropriate for your configuration:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">./mvnw clean <span class=\"token function\">install</span> -DskipTests -PgenerateApps\n<span class=\"token builtin class-name\">cd</span> apps/sftp-dataflow-source-<span class=\"token operator\">&lt;</span>binder<span class=\"token operator\">></span></code></pre></div>\n      </div>\n<p>Add the following dependencies to <code class=\"language-text\">pom.xml</code>:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.integration<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-integration-jdbc<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.springframework.boot<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>spring-boot-starter-jdbc<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.h2database<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>h2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></code></pre></div>\n      </div>\n<p>If you are running on Kubernetes use the mariadb driver instead of H2:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.mariadb.jdbc<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>mariadb-java-client<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>2.3.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></code></pre></div>\n      </div>\n<p>If you are running on a local server with the in memory H2 database, set the JDBC url in <code class=\"language-text\">src/main/resources/application.properties</code> to use the Data Flow server's database:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">spring.datasource.url=jdbc:h2:tcp://localhost:19092/mem:dataflow</code></pre></div>\n      </div>\n<p>If running on Kubernetes, set the datasource to use the internal IP of the <code class=\"language-text\">mysql</code> service, e.g.:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">spring.datasource.url=jdbc:mysql://10.98.214.235:3306/dataflow</code></pre></div>\n      </div>\n<p>If you are running in Cloud Foundry or Kubernetes, add the following property to <code class=\"language-text\">src/main/resources/application.properties</code>:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">spring.integration.jdbc.initialize-schema=always</code></pre></div>\n      </div>\n<p>Build the <code class=\"language-text\">sftp</code> source and register it with Data Flow.</p>\n<h3 id=\"run-the-sample-app\" style=\"position:relative;\"><a href=\"#run-the-sample-app\" aria-label=\"run the sample app permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Run the sample app</h3>\n<p>Follow the instructions for running the sample on your preferred platform, up to the <code class=\"language-text\">Drop file...</code> Step`.</p>\n<p>If you have already completed the main exercise, restore the data to its initial state, and redeploy the stream:</p>\n<ul>\n<li>Clean the local and remote data directories</li>\n<li>Execute the SQL command <code class=\"language-text\">DROP TABLE PEOPLE;</code> in the database</li>\n<li>Undeploy the stream, and deploy it again to run the updated <code class=\"language-text\">sftp</code> source</li>\n</ul>\n<p>If you are running in Cloud Foundry, set the deployment properties to bind <code class=\"language-text\">sftp</code> to the <code class=\"language-text\">mysql</code> service. For example:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">dataflow<span class=\"token operator\">></span>stream deploy inboundSftp --properties <span class=\"token string\">\"deployer.sftp.cloudfoundry.services=nfs,mysql\"</span></code></pre></div>\n      </div>\n<h3 id=\"drop-a-file-into-the-remote-directory-3\" style=\"position:relative;\"><a href=\"#drop-a-file-into-the-remote-directory-3\" aria-label=\"drop a file into the remote directory 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Drop a file into the remote directory</h3>\n<p>Let's use one small file for this.\nThe directory <code class=\"language-text\">data/split</code> in the sample project contains the contents of\n<code class=\"language-text\">data/name-list.csv</code> split into 20 files. Upload <code class=\"language-text\">names_aa.csv</code>:</p>\n<h3 id=\"inspect-the-database\" style=\"position:relative;\"><a href=\"#inspect-the-database\" aria-label=\"inspect the database permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inspect the database</h3>\n<p>Using a Database tool, as described above, view the contents of the <code class=\"language-text\">INT_METADATA_STORE</code> table.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 617px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQY0z2P20oCYRSFffkuoiB6h6BIiUihTEorNM3TqM04OkfHw3geHRBqRv36FfPiY7EXi7X3jpw82lzEqpzfVjiL1Ti9KXH5oBDNGTx/ViiUJFpmF70zwNjTPzA4otv9I5FErUP1u0ZRkSmZFsWmUM1Ckho0myrD0YTBcMTwHzHvcEdjXDGPhE5nHtO5x2w2J1K3+tQNFUkp01AlFL3BwHWYjHcFLr2uQ7/XpWU5yLqJKha3WiqG1kZta8hGB8u2sSwT3REX1mSNdLZI6jXHy1uezHuBQkUWxY4IDMWrLmZvTKVpEU2kiN3FubqOcR9/IpMrk/z4IpnOki83RLkolBQN3/cJN1uCcMNvuOYnCAnWW+FBeNBA+J63YL5YMhfqLXwWS5/VarXPrEVmu4U/ri5lT+m3fXwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/b5225ae6c028be9ce4853b1afc998f90/507e6/metadata_store_1.webp 200w,\n/static/b5225ae6c028be9ce4853b1afc998f90/28a80/metadata_store_1.webp 400w,\n/static/b5225ae6c028be9ce4853b1afc998f90/0acf1/metadata_store_1.webp 617w\"\n          sizes=\"(max-width: 617px) 100vw, 617px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/b5225ae6c028be9ce4853b1afc998f90/36ca5/metadata_store_1.png 200w,\n/static/b5225ae6c028be9ce4853b1afc998f90/a3397/metadata_store_1.png 400w,\n/static/b5225ae6c028be9ce4853b1afc998f90/d7556/metadata_store_1.png 617w\"\n          sizes=\"(max-width: 617px) 100vw, 617px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/b5225ae6c028be9ce4853b1afc998f90/d7556/metadata_store_1.png\"\n          alt=\"JDBC Metadata Store\"\n          title=\"JDBC Metadata Store\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<p>Note that there is a single key-value pair, where the key identies the file name (the prefix <code class=\"language-text\">sftpSource/</code> provides a namespace for the <code class=\"language-text\">sftp</code> source app) and the value is a timestamp indicating when the message was received.\nThe metadata store tracks files that have already been processed.\nThis prevents the same files from being pulled from the remote directory on every polling cycle.\nOnly new files, or files that have been updated will be processed.</p>\n<p>Since there are no uniqueness constraints on the <code class=\"language-text\">PEOPLE</code> table, a file processed multiple times by our batch job will result in duplicate table rows. Since we have configured a persistent metadata store, duplicate processing will be prevented across container restarts. You can verify this by undeploying and redeploying the stream, or simply restarting the <code class=\"language-text\">sftp</code> source.</p>\n<p>If we view the <code class=\"language-text\">PEOPLE</code> table, it should look something like this:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 439px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAD9ElEQVQ4y21Ux3LjRhDFl7vKvvkvfHLtYWuPW9JKosQMgggMAAgm5EwADGCSZPu5ZyjZPvjQNWQnvH79ZoQ7M0RXmUIUB2h1RbTaXQwkGc2OCFlWsA5y/HQf4+cvY/zyu4pfv1n4rWFj7ScI4xR+lCLglvBT+KZ4+NHV8NQU8djo4HHioGW4GKpTfNfWuGsP8fVexJfvPdz1TPTNCF0jxngRwrIDzNY3s+yQn8KdkUBeWzDsEdzIRlaUKPcHlJsMXpIhikLEoYc0ClBtUuzKHHWV0+8MZVGQbbhtMhYrIIydHMvQheGvsHKXWK9W8F0HXphg7YWw6XQcB74fwLFt+AEhIWQ2jRgGATzP436XzrkbQjCXPqyZhZ6qo9nq4kejjW5PwmA8x5Ns4kGa4P6hgTb5Hp6aGGo6+S08ygb9f8bTcxtPL21I2hRNdQ6hp+iYTnWE2R5xcfywGn5aYUG8tDoD/HgR+f+kPCHKD4jzHX1giIeXHuZOgrQ6I6D6rDxAaA3GMM0ZdsdX7E+v/Dyc34jHE7wogyRrEOUJqsOF4m88h5kyMmDObRTbGtv6ymOsjjc0DAP59ozN7mbF/oKkOHBpPLf6kMcWqvqNck4Uv/CTNWz3VTRaIiE8cn9JddRwRA1N3qQkFOysDlekBH/txaRNCebCJeRvFDt/5Jwha9RQVGCtfV7DjCEVnnsqDNPkTZiDnWxsxsfaJc31h9AtGzsaiY3NckpqONbnRMUYXlzwcdmHdkdq2BlOOMK0OiGjsZnlBD/eHLB0YxpLJtHG3JdtbzlpWUObLvBISxmMZpwOVl/cRmZLMbFny/gg/N+lpBAlBWmxx/HyTjlXnrOrz9BnS0jKCP2BDD8pUVOcxWhkBTohZHJhsmCWEgo/3cJYeGgSh32SVkSImTxYnMlKJp12RFKAaiDc1IjJzxYrNLoKRqMRR1ATsvr8itP1DyR5CdePMVQ0DIYq8bgi9FfKI3kQUn22QFccYkFLub7/xdGxGOdQ00b8C9wIKUOyoldm4aaEcEjbVOkKFv/JqTGgm9XoSFj6OfdFVMc4Fl76GjXU/gdhBS9IoI51ejB2eH0HR8ByDoR0algQh8ShpCGIc15zpFqhSQ3Zu5d88lOyL12w8jPMVgFHp+r0aBBCL9ly9AyhRDpstGXadJ9UQNdvexM8NaQCVeWb5dfqeOVoo6yA7UVQRzrnUFLG5Lttc1dfMNHpQRlomBiLf64jm0547sqQFYWjYlpilu+vhDCFufRokyo3P6mwIf8t54g+cf9Aj8bEcrg2k+rEry2XDUP4yR/bFuMj/eBwas6xcnycX//k3H1yaC0dun4TKPRsVaRZxi/j8G8rV6nDa49N+wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/eff8ab7e482000b93d785d3c20b2b7e6/507e6/people_table_1.webp 200w,\n/static/eff8ab7e482000b93d785d3c20b2b7e6/28a80/people_table_1.webp 400w,\n/static/eff8ab7e482000b93d785d3c20b2b7e6/ba3b5/people_table_1.webp 439w\"\n          sizes=\"(max-width: 439px) 100vw, 439px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/eff8ab7e482000b93d785d3c20b2b7e6/36ca5/people_table_1.png 200w,\n/static/eff8ab7e482000b93d785d3c20b2b7e6/a3397/people_table_1.png 400w,\n/static/eff8ab7e482000b93d785d3c20b2b7e6/baa1b/people_table_1.png 439w\"\n          sizes=\"(max-width: 439px) 100vw, 439px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/eff8ab7e482000b93d785d3c20b2b7e6/baa1b/people_table_1.png\"\n          alt=\"People table\"\n          title=\"People table\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<p>Now let's upload the same file to the SFTP server, or if you are logged into it, you can just update the timestamp:</p>\n<div class=\"spring-code\">\n        <button onClick=\"codeToClipboard(event)\" class=\"button button-clipboard\" type=\"button\">Copy</button>\n        <div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">touch</span> /remote-files/names_aa.csv</code></pre></div>\n      </div>\n<p>Now the file will be reprocessed and the <code class=\"language-text\">PEOPLE</code> table will contain duplicate data. If you <code class=\"language-text\">ORDER BY FIRST_NAME</code>, you will see something like this:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 443px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADSElEQVQ4y2WTy2/qRhTG/bd30W67qtRNs4qqtot7b1UpV0kIAWywsTF+AQbzsLHxC0zAgCGJrr6emaSp1C4+zXjOY37nnLHw3X2K7/+w8MNvOn78a4rrhxluBiuIfQeGqkCWZXQ6MnS9z/eyrCCOY6xWK6Rp+j8J190QN6KJrw8KvtZlfFZnuOvaUBUZdduDRAnakoRms4XhcIQoihCGIUJaP/akt30E4WaQoDcfYTTXESY+kixHTFqRwzxKEIVLLAMfYRAQQYJ1nqLIM6wz0nr9oYzotsUGgrHI4EULOEsPU3+KxXyOcBkgSjLMohxedsQ0zLFIdrSusUhLuFGB+SolqpAuC+Av5vCDJbyACC0vgTOaoq3beHxs4f5RhCgpEDUbn0UHV/cDXH1q4NfbPq6+SPgkeriuD3CnOrir1VEj/xrFdannzf4Ywp0eQBv6iLId4s2RK8z26KgGak0FP/3yO36+/hO38hD1nodad4zblo6GqOC23oY7i5BsTxSzQ16UEBpyH2PXxe74jP3pXxn2EDM/oqFoEEnZZodid8SGxFatb2O6iHB+BcVeeMyhemEJDQxHI+RPFda7N+Uk1RhQT2MiNSF1DaQFJSqfsSkv3EfRLH7OKtvszzx+W57fCEcjlx8W5bto3zOHmAcxmlIXcs/mSYp3n/XuRIQOGpIKa+jR2YXHPx0uEB4kDS6VzBy3dMBFDrwkKvmx2abyJyirV+7Dgor9CTpdqFJSRTOpDRWP21PpQqtrUskuUmosw2bKSIruYDKP8NDsoGeNeakZ86HgdHuE0nPQknW0qSXsm8WwCngP3f8OhfZ9cwB/GUPsdDFwZzhS9xlBSfbdoYJhDdFWelB1k6jP70N5hlATNU7InktSnD7UoaYPJgFqjQ6cyZLILohpMOyJxJsD9dVBXVThLXMirMh24n2mhNRYy8KBCNgNbPRsNaw3wrbcxXKVoXr+xumO5xciPcO0R9B0iz8ZRl9SzIlsQksxYJg2VsXp42Gz20Q6t9wFEcrQzAmRVVi926J8TwOhh07VWWP6x5/OiNZH3n+hLvU44enyym/4R87AhR/GRGFiMvVRkZ3RMb+SCMeTGdls8klwfvmGI1VWXV7wNy32gHMyrE/EAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/3db8661e5629898ff373ef74a2d98541/507e6/people_table_2.webp 200w,\n/static/3db8661e5629898ff373ef74a2d98541/28a80/people_table_2.webp 400w,\n/static/3db8661e5629898ff373ef74a2d98541/1ea1b/people_table_2.webp 443w\"\n          sizes=\"(max-width: 443px) 100vw, 443px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/3db8661e5629898ff373ef74a2d98541/36ca5/people_table_2.png 200w,\n/static/3db8661e5629898ff373ef74a2d98541/a3397/people_table_2.png 400w,\n/static/3db8661e5629898ff373ef74a2d98541/27348/people_table_2.png 443w\"\n          sizes=\"(max-width: 443px) 100vw, 443px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/3db8661e5629898ff373ef74a2d98541/27348/people_table_2.png\"\n          alt=\"People table with duplicates\"\n          title=\"People table with duplicates\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<p>Of course, if we drop another one of files into the remote directory, that will processed and we will see another entry in the Metadata Store.</p>","headings":[{"value":"SFTP to JDBC File Ingest","depth":1},{"value":"Prerequisites","depth":2},{"value":"Data Flow Installation","depth":3},{"value":"Using Data Flow","depth":3},{"value":"SFTP server","depth":3},{"value":"NFS configuration","depth":3},{"value":"Cloud Foundry NFS configuration","depth":4},{"value":"Kubernetes NFS configuration","depth":4},{"value":"Deployment","depth":2},{"value":"Local","depth":3},{"value":"Register the applications","depth":4},{"value":"Create the task","depth":4},{"value":"Create and deploy the stream","depth":4},{"value":"Verify Stream deployment","depth":4},{"value":"Inspect the application logs","depth":4},{"value":"Drop a file into the remote directory","depth":4},{"value":"Inspect Job Executions","depth":4},{"value":"Verify data","depth":4},{"value":"Cloud Foundry","depth":3},{"value":"Prerequisites","depth":4},{"value":"Register the applications","depth":4},{"value":"Create the task","depth":4},{"value":"Create the stream","depth":4},{"value":"Deploy the stream","depth":4},{"value":"Verify Stream deployment","depth":4},{"value":"Inspect the application logs","depth":4},{"value":"Drop a file into the remote directory","depth":4},{"value":"Inspect Job Executions","depth":4},{"value":"Verify data","depth":4},{"value":"Kubernetes","depth":3},{"value":"Prerequisites","depth":4},{"value":"Register the applications","depth":4},{"value":"Create the task","depth":4},{"value":"Create the stream","depth":4},{"value":"Deploy the stream","depth":4},{"value":"Verify Stream deployment","depth":4},{"value":"Inspect the application logs","depth":4},{"value":"Drop a file into the remote directory","depth":4},{"value":"Inspect Job Executions","depth":4},{"value":"Verify data","depth":4},{"value":"Limiting concurrent task executions","depth":2},{"value":"Lower the maximum concurrent task executions","depth":3},{"value":"Verify maximum concurrent task executions is enforced.","depth":3},{"value":"Monitor the task executions","depth":3},{"value":"Run the sample with multiple files","depth":3},{"value":"Avoiding duplicate processing","depth":2},{"value":"Configure and Build the SFTP source","depth":3},{"value":"Run the sample app","depth":3},{"value":"Drop a file into the remote directory","depth":3},{"value":"Inspect the database","depth":3}],"fields":{"path":"/docs/1.0.x/recipes/batch/sftp-to-jdbc/","version":"1.0.x","category":"recipes","sourcePath":"pages/6-recipes/7-batch/2-sftp-to-jdbc.md"},"frontmatter":{"title":"SFTP to JDBC","summary":null,"path":"recipes/batch/sftp-to-jdbc/","toc":null,"prevNext":null}}},"pageContext":{"slug":"/docs/1.0.x/recipes/batch/sftp-to-jdbc/","version":"1.0.x","versionPath":""}},"staticQueryHashes":["1084522749","2044043181"]}